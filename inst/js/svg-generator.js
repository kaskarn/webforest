(function(){"use strict";const Kt=[1,5,2,2.5,4,3],ct=[.001,.002,.005,.01,.02,.05,.1,.15,.2,.25,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.75,2,2.5,3,4,5,6,7,8,10,12,15,20,25,30,40,50,75,100,150,200,300,500,750,1e3];function Ct(t,n){return n?gn(t):mn(t)}function gn(t){if(t[0]<=0||t[1]<=0)return[.1,10];if(t[0]>=t[1])return t;let n=ct[0];for(const e of ct)if(e<=t[0])n=e;else break;t[0]<ct[0]&&(n=Math.pow(10,Math.floor(Math.log10(t[0]))));let o=ct[ct.length-1];for(let e=ct.length-1;e>=0&&ct[e]>=t[1];e--)o=ct[e];return t[1]>ct[ct.length-1]&&(o=Math.pow(10,Math.ceil(Math.log10(t[1])))),[n,o]}function mn(t){const n=t[1]-t[0];if(n===0)return t;if(n<0)return[t[1],t[0]];const o=Math.pow(10,Math.floor(Math.log10(n)));let e=o,i=1/0;for(const h of Kt)for(const c of[.1,1,10]){const r=h*o*c;if(r<=0)continue;const l=Math.floor(t[0]/r)*r,d=(Math.ceil(t[1]/r)*r-l)/n-1;d>=0&&d<i&&(i=d,e=r)}const a=Math.floor(t[0]/e)*e,s=Math.ceil(t[1]/e)*e;return[Math.round(a*1e10)/1e10,Math.round(s*1e10)/1e10]}function ft(t,n,o,e,i=!1){if(t&&o in t){const a=t[o];if(typeof a=="number"&&Number.isFinite(a)&&(!i||a>0))return a}return o===e&&n!=null&&Number.isFinite(n)&&(!i||n>0)?n:null}const yt=12;function yn(t){const{rows:n,config:o,scale:e,nullValue:i,forestWidth:a,pointSize:s,effects:h=[],pointCol:c,lowerCol:r,upperCol:l}=t,u=$n(n,o,e,i,h,c,r,l),f=xn(u,o,e,a,s),d=Zt(u,o,e,i);return{axisLimits:u,plotRegion:f,ticks:d}}function $n(t,n,o,e,i=[],a,s,h){const c=n.rangeMin!=null,r=n.rangeMax!=null;if(c&&r)return[n.rangeMin,n.rangeMax];const l=[],u=o==="log",f=a||"point";for(const E of t){const F=ft(E.metadata,void 0,f,"point",u);F!=null&&l.push(F);for(const M of i){const P=ft(E.metadata,void 0,M.pointCol,"point",u);P!=null&&l.push(P)}}if(l.length===0)return o==="log"?[.1,10]:[-1,1];let d=Math.min(...l),g=Math.max(...l);(n.includeNull??!0)&&(d=Math.min(d,e),g=Math.max(g,e));const I=d,A=g;let x;if(u){const E=Math.max(d,.001),F=Math.max(g,.001);x=Math.log(F)-Math.log(E)}else x=g-d;if(x===0||!Number.isFinite(x)){const E=l[0];if(u)return Ct([E/2,E*2],!0);{const F=Math.max(1,Math.abs(E)*.1);return Ct([E-F,E+F],!1)}}const[_,b]=Ct([d,g],u),D=n.ciClipFactor??2;let p=_,y=b;const m=[],w=[],T=s||"lower",C=h||"upper";for(const E of t){const F=ft(E.metadata,void 0,T,"lower",u);F!=null&&m.push(F);const M=ft(E.metadata,void 0,C,"upper",u);M!=null&&w.push(M);for(const P of i){const R=ft(E.metadata,void 0,P.lowerCol,"lower",u);R!=null&&m.push(R);const B=ft(E.metadata,void 0,P.upperCol,"upper",u);B!=null&&w.push(B)}}let k,H;if(u)k=p/D,H=y*D;else{const E=y-p;k=p-E*D,H=y+E*D}let z=!1,V=!1;for(const E of m)E>=k?p=Math.min(p,E):z=!0;for(const E of w)E<=H?y=Math.max(y,E):V=!0;if(z&&(p=Math.min(p,k)),V&&(y=Math.max(y,H)),n.symmetric===!0&&!c&&!r)if(o==="log"){const E=Math.log(e),F=Math.max(Math.abs(Math.log(Math.max(I,.001))-E),Math.abs(Math.log(A)-E));p=Math.exp(E-F),y=Math.exp(E+F)}else{const E=Math.max(Math.abs(I-e),Math.abs(A-e));p=e-E,y=e+E}let $=c?n.rangeMin:p,v=r?n.rangeMax:y;return Ct([$,v],o==="log")}function xn(t,n,o,e,i){if(!(n.markerMargin??!0)||e<=0)return t;const s=e-2*yt;if(s<=0)return t;if(o==="log"){const r=Math.log(Math.max(t[0],.001)),l=Math.log(Math.max(t[1],.001)),u=l-r,f=i/2*(u/s),d=Math.min(f,.5);return[Math.exp(r-d),Math.exp(l+d)]}const h=t[1]-t[0],c=i/2*(h/s);return[t[0]-c,t[1]+c]}function Zt(t,n,o,e){const[i,a]=t,s=e>=i&&e<=a,h=(n.nullTick??!0)&&s;if(n.tickValues&&n.tickValues.length>0){let l=n.tickValues.filter(u=>u>=i&&u<=a);return h&&!l.includes(e)&&(l=[...l,e].sort((u,f)=>u-f)),l}const c=n.tickCount??5;let r=o==="log"?Mn(t,c):bn(t,c);return h&&!r.includes(e)&&(r=[...r,e].sort((l,u)=>l-u)),r}function bn(t,n){const[o,e]=t,i=e-o;if(i===0)return[o];const a=i/Math.max(n-1,1),s=Math.pow(10,Math.floor(Math.log10(a)));let h=s,c=1/0;for(const u of Kt){const f=u*s,d=Math.floor(i/f)+1,g=Math.abs(d-n);g<c&&(c=g,h=f);const N=u*s/10;if(N>0){const I=Math.floor(i/N)+1,A=Math.abs(I-n);A<c&&(c=A,h=N)}}const r=Math.ceil(o/h)*h,l=[];for(let u=r;u<=e+h*.001;u+=h){const f=Math.round(u*1e10)/1e10;f>=o&&f<=e&&l.push(f)}return l.length<2&&(l.includes(o)||l.unshift(o),l.includes(e)||l.push(e)),l}function Mn(t,n){const[o,e]=t,a=[.01,.02,.05,.1,.15,.2,.25,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.75,2,2.5,3,4,5,6,7,8,10,12,15,20,25,30,40,50,75,100,150,200,500,1e3].filter(c=>c>=o&&c<=e);if(a.length<=n)return a;const s=[1,.1,10,100,.5,2,5,.2,.25,1.5,3,4,20,50],h=[];for(const c of s)a.includes(c)&&h.length<n&&h.push(c);if(h.length<n){const c=a.filter(l=>!h.includes(l)),r=Math.max(1,Math.floor(c.length/(n-h.length)));for(let l=0;l<c.length&&h.length<n;l+=r)h.push(c[l])}return h.sort((c,r)=>c-r)}function Nn(t){var e,i;const n=((e=t==null?void 0:t.shapes)==null?void 0:e.lineWidth)??1.5,o=((i=t==null?void 0:t.colors)==null?void 0:i.intervalLine)??"#475569";return{width:Math.max(4,Math.round(n*3)),height:Math.max(6,Math.round(n*4)),color:o,opacity:1}}function Jt(t,n,o,e){const{width:i,height:a}=e,s=a/2;return t==="left"?`M ${n} ${o} L ${n+i} ${o-s} L ${n+i} ${o+s} Z`:`M ${n} ${o} L ${n-i} ${o-s} L ${n-i} ${o+s} Z`}const Lt={RENDERING_BUFFER:4},Mt={FONT_SCALE:.8,PADDING:4,GAP:6},$t={DEFAULT_COLUMN_WIDTH:100,AXIS_HEIGHT:32,AXIS_LABEL_HEIGHT:32,BOTTOM_MARGIN:16,MIN_FOREST_WIDTH:200,DEFAULT_WIDTH:800},it={TITLE_HEIGHT:28,SUBTITLE_HEIGHT:20,CAPTION_HEIGHT:16,FOOTNOTE_HEIGHT:14,DEFAULT_FONT_SIZE:14,REM_BASE:16,TEXT_BASELINE_ADJUSTMENT:1/3},q={INDENT_PER_LEVEL:12,TEXT_PADDING:10,DEFAULT_TICK_COUNT:5},Tn={OVERALL_ROW_HEIGHT_MULTIPLIER:1.5},Tt={MIN:60,MAX:600,LABEL_MAX:400,VISUAL_MIN:{sparkline:92,bar:100,stars:84,range:84,badge:74,forest:200,viz_bar:150,viz_boxplot:150,viz_violin:150}},Dt={CHEVRON_WIDTH:12,GAP:6,SAFETY_MARGIN:8},Qt={SPACING:6},Pt={EDGE_THRESHOLD:35,MIN_TICK_SPACING:50},En={success:"#16a34a",warning:"#d97706",error:"#dc2626",info:"#2563eb"};function wn(t,n){return n<=1?0:-((n-1)*Qt.SPACING)/2+t*Qt.SPACING}function kt(t,n){const o=t.split(".");return o[0]=o[0].replace(/\B(?=(\d{3})+(?!\d))/g,n),o.join(".")}function Rt(t){const n=Math.abs(t),o=t<0?"-":"";if(n>=1e12)throw new Error(`Cannot abbreviate value >= 1 trillion: ${t}`);if(n>=1e9){const e=n/1e9;return o+Bt(e)+"B"}if(n>=1e6){const e=n/1e6;return o+Bt(e)+"M"}if(n>=1e3){const e=n/1e3;return o+Bt(e)+"K"}return o+Math.round(n).toString()}function Bt(t){const n=Math.round(t*10)/10;return n===Math.floor(n)?n.toFixed(0):n.toFixed(1)}const An={0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹","-":"⁻","+":"⁺"};function In(t){return t.split("").map(n=>An[n]??n).join("")}function Et(t,n){var h,c,r,l,u;if(t==null||Number.isNaN(t))return(n==null?void 0:n.naText)??"";if(n!=null&&n.percent){const{decimals:f,digits:d,multiply:g=!0,symbol:N=!0}=n.percent,I=g?t*100:t,A=d!=null?I.toPrecision(d):I.toFixed(f??1);return N?`${A}%`:A}if(((h=n==null?void 0:n.numeric)==null?void 0:h.abbreviate)&&Math.abs(t)>=1e3)return Rt(t);const e=(c=n==null?void 0:n.numeric)==null?void 0:c.digits;if(e!=null){const f=t.toPrecision(e),d=(r=n==null?void 0:n.numeric)==null?void 0:r.thousandsSep;return d&&typeof d=="string"?kt(f,d):f}const i=(l=n==null?void 0:n.numeric)==null?void 0:l.decimals,a=(u=n==null?void 0:n.numeric)==null?void 0:u.thousandsSep;let s;return i!==void 0?s=t.toFixed(i):Number.isInteger(t)||Math.abs(t-Math.round(t))<1e-4?s=Math.round(t).toString():s=t.toFixed(2),a&&typeof a=="string"&&(s=kt(s,a)),s}function tn(t,n){const{eventsField:o,nField:e,separator:i="/",showPct:a=!1,thousandsSep:s,abbreviate:h}=n.events,c=t.metadata[o],r=t.metadata[e];if(c==null||r===void 0||r===null)return n.naText??"";const l=Number(c),u=Number(r);let f,d;h&&(l>=1e3||u>=1e3)?(f=l>=1e3?Rt(l):String(l),d=u>=1e3?Rt(u):String(u)):(f=String(l),d=String(u),s&&typeof s=="string"&&(f=kt(f,s),d=kt(d,s)));let g=`${f}${i}${d}`;if(a&&u>0){const N=(l/u*100).toFixed(1);g+=` (${N}%)`}return g}function nn(t,n,o,e){var h,c,r;if(t==null||Number.isNaN(t))return"";const i=((h=e==null?void 0:e.interval)==null?void 0:h.decimals)??2,a=((c=e==null?void 0:e.interval)==null?void 0:c.sep)??" ",s=(r=e==null?void 0:e.interval)==null?void 0:r.impreciseThreshold;return n==null||o===void 0||o===null||Number.isNaN(n)||Number.isNaN(o)?t.toFixed(i):s!=null&&n>0&&o/n>s?"—":`${t.toFixed(i)}${a}(${n.toFixed(i)}, ${o.toFixed(i)})`}function on(t,n){if(t==null||Number.isNaN(t))return(n==null?void 0:n.naText)??"";const o=n==null?void 0:n.pvalue,e=(o==null?void 0:o.digits)??2,i=(o==null?void 0:o.expThreshold)??.001,a=(o==null?void 0:o.abbrevThreshold)??null,s=(o==null?void 0:o.format)??"auto",h=(o==null?void 0:o.stars)??!1,c=(o==null?void 0:o.thresholds)??[.05,.01,.001];let r="";if(h&&(t<c[2]?r="***":t<c[1]?r="**":t<c[0]&&(r="*")),a!==null&&t<a)return`<${a}${r}`;if(s==="scientific"||s==="auto"&&t<i){const u=Math.floor(Math.log10(t));return`${(t/Math.pow(10,u)).toPrecision(e)}×10${In(u.toString())}${r}`}let l;return t>=.1?l=t.toFixed(e):t>=.01?l=t.toFixed(e+1):l=t.toFixed(e+2),`${l}${r}`}function _n(t,n){var a,s,h,c;const{type:o,field:e,options:i}=n;switch(o){case"interval":{const r=(a=i==null?void 0:i.interval)!=null&&a.point?t.metadata[i.interval.point]:t.point,l=(s=i==null?void 0:i.interval)!=null&&s.lower?t.metadata[i.interval.lower]:t.lower,u=(h=i==null?void 0:i.interval)!=null&&h.upper?t.metadata[i.interval.upper]:t.upper;return nn(r,l,u,i)}case"custom":return i!=null&&i.events?tn(t,i):String(t.metadata[e]??"");case"pvalue":return on(t.metadata[e],i);case"numeric":return Et(t.metadata[e],i);case"percent":return Et(t.metadata[e],i);case"sparkline":case"icon":case"stars":case"img":case"range":return"";case"badge":{const r=t.metadata[e];return r==null?"":`  ${String(r)}  `}case"bar":{if(((c=i==null?void 0:i.bar)==null?void 0:c.showLabel)===!1)return"";const r=t.metadata[e];return r==null?"":r>=100?r.toFixed(0):r>=10?r.toFixed(1):r.toFixed(2)}case"text":default:return String(t.metadata[e]??"")}}function ot(t,n){const o="⁰¹²³⁴⁵⁶⁷⁸⁹⁺⁻";let e=0;for(const i of t)o.includes(i)?e+=n*.3:"il1.,;:|!()[]{}' ".includes(i)?e+=n*.35:"×−".includes(i)?e+=n*.5:"mwMW@%".includes(i)?e+=n*.85:i>="0"&&i<="9"?e+=n*.6:e+=n*.55;return e}function Cn(t){if(!t||t.length===0)return{min:NaN,q1:NaN,median:NaN,q3:NaN,max:NaN};const n=t.filter(i=>i!=null&&!Number.isNaN(i)).sort((i,a)=>i-a);if(n.length===0)return{min:NaN,q1:NaN,median:NaN,q3:NaN,max:NaN};const o=n.length,e=i=>{if(o===1)return n[0];const a=(o-1)*i,s=Math.floor(a),h=Math.ceil(a);return s===h?n[s]:n[s]+(a-s)*(n[h]-n[s])};return{min:n[0],q1:e(.25),median:e(.5),q3:e(.75),max:n[o-1]}}function Dn(t,n,o){if(!t||t.length===0||Number.isNaN(n)||Number.isNaN(o))return[];const e=o-n,i=n-1.5*e,a=o+1.5*e;return t.filter(s=>s!=null&&!Number.isNaN(s)&&(s<i||s>a))}function en(t){const n=Cn(t),o=Dn(t,n.q1,n.q3);return{...n,outliers:o}}function kn(t){if(!t||t.length<2)return 1;const n=t.filter(d=>d!=null&&!Number.isNaN(d)).sort((d,g)=>d-g);if(n.length<2)return 1;const o=n.length,e=n.reduce((d,g)=>d+g,0)/o,i=n.reduce((d,g)=>d+(g-e)**2,0)/(o-1),a=Math.sqrt(i),s=Math.floor((o-1)*.25),h=Math.floor((o-1)*.75),c=n[s],l=n[h]-c,f=.9*Math.min(a,l/1.34)*Math.pow(o,-.2);return Math.max(f,.001)}function Fn(t){return Math.exp(-.5*t*t)/Math.sqrt(2*Math.PI)}function Hn(t,n,o=128){if(!t||t.length===0)return{x:[],y:[]};const e=t.filter(d=>d!=null&&!Number.isNaN(d));if(e.length===0)return{x:[],y:[]};const i=n??kn(e),a=Math.min(...e),s=Math.max(...e),h=3*i,c=a-h,l=(s+h-c)/(o-1),u=[],f=[];for(let d=0;d<o;d++){const g=c+d*l;u.push(g);let N=0;for(const I of e)N+=Fn((g-I)/i);N/=e.length*i,f.push(N)}return{x:u,y:f}}function Wn(t,n){if(t.y.length===0)return t;const o=Math.max(...t.y);if(o===0)return t;const e=t.y.map(i=>i/o*n);return{x:t.x,y:e}}function Sn(t,n){var r,l;const o=new Map,e=et(t.theme.typography.fontSizeBase),i=t.theme.typography.headerFontScale??1.05,a=Math.round(e*i*100)/100,s=t.data.rows,h=(t.theme.spacing.cellPaddingX??10)*2,c=(t.theme.spacing.groupPadding??8)*2;for(const u of n){if(u.width!=="auto"&&u.width!==null&&u.width!==void 0)continue;let f=0;u.header&&(f=Math.max(f,ot(u.header,a)));for(const N of s){if(((r=N.style)==null?void 0:r.type)==="header"||((l=N.style)==null?void 0:l.type)==="spacer")continue;const I=_n(N,u);I&&(f=Math.max(f,ot(I,e)))}const d=Tt.VISUAL_MIN[u.type]??Tt.MIN,g=Math.ceil(f+h+Lt.RENDERING_BUFFER);o.set(u.id,Math.min(Tt.MAX,Math.max(d,g)))}return vn(t.columns,o,a,c,Lt.RENDERING_BUFFER),o}function vn(t,n,o,e,i){function a(c){return c.isGroup?c.columns.flatMap(a):[c]}function s(c){const r=n.get(c.id);return r!==void 0?r:typeof c.width=="number"?c.width:Tt.MIN}function h(c){if(c.isGroup){for(const r of c.columns)h(r);if(c.header){const r=ot(c.header,o)+e+i,l=a(c),u=l.reduce((f,d)=>f+s(d),0);if(r>u&&l.length>0){const f=Math.ceil((r-u)/l.length);for(const d of l)n.set(d.id,s(d)+f)}}}}for(const c of t)h(c)}function rn(t,n,o){let e=o.filter(a=>a.groupId===t).length;const i=n.filter(a=>a.parentId===t);for(const a of i)e+=rn(a.id,n,o);return e}function an(t){var c,r;const n=et(t.theme.typography.fontSizeBase),o=(t.theme.spacing.cellPaddingX??10)*2;let e=0;const i=new Map,a=Array.isArray(t.data.groups)?t.data.groups:[];for(const l of a)i.set(l.id,l.depth);const s=l=>l?(i.get(l)??0)+1:0;t.data.labelHeader&&(e=Math.max(e,ot(t.data.labelHeader,n)));for(const l of t.data.rows)if(l.label){const u=s(l.groupId),f=((c=l.style)==null?void 0:c.indent)??0,g=(u+f)*q.INDENT_PER_LEVEL;let N=ot(l.label,n)+g;if((r=l.style)!=null&&r.badge){const I=String(l.style.badge),A=n*Mt.FONT_SCALE,_=ot(I,A)+Mt.PADDING*2;N+=Mt.GAP+_}e=Math.max(e,N)}for(const l of a)if(l.label){const u=l.depth*q.INDENT_PER_LEVEL,f=ot(l.label,n),g=`(${rn(l.id,a,t.data.rows)})`,N=n*.75,I=ot(g,N),A=u+Dt.CHEVRON_WIDTH+Dt.GAP+f+Dt.GAP+I+Dt.SAFETY_MARGIN;e=Math.max(e,A)}const h=Math.ceil(e+o+Lt.RENDERING_BUFFER);return Math.min(Tt.LABEL_MAX,Math.max(Tt.MIN,h))}function zt(t,n){const o=n.get(t.id);return o!==void 0?o:typeof t.width=="number"?t.width:$t.DEFAULT_COLUMN_WIDTH}function Gn(t,n,o=0){var st,W,K,Q,ht;const e=t.theme,i=e.spacing.rowHeight,a=e.spacing.padding,s=e.spacing.columnGap??8,h=Array.isArray(t.columns)?t.columns:[],c=ln(h,"left"),r=ln(h,"right"),l=Ft(c)||Ft(r)||Ft(h),u=l?2:1,f=e.spacing.cellPaddingY??4,N=(e.spacing.headerHeight/u+(l?f*2:0))*u,I=!!((st=t.labels)!=null&&st.title),A=!!((W=t.labels)!=null&&W.subtitle),x=!!((K=t.labels)!=null&&K.caption),_=!!((Q=t.labels)!=null&&Q.footnote),b=I?it.TITLE_HEIGHT:0,D=A?it.SUBTITLE_HEIGHT:0,p=b+D+(I||A?a:0),y=x?it.CAPTION_HEIGHT:0,m=_?it.FOOTNOTE_HEIGHT:0,w=y+m+(x||_?a:0),T=sn(t),C=!!t.data.overall;let k=0;for(const S of T){const O=S.type==="data"&&((ht=S.row.style)==null?void 0:ht.type)==="spacer";k+=O?i/2:i}C&&(k+=i*Tn.OVERALL_ROW_HEIGHT_MULTIPLIER);const H=Xt(h,"left"),z=Xt(h,"right"),V=Ut(h).filter(S=>S.position===void 0),j=[...H,...z,...V];let $,v;if(n.columnWidths){$=new Map;for(const[S,O]of Object.entries(n.columnWidths))S!=="__label__"&&$.set(S,O);v=n.columnWidths.__label__??an(t)}else $=Sn(t,j),v=an(t);const E=v+H.reduce((S,O)=>S+zt(O,$),0),F=z.reduce((S,O)=>S+zt(O,$),0),M=V.filter(S=>S.type!=="forest").reduce((S,O)=>S+zt(O,$),0),P=n.width??$t.DEFAULT_WIDTH,B=j.some(S=>S.type==="forest")||t.data.includeForest,Y=E+F+M;let U;if(!B)U=0;else if(typeof n.forestWidth=="number")U=n.forestWidth;else if(typeof t.layout.plotWidth=="number")U=t.layout.plotWidth;else{const S=P-Y-s*2-a*2;U=Math.max(S,$t.MIN_FOREST_WIDTH)}const X=a*2+Y+U+s*2,rt=Math.max(n.width??P,X);B&&rt>X&&typeof n.forestWidth!="number"&&typeof t.layout.plotWidth!="number"&&(U=rt-Y-a*2-s*2);const dt=(e.spacing.axisGap??12)+$t.AXIS_HEIGHT+$t.AXIS_LABEL_HEIGHT,at=p+a+N+k+dt+w+$t.BOTTOM_MARGIN;return{totalWidth:rt,totalHeight:n.height??at,tableWidth:E+F,forestWidth:U,headerHeight:N,rowHeight:i,plotHeight:k,axisHeight:$t.AXIS_HEIGHT,nullValue:o,summaryYPosition:k-i,showOverallSummary:C,headerTextHeight:p,footerTextHeight:w,titleY:a+it.TITLE_HEIGHT-8,subtitleY:a+b+it.SUBTITLE_HEIGHT-4,mainY:p+a,footerY:p+a+N+k+dt+8,autoWidths:$,labelWidth:v}}function sn(t){var u;const n=t.data.rows,o=Array.isArray(t.data.groups)?t.data.groups:[];if(o.length===0)return n.map(f=>({type:"data",row:f,depth:0}));const e=new Map;for(const f of o)e.set(f.id,f);const i=new Map;for(const f of n){const d=f.groupId??null;i.has(d)||i.set(d,[]),i.get(d).push(f)}const a=new Set;for(const f of i.keys()){if(!f)continue;let d=f;for(;d;)a.add(d),d=(u=e.get(d))==null?void 0:u.parentId}function s(f){return o.filter(d=>(d.parentId??null)===f&&a.has(d.id))}function h(f){if(!f)return 0;const d=e.get(f);return d?d.depth+1:0}function c(f){var g;let d=((g=i.get(f))==null?void 0:g.length)??0;for(const N of s(f))d+=c(N.id);return d}const r=[];function l(f){if(f){const g=e.get(f);if(!g)return;const N=c(f);r.push({type:"group_header",groupId:g.id,label:g.label,depth:g.depth,rowCount:N})}for(const g of s(f))l(g.id);const d=i.get(f)??[];for(const g of d)r.push({type:"data",row:g,depth:h(g.groupId)})}return l(null),r}function Vt(t){const n=[];for(const o of t)o.isGroup?n.push(...Vt(o.columns)):n.push(o);return n}function Ut(t){const n=[];for(const o of t)o.isGroup?n.push(...Vt(o.columns)):n.push(o);return n}function Xt(t,n){if(n===void 0)return Ut(t);const o=[];for(const e of t)e.position===n&&(e.isGroup?o.push(...Vt(e.columns)):o.push(e));return o}function ln(t,n){return t.filter(o=>o.position===n)}function Ft(t){return t.some(n=>n.isGroup)}function et(t){let n;return t.endsWith("rem")?n=parseFloat(t)*it.REM_BASE:t.endsWith("px")?n=parseFloat(t):n=it.DEFAULT_FONT_SIZE,Math.round(n*100)/100}function Ht(t,n,o){return o==="right"?{textX:t+n-q.TEXT_PADDING,anchor:"end"}:o==="center"?{textX:t+n/2,anchor:"middle"}:{textX:t+q.TEXT_PADDING,anchor:"start"}}function J(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function cn(t,n,o,e=0){const i=n-e*2;if(ot(t,o)<=i)return t;const s="…",h=o*.55;let c=0,r=t.length;for(;c<r;){const l=Math.ceil((c+r)/2),u=t.slice(0,l);ot(u,o)+h<=i?c=l:r=l-1}return c===0?s:t.slice(0,c)+s}function Ln(t){return Math.abs(t)<.01?"0":Math.abs(t)>=100?t.toFixed(0):Math.abs(t)>=10?t.toFixed(1):t.toFixed(2)}function wt(t,n){const[o,e]=t,[i,a]=n,s=(a-i)/(e-o),h=c=>i+(c-o)*s;return h.domain=()=>t,h.range=()=>n,h.ticks=c=>{const r=(e-o)/(c-1),l=[];for(let u=0;u<c;u++)l.push(o+r*u);return l},h}function At(t,n){const[o,e]=t.map(l=>Math.max(l,.001)),[i,a]=n,s=Math.log10(o),h=Math.log10(e),c=(a-i)/(h-s),r=l=>{const u=Math.log10(Math.max(l,.001));return i+(u-s)*c};return r.domain=()=>[o,e],r.range=()=>n,r.ticks=l=>{const u=[],f=Math.floor(Math.log10(o)),d=Math.ceil(Math.log10(e));for(let g=f;g<=d;g++){const N=Math.pow(10,g);for(const I of[1,2,5]){const A=N*I;A>=o&&A<=e&&u.push(A)}}return u.length>0?u:[o,e]},r}function Pn(t,n,o,e){const i=o.scale==="log",a=yt,s=Math.max(n-yt,a+50);if(e!=null&&e.xDomain){const u=e.xDomain,f=e.clipBounds??u,d=Zt(f,t.theme.axis,o.scale,o.nullValue);return i?{scale:At([Math.max(u[0],.01),Math.max(u[1],.02)],[a,s]),clipBounds:f,ticks:d}:{scale:wt(u,[a,s]),clipBounds:f,ticks:d}}const h=yn({rows:t.data.rows,config:t.theme.axis,scale:o.scale,nullValue:o.nullValue,forestWidth:n,pointSize:t.theme.shapes.pointSize,effects:o.effects,pointCol:o.pointCol,lowerCol:o.lowerCol,upperCol:o.upperCol}),{plotRegion:c,axisLimits:r,ticks:l}=h;return i?{scale:At([Math.max(c[0],.01),Math.max(c[1],.02)],[a,s]),clipBounds:r,ticks:l}:{scale:wt(c,[a,s]),clipBounds:r,ticks:l}}function Rn(t,n,o){var a,s;const e=[],i=o.spacing.padding;if((a=t.labels)!=null&&a.title){const h=et(o.typography.fontSizeLg);e.push(`<text x="${i}" y="${n.titleY}"
      font-family="${o.typography.fontFamily}"
      font-size="${h}px"
      font-weight="${o.typography.fontWeightBold}"
      fill="${o.colors.foreground}">${J(t.labels.title)}</text>`)}if((s=t.labels)!=null&&s.subtitle){const h=et(o.typography.fontSizeBase);e.push(`<text x="${i}" y="${n.subtitleY}"
      font-family="${o.typography.fontFamily}"
      font-size="${h}px"
      font-weight="${o.typography.fontWeightNormal}"
      fill="${o.colors.secondary}">${J(t.labels.subtitle)}</text>`)}return e.join(`
`)}function Bn(t,n,o){var h,c,r,l;const e=[],i=o.spacing.padding;let a=n.footerY;if(!!((h=t.labels)!=null&&h.caption)||!!((c=t.labels)!=null&&c.footnote)){const u=n.footerY-8;e.push(`<line x1="${i}" x2="${n.totalWidth-i}"
      y1="${u}" y2="${u}"
      stroke="${o.colors.border}" stroke-width="1"/>`)}if((r=t.labels)!=null&&r.caption){const u=et(o.typography.fontSizeSm);e.push(`<text x="${i}" y="${a}"
      font-family="${o.typography.fontFamily}"
      font-size="${u}px"
      font-weight="${o.typography.fontWeightNormal}"
      fill="${o.colors.secondary}">${J(t.labels.caption)}</text>`),a+=it.CAPTION_HEIGHT}if((l=t.labels)!=null&&l.footnote){const u=et(o.typography.fontSizeSm);e.push(`<text x="${i}" y="${a}"
      font-family="${o.typography.fontFamily}"
      font-size="${u}px"
      font-weight="${o.typography.fontWeightNormal}"
      font-style="italic"
      fill="${o.colors.muted}">${J(t.labels.footnote)}</text>`)}return e.join(`
`)}function zn(t,n,o,e,i,a,s){const h=[],c=n+1,r=s.groupHeaders;let l,u,f,d,g;if(c===1?(l=et((r==null?void 0:r.level1FontSize)??s.typography.fontSizeBase),u=(r==null?void 0:r.level1FontWeight)??s.typography.fontWeightBold,f=(r==null?void 0:r.level1Italic)??!1,d=(r==null?void 0:r.level1Background)??null,g=(r==null?void 0:r.level1BorderBottom)??!1):c===2?(l=et((r==null?void 0:r.level2FontSize)??s.typography.fontSizeBase),u=(r==null?void 0:r.level2FontWeight)??s.typography.fontWeightMedium,f=(r==null?void 0:r.level2Italic)??!0,d=(r==null?void 0:r.level2Background)??null,g=(r==null?void 0:r.level2BorderBottom)??!1):(l=et((r==null?void 0:r.level3FontSize)??s.typography.fontSizeBase),u=(r==null?void 0:r.level3FontWeight)??s.typography.fontWeightNormal,f=(r==null?void 0:r.level3Italic)??!1,d=(r==null?void 0:r.level3Background)??null,g=(r==null?void 0:r.level3BorderBottom)??!1),!d){const x=s.colors.primary,_=c===1?.15:c===2?.1:.06,b=x.replace("#",""),D=parseInt(b.substring(0,2),16),p=parseInt(b.substring(2,4),16),y=parseInt(b.substring(4,6),16);d=`rgba(${D}, ${p}, ${y}, ${_})`}const N=e+i/2+l*it.TEXT_BASELINE_ADJUSTMENT,I=n*((r==null?void 0:r.indentPerLevel)??q.INDENT_PER_LEVEL);h.push(`<rect x="${o}" y="${e}"
    width="${a}" height="${i}"
    fill="${d}"/>`),g&&h.push(`<line x1="${o}" x2="${o+a}" y1="${e+i}" y2="${e+i}"
      stroke="${s.colors.border}" stroke-width="1" opacity="0.5"/>`);const A=f?' font-style="italic"':"";return h.push(`<text x="${o+q.TEXT_PADDING+I}" y="${N}"
    font-family="${s.typography.fontFamily}"
    font-size="${l}px"
    font-weight="${u}"${A}
    fill="${s.colors.foreground}">${J(t)}</text>`),h.join(`
`)}function Vn(t,n){const o=new Map;for(const e of n)if(e.type==="bar"){let i=0;for(const a of t){const s=a.metadata[e.field];typeof s=="number"&&s>i&&(i=s)}o.set(e.field,i>0?i:1)}return o}function Un(t,n){var e,i,a,s,h,c,r,l,u,f,d,g,N,I,A,x,_,b,D;if(n.type==="interval"){const p=(i=(e=n.options)==null?void 0:e.interval)!=null&&i.point?t.metadata[n.options.interval.point]:t.point,y=(s=(a=n.options)==null?void 0:a.interval)!=null&&s.lower?t.metadata[n.options.interval.lower]:t.lower,m=(c=(h=n.options)==null?void 0:h.interval)!=null&&c.upper?t.metadata[n.options.interval.upper]:t.upper;return nn(p,y,m,n.options)}if(n.type==="numeric"){const p=t.metadata[n.field];return typeof p=="number"?Et(p,n.options):((r=n.options)==null?void 0:r.naText)??""}if(n.type==="custom"&&((l=n.options)!=null&&l.events))return tn(t,n.options);if(n.type==="pvalue"){const p=t.metadata[n.field];return typeof p!="number"?((u=n.options)==null?void 0:u.naText)??"":on(p,n.options)}if(n.type==="icon"){const p=t.metadata[n.field];if(p==null)return"";const y=String(p),m=(d=(f=n.options)==null?void 0:f.icon)==null?void 0:d.mapping;return m&&y in m?m[y]:y}if(n.type==="badge"){const p=t.metadata[n.field];return p!=null?String(p):""}if(n.type==="stars"){const p=t.metadata[n.field];if(typeof p!="number")return"";const y=((N=(g=n.options)==null?void 0:g.stars)==null?void 0:N.maxStars)??5,m=Math.max(0,Math.min(y,p)),w=Math.floor(m),T=y-w;return"★".repeat(w)+"☆".repeat(T)}if(n.type==="img")return((A=(I=n.options)==null?void 0:I.img)==null?void 0:A.fallback)??"[IMG]";if(n.type==="reference"){const p=t.metadata[n.field];if(p==null)return"";const y=String(p),m=((_=(x=n.options)==null?void 0:x.reference)==null?void 0:_.maxChars)??30;return y.length<=m?y:y.substring(0,m)+"..."}if(n.type==="range"){const p=(b=n.options)==null?void 0:b.range;if(!p)return"";const y=t.metadata[p.minField],m=t.metadata[p.maxField],w=p.separator??" – ",T=p.decimals,C=k=>typeof k!="number"?"":T==null?Number.isInteger(k)?String(k):k.toFixed(1):k.toFixed(T);return y===null&&m===null?"":y===null?C(m):m===null?C(y):`${C(y)}${w}${C(m)}`}const o=t.metadata[n.field];return o!=null?String(o):((D=n.options)==null?void 0:D.naText)??""}function Xn(t,n,o,e,i){const a=t.filter(l=>Number.isFinite(l));if(a.length===0)return"";if(a.length===1){const l=n+e/2,u=o+i/2;return`M${l.toFixed(1)},${u.toFixed(1)}`}const s=Math.min(...a),c=Math.max(...a)-s||1;return`M${a.map((l,u)=>{const f=n+u/(a.length-1)*e,d=o+i-(l-s)/c*i;return`${f.toFixed(1)},${d.toFixed(1)}`}).join("L")}`}function qn(t,n,o,e,i,a=[],s,h=0,c=1/0,r,l=!1){var y;let u;if(a.length===0){const m=!l||t.point!=null&&t.point>0?t.point:null,w=!l||t.lower!=null&&t.lower>0?t.lower:null,T=!l||t.upper!=null&&t.upper>0?t.upper:null;u=[{point:m,lower:w,upper:T,color:null,shape:null,opacity:null}]}else u=a.map(m=>({point:ft(t.metadata,t.point,m.pointCol,"point",l),lower:ft(t.metadata,t.lower,m.lowerCol,"lower",l),upper:ft(t.metadata,t.upper,m.upperCol,"upper",l),color:m.color??null,shape:m.shape??null,opacity:m.opacity??null}));const f=u.filter(m=>m.point!=null&&!Number.isNaN(m.point)&&m.lower!=null&&!Number.isNaN(m.lower)&&m.upper!=null&&!Number.isNaN(m.upper));if(f.length===0)return"";const d=e.shapes.pointSize,g=e.shapes.lineWidth,N=e.colors.intervalLine,I=((y=t.style)==null?void 0:y.type)==="summary",x=e.shapes.summaryHeight/2;function _(m){var T;if(m&&((T=t.markerStyle)==null?void 0:T.size)!=null)return d*t.markerStyle.size;const w=s?t.metadata[s]:void 0;if(w){const C=.5+Math.sqrt(w/100)*1.5;return Math.min(Math.max(d*C,3),d*2.5)}return d}function b(m,w){const T=w===0,C=t.markerStyle,k=e.shapes.effectColors,H=e.shapes.markerShapes,z=["square","circle","diamond","triangle"];let V;T&&(C!=null&&C.color)?V=C.color:m.color?V=m.color:k&&k.length>0?V=k[w%k.length]:V=e.colors.interval??e.colors.primary??"#2563eb";let j;T&&(C!=null&&C.shape)?j=C.shape:m.shape?j=m.shape:H&&H.length>0?j=H[w%H.length]:j=z[w%z.length];let $;return T&&(C==null?void 0:C.opacity)!=null?$=C.opacity:m.opacity!=null?$=m.opacity:$=1,{color:V,shape:j,opacity:$}}function D(m,w,T,C){const{color:k,shape:H,opacity:z}=C,V=z<1?` fill-opacity="${z}"`:"";switch(H){case"circle":return`<circle cx="${m}" cy="${w}" r="${T}" fill="${k}"${V}/>`;case"diamond":return`<polygon points="${[`${m},${w-T}`,`${m+T},${w}`,`${m},${w+T}`,`${m-T},${w}`].join(" ")}" fill="${k}"${V}/>`;case"triangle":return`<polygon points="${[`${m},${w-T}`,`${m+T},${w+T}`,`${m-T},${w+T}`].join(" ")}" fill="${k}"${V}/>`;default:return`<rect x="${m-T}" y="${w-T}" width="${T*2}" height="${T*2}" fill="${k}"${V}/>`}}const p=[];return f.forEach((m,w)=>{const T=n+wn(w,f.length),C=o(m.lower),k=o(m.upper),H=o(m.point),z=b(m,w),V=_(w===0),j=N;if(I){const $=z.opacity<1?` fill-opacity="${z.opacity}"`:"",v=[`${C},${T}`,`${H},${T-x}`,`${k},${T}`,`${H},${T+x}`].join(" ");p.push(`
        <g class="interval effect-${w} summary">
          <polygon points="${v}"
            fill="${z.color}"${$} stroke="${e.colors.summaryBorder}" stroke-width="1"/>
        </g>`)}else{const $=h+yt,v=h+c-yt,E=r?m.lower<r[0]:C<$,F=r?m.upper>r[1]:k>v;let M,P;if(r){const dt=Math.max(r[0],Math.min(r[1],m.lower)),at=Math.max(r[0],Math.min(r[1],m.upper));M=o(dt),P=o(at)}else M=Math.max($,Math.min(v,C)),P=Math.max($,Math.min(v,k));const R=Nn(e),B=R.height/2,Y=r?o(r[0]):$,U=r?o(r[1]):v;let X="";E?X=`<path d="${Jt("left",Y,T,R)}" fill="${R.color}"/>`:X=`<line x1="${M}" x2="${M}" y1="${T-B}" y2="${T+B}" stroke="${j}" stroke-width="${g}"/>`;let rt="";F?rt=`<path d="${Jt("right",U,T,R)}" fill="${R.color}"/>`:rt=`<line x1="${P}" x2="${P}" y1="${T-B}" y2="${T+B}" stroke="${j}" stroke-width="${g}"/>`;const xt=r?o(Math.max(r[0],Math.min(r[1],m.point))):Math.max($,Math.min(v,H));p.push(`
        <g class="interval effect-${w}">
          <line x1="${M}" x2="${P}" y1="${T}" y2="${T}"
            stroke="${j}" stroke-width="${g}"/>
          ${X}
          ${rt}
          ${D(xt,T,V,z)}
        </g>`)}}),p.join("")}function Yn(t,n,o,e,i,a,s,h){const r=h.shapes.summaryHeight/2,[l,u]=i.domain().map(D=>i(D)),f=Math.min(l,u),d=Math.max(l,u),g=i(n),N=i(t),I=i(o),A=a+Math.max(f,Math.min(d,g)),x=a+Math.max(f,Math.min(d,N)),_=a+Math.max(f,Math.min(d,I));return`<polygon points="${[`${A},${e}`,`${x},${e-r}`,`${_},${e}`,`${x},${e+r}`].join(" ")}"
    fill="${h.colors.summaryFill}"
    stroke="${h.colors.summaryBorder}"
    stroke-width="1"/>`}function jn(t,n,o,e,i,a,s,h){const c=[],r=a.effects,l=r.length;if(!r.some(A=>{const x=t.metadata[A.value];return x!=null&&!Number.isNaN(x)}))return"";const f=o*.7,d=l>1?2:0,g=(f-d*(l-1))/l,N=Math.max(4,g),I=h.shapes.effectColors??["#3b82f6","#22c55e","#f59e0b","#ef4444","#8b5cf6"];return r.forEach((A,x)=>{const _=t.metadata[A.value];if(_==null||Number.isNaN(_))return;const b=n-f/2+x*(N+d),D=e+s(Math.min(0,_)),p=Math.abs(s(_)-s(0)),y=A.color??I[x%I.length],m=A.opacity??.85;c.push(`<rect
      x="${D}" y="${b}"
      width="${Math.max(1,p)}" height="${N}"
      fill="${y}" fill-opacity="${m}" rx="2"
      class="viz-bar-segment"/>`)}),c.join(`
`)}function On(t,n,o,e,i,a,s,h){const c=[],r=a.effects,l=r.length,u=r.map(x=>{if(x.data){const _=t.metadata[x.data];return!_||!Array.isArray(_)||_.length===0?null:en(_)}if(x.min&&x.q1&&x.median&&x.q3&&x.max){const _=t.metadata[x.min],b=t.metadata[x.q1],D=t.metadata[x.median],p=t.metadata[x.q3],y=t.metadata[x.max];if([_,b,D,p,y].some(w=>w==null||Number.isNaN(w)))return null;let m=[];if(x.outliers){const w=t.metadata[x.outliers];w&&Array.isArray(w)&&(m=w)}return{min:_,q1:b,median:D,q3:p,max:y,outliers:m}}return null});if(!u.some(x=>x!==null))return"";const d=o*.7,g=l>1?2:0,N=Math.max(8,(d-(l-1)*g)/l),I=h.shapes.effectColors??["#3b82f6","#22c55e","#f59e0b","#ef4444","#8b5cf6"],A=h.colors.foreground??"#1a1a1a";return r.forEach((x,_)=>{const b=u[_];if(!b)return;const D=n-d/2+_*(N+g),p=D+N/2,y=x.color??I[_%I.length],m=x.fillOpacity??.7;c.push(`<line
      x1="${e+s(b.min)}" x2="${e+s(b.q1)}"
      y1="${p}" y2="${p}"
      stroke="${A}" stroke-width="1"/>`),c.push(`<line
      x1="${e+s(b.min)}" x2="${e+s(b.min)}"
      y1="${p-N/4}" y2="${p+N/4}"
      stroke="${A}" stroke-width="1"/>`),c.push(`<line
      x1="${e+s(b.q3)}" x2="${e+s(b.max)}"
      y1="${p}" y2="${p}"
      stroke="${A}" stroke-width="1"/>`),c.push(`<line
      x1="${e+s(b.max)}" x2="${e+s(b.max)}"
      y1="${p-N/4}" y2="${p+N/4}"
      stroke="${A}" stroke-width="1"/>`);const w=Math.max(2,s(b.q3)-s(b.q1));if(c.push(`<rect
      x="${e+s(b.q1)}" y="${D}"
      width="${w}" height="${N}"
      fill="${y}" fill-opacity="${m}"
      stroke="${A}" stroke-width="1"/>`),c.push(`<line
      x1="${e+s(b.median)}" x2="${e+s(b.median)}"
      y1="${D}" y2="${D+N}"
      stroke="${A}" stroke-width="2"/>`),a.showOutliers!==!1&&b.outliers.length>0)for(const T of b.outliers)c.push(`<circle
          cx="${e+s(T)}" cy="${p}"
          r="2.5"
          fill="none" stroke="${y}" stroke-width="1.5"/>`)}),c.join(`
`)}function Kn(t,n,o,e,i,a,s,h){const c=[],r=a.effects,l=r.length,u=r.map(b=>{const D=t.metadata[b.data];return!D||!Array.isArray(D)||D.length<2?null:Hn(D,a.bandwidth)}),f=r.map(b=>{const D=t.metadata[b.data];if(!D||!Array.isArray(D)||D.length<2)return null;const p=D.filter(w=>w!=null&&!Number.isNaN(w)).sort((w,T)=>w-T);if(p.length===0)return null;const y=p.length,m=w=>{if(y===1)return p[0];const T=(y-1)*w,C=Math.floor(T),k=Math.ceil(T);return C===k?p[C]:p[C]+(T-C)*(p[k]-p[C])};return{q1:m(.25),median:m(.5),q3:m(.75)}});if(!u.some(b=>b!==null))return"";const g=o*.8,N=l>1?2:0,I=Math.max(10,(g-(l-1)*N)/l),A=I/2,x=h.shapes.effectColors??["#3b82f6","#22c55e","#f59e0b","#ef4444","#8b5cf6"],_=h.colors.foreground??"#1a1a1a";return r.forEach((b,D)=>{const p=u[D],y=f[D];if(!p||p.x.length<2)return;const m=n-g/2+I/2+D*(I+N),w=b.color??x[D%x.length],T=b.fillOpacity??.5,C=Wn(p,A),k=[];for(let H=0;H<C.x.length;H++){const z=e+s(C.x[H]),V=m-C.y[H];k.push(H===0?`M ${z} ${V}`:`L ${z} ${V}`)}for(let H=C.x.length-1;H>=0;H--){const z=e+s(C.x[H]),V=m+C.y[H];k.push(`L ${z} ${V}`)}if(k.push("Z"),c.push(`<path
      d="${k.join(" ")}"
      fill="${w}" fill-opacity="${T}"
      stroke="${_}" stroke-width="0.5"/>`),a.showMedian!==!1&&y){const H=e+s(y.median);c.push(`<line
        x1="${H}" x2="${H}"
        y1="${m-A*.6}" y2="${m+A*.6}"
        stroke="${_}" stroke-width="2"/>`)}if(a.showQuartiles&&y){const H=e+s(y.q1),z=e+s(y.q3);c.push(`<line
        x1="${H}" x2="${H}"
        y1="${m-A*.4}" y2="${m+A*.4}"
        stroke="${_}" stroke-width="1" stroke-dasharray="2,2"/>`),c.push(`<line
        x1="${z}" x2="${z}"
        y1="${m-A*.4}" y2="${m+A*.4}"
        stroke="${_}" stroke-width="1" stroke-dasharray="2,2"/>`)}}),c.join(`
`)}function Zn(t,n,o){var h,c;const e=n.scale==="log",i=yt;let a=(h=n.axisRange)==null?void 0:h[0],s=(c=n.axisRange)==null?void 0:c[1];if(a==null||s==null){const r=[];for(const l of t)for(const u of n.effects){const f=l.metadata[u.value];f!=null&&!Number.isNaN(f)&&r.push(f)}r.length>0?(a=a??Math.min(0,...r),s=s??Math.max(...r)*1.1):(a=a??0,s=s??100)}return e?At([Math.max(.01,a),s],[i,o-i]):wt([a,s],[i,o-i])}function Jn(t,n,o){var h,c;const e=n.scale==="log",i=yt;let a=(h=n.axisRange)==null?void 0:h[0],s=(c=n.axisRange)==null?void 0:c[1];if(a==null||s==null){const r=[];for(const l of t)for(const u of n.effects)if(u.data){const f=l.metadata[u.data];if(f&&Array.isArray(f)){const d=en(f);r.push(d.min,d.max),n.showOutliers!==!1&&r.push(...d.outliers)}}else if(u.min&&u.max){const f=l.metadata[u.min],d=l.metadata[u.max];f!=null&&!Number.isNaN(f)&&r.push(f),d!=null&&!Number.isNaN(d)&&r.push(d)}if(r.length>0){const l=Math.min(...r),u=Math.max(...r),f=u-l;a=a??l-f*.05,s=s??u+f*.05}else a=a??0,s=s??100}return e?At([Math.max(.01,a),s],[i,o-i]):wt([a,s],[i,o-i])}function Qn(t,n,o){var h,c;const e=n.scale==="log",i=yt;let a=(h=n.axisRange)==null?void 0:h[0],s=(c=n.axisRange)==null?void 0:c[1];if(a==null||s==null){const r=[];for(const l of t)for(const u of n.effects){const f=l.metadata[u.data];f&&Array.isArray(f)&&r.push(...f.filter(d=>d!=null&&!Number.isNaN(d)))}if(r.length>0){a=a??Math.min(...r),s=s??Math.max(...r);const l=(s??0)-(a??0);a=(a??0)-l*.1,s=(s??0)+l*.1}else a=a??0,s=s??100}return e?At([Math.max(.01,a),s],[i,o-i]):wt([a,s],[i,o-i])}function qt(t,n,o,e,i,a,s){const h=[],c=et(o.typography.fontSizeSm),r=Pt.EDGE_THRESHOLD,l=I=>I<r?"start":I>a-r?"end":"middle",u=I=>I<r?2:I>a-r?-2:0;h.push(`<line x1="${i}" x2="${i+a}"
    y1="0" y2="0" stroke="${o.colors.border}" stroke-width="1"/>`);const f=t.domain(),d=5,g=[],N=f[1]-f[0];for(let I=0;I<=d;I++)g.push(f[0]+N*I/d);for(const I of g){const A=t(I),x=i+A,_=l(A),b=u(A),D=Et(I);h.push(`<line x1="${x}" x2="${x}" y1="0" y2="4" stroke="${o.colors.border}" stroke-width="1"/>`),h.push(`<text x="${x+b}" y="14"
      text-anchor="${_}"
      font-family="${o.typography.fontFamily}"
      font-size="${c}px"
      font-weight="${o.typography.fontWeightNormal}"
      fill="${o.colors.foreground}">${D}</text>`)}return e&&h.push(`<text x="${i+a/2}" y="28"
      text-anchor="middle"
      font-family="${o.typography.fontFamily}"
      font-size="${c}px"
      font-weight="${o.typography.fontWeightMedium}"
      fill="${o.colors.foreground}">${J(e)}</text>`),h.join(`
`)}function to(t,n,o,e,i,a,s=1,h){const c=[],r=typeof o.axis.tickCount=="number"?o.axis.tickCount:q.DEFAULT_TICK_COUNT,l=eo(t,r,o,s,a,h),u=et(o.typography.fontSizeSm),f=Pt.EDGE_THRESHOLD,d=N=>N<f?"start":N>a-f?"end":"middle",g=N=>N<f?2:N>a-f?-2:0;c.push(`<line x1="${i}" x2="${i+a}"
    y1="0" y2="0" stroke="${o.colors.border}" stroke-width="1"/>`);for(const N of l){const I=t(N),A=i+I,x=d(I),_=g(I);c.push(`<line x1="${A}" x2="${A}" y1="0" y2="4"
      stroke="${o.colors.border}" stroke-width="1"/>`),c.push(`<text x="${A+_}" y="16" text-anchor="${x}"
      font-family="${o.typography.fontFamily}"
      font-size="${u}px"
      font-weight="${o.typography.fontWeightNormal}"
      fill="${o.colors.secondary}">${Ln(N)}</text>`)}return e&&c.push(`<text x="${i+a/2}" y="28"
      text-anchor="middle"
      font-family="${o.typography.fontFamily}"
      font-size="${u}px"
      font-weight="${o.typography.fontWeightMedium}"
      fill="${o.colors.secondary}">${J(e)}</text>`),`<g transform="translate(0, ${n.mainY+n.headerHeight+n.plotHeight})">${c.join(`
`)}</g>`}function no(t,n,o,e,i,a,s,h,c,r){const l=[],u=et(a.typography.fontSizeBase),f=a.typography.headerFontScale??1.05,d=Math.round(u*f*100)/100,g=a.typography.fontWeightBold,N=a.typography.fontWeightBold,I=Ft(t),A=(x,_)=>x+_/2+d*it.TEXT_BASELINE_ADJUSTMENT;if(I){const x=i/2,_=i/2;let b=o;l.push(`<text x="${b+q.TEXT_PADDING}" y="${A(e,i)}"
      font-family="${a.typography.fontFamily}"
      font-size="${d}px"
      font-weight="${g}"
      fill="${a.colors.foreground}">${J(s)}</text>`),b+=h;const D=[];for(const p of t)if(p.isGroup){const y=p.columns.reduce((w,T)=>T.isGroup?w+T.columns.reduce((C,k)=>C+r(k),0):w+r(T),0),m=b+y/2;l.push(`<text x="${m}" y="${A(e,x)}"
          font-family="${a.typography.fontFamily}"
          font-size="${d}px"
          font-weight="${N}"
          text-anchor="middle"
          fill="${a.colors.foreground}">${J(p.header)}</text>`),D.push({x1:b,x2:b+y}),b+=y}else{const y=r(p),m=p.headerAlign??p.align,{textX:w,anchor:T}=Ht(b,y,m),C=cn(p.header,y,d,q.TEXT_PADDING);l.push(`<text x="${w}" y="${A(e,i)}"
          font-family="${a.typography.fontFamily}"
          font-size="${d}px"
          font-weight="${g}"
          text-anchor="${T}"
          fill="${a.colors.foreground}">${J(C)}</text>`),b+=y}for(const p of D)l.push(`<line x1="${p.x1}" x2="${p.x2}"
        y1="${e+x}" y2="${e+x}"
        stroke="${a.colors.border}" stroke-width="1"/>`);b=o+h;for(const p of t)if(p.isGroup){for(const y of p.columns)if(!y.isGroup){const m=r(y),w=y.headerAlign??y.align,{textX:T,anchor:C}=Ht(b,m,w);l.push(`<text x="${T}" y="${A(e+x,_)}"
              font-family="${a.typography.fontFamily}"
              font-size="${d}px"
              font-weight="${g}"
              text-anchor="${C}"
              fill="${a.colors.foreground}">${J(y.header)}</text>`),b+=m}}else b+=r(p)}else{let x=o;l.push(`<text x="${x+q.TEXT_PADDING}" y="${A(e,i)}"
      font-family="${a.typography.fontFamily}"
      font-size="${d}px"
      font-weight="${g}"
      fill="${a.colors.foreground}">${J(s)}</text>`),x+=h;for(const _ of n){const b=r(_),D=_.headerAlign??_.align,{textX:p,anchor:y}=Ht(x,b,D),m=cn(_.header,b,d,q.TEXT_PADDING);l.push(`<text x="${p}" y="${A(e,i)}"
        font-family="${a.typography.fontFamily}"
        font-size="${d}px"
        font-weight="${g}"
        text-anchor="${y}"
        fill="${a.colors.foreground}">${J(m)}</text>`),x+=b}}return l.join(`
`)}function oo(t,n,o,e,i,a,s,h,c,r,l,u){var _,b,D,p,y,m,w,T,C,k,H,z,V,j,$,v,E,F,M,P,R,B,Y,U,X,rt,xt,dt,at;const f=[],d=et(a.typography.fontSizeBase),g=e+i/2+d*it.TEXT_BASELINE_ADJUSTMENT,N=h*q.INDENT_PER_LEVEL+(((_=t.style)==null?void 0:_.indent)??0)*q.INDENT_PER_LEVEL,I=(b=t.style)!=null&&b.bold||(D=t.style)!=null&&D.emphasis?a.typography.fontWeightBold:a.typography.fontWeightNormal,A=(p=t.style)!=null&&p.italic?"italic":"normal";let x=a.colors.foreground;if((y=t.style)!=null&&y.color?x=t.style.color:(m=t.style)!=null&&m.muted?x=a.colors.muted:(w=t.style)!=null&&w.accent&&(x=a.colors.accent),f.push(`<text x="${o+q.TEXT_PADDING+N}" y="${g}"
    font-family="${a.typography.fontFamily}"
    font-size="${d}px"
    font-weight="${I}"
    font-style="${A}"
    fill="${x}">${J(t.label)}</text>`),(T=t.style)!=null&&T.badge){const st=String(t.style.badge),W=d*Mt.FONT_SCALE,K=W+Mt.PADDING*2,Q=ot(t.label,d),ht=o+q.TEXT_PADDING+N+Q+Mt.GAP,O=ot(st,W)+Mt.PADDING*2,G=e+(i-K)/2;f.push(`<rect x="${ht}" y="${G}" width="${O}" height="${K}"
      rx="3" fill="${a.colors.primary}" opacity="0.15"/>`),f.push(`<text x="${ht+O/2}" y="${G+K/2+W*.35}"
      text-anchor="middle"
      font-family="${a.typography.fontFamily}"
      font-size="${W}px"
      font-weight="${a.typography.fontWeightBold}"
      fill="${a.colors.primary}">${J(st)}</text>`)}for(let st=0;st<n.length;st++){const W=n[st],K=u[st],Q=l(W);if(W.type==="forest"||W.type==="viz_bar"||W.type==="viz_boxplot"||W.type==="viz_violin")continue;const ht=Un(t,W),{textX:S,anchor:O}=Ht(K,Q,W.align);if(W.type==="bar"&&typeof t.metadata[W.field]=="number"){const G=t.metadata[W.field],L=c.get(W.field),tt=((k=(C=W.options)==null?void 0:C.bar)==null?void 0:k.maxValue)??L??100,nt=((z=(H=W.options)==null?void 0:H.bar)==null?void 0:z.color)??a.colors.primary,Z=a.shapes.pointSize*2,gt=Q-q.TEXT_PADDING*2-50,lt=Math.min(G/tt*gt,gt),ut=t.style,mt=ut!=null&&ut.bold||ut!=null&&ut.emphasis?a.typography.fontWeightBold:a.typography.fontWeightNormal;f.push(`<rect x="${K+q.TEXT_PADDING}" y="${e+i/2-Z/2}"
        width="${Math.max(0,lt)}" height="${Z}"
        fill="${nt}" opacity="0.7" rx="2"/>`),f.push(`<text x="${K+Q-q.TEXT_PADDING}" y="${g}"
        font-family="${a.typography.fontFamily}"
        font-size="${d}px"
        font-weight="${mt}"
        text-anchor="end"
        fill="${a.colors.foreground}">${Et(G)}</text>`)}else if(W.type==="sparkline"&&Array.isArray(t.metadata[W.field])){let G=t.metadata[W.field];Array.isArray(G[0])&&(G=G[0]);const L=((j=(V=W.options)==null?void 0:V.sparkline)==null?void 0:j.height)??16,tt=((v=($=W.options)==null?void 0:$.sparkline)==null?void 0:v.color)??a.colors.primary,nt=q.TEXT_PADDING*2,Z=Xn(G,K+q.TEXT_PADDING,e+i/2-L/2,Q-nt,L);f.push(`<path d="${Z}" fill="none" stroke="${tt}" stroke-width="1.5"/>`)}else if(W.type==="badge"){const G=t.metadata[W.field];if(G!=null){const L=String(G),tt=d*.85,nt=tt+8,Z=(F=(E=W.options)==null?void 0:E.badge)==null?void 0:F.variants,pt=(P=(M=W.options)==null?void 0:M.badge)==null?void 0:P.colors;let gt=a.colors.primary,lt=a.colors.primary;if(pt&&L in pt)gt=pt[L],lt=pt[L];else if(Z&&L in Z){const jt=Z[L];gt={default:a.colors.primary,...En,muted:a.colors.muted}[jt]??a.colors.primary,lt=gt}const mt=ot(L,tt)+12,It=W.align==="right"?K+Q-q.TEXT_PADDING-mt:W.align==="center"?K+(Q-mt)/2:K+q.TEXT_PADDING,Wt=e+(i-nt)/2;f.push(`<rect x="${It}" y="${Wt}" width="${mt}" height="${nt}"
          rx="${nt/2}" fill="${gt}" opacity="0.15"/>`),f.push(`<text x="${It+mt/2}" y="${Wt+nt/2+tt*.35}"
          text-anchor="middle"
          font-family="${a.typography.fontFamily}"
          font-size="${tt}px"
          font-weight="${a.typography.fontWeightBold}"
          fill="${lt}">${J(L)}</text>`)}}else if(W.type==="stars"){const G=t.metadata[W.field];if(typeof G=="number"){const L=((B=(R=W.options)==null?void 0:R.stars)==null?void 0:B.maxStars)??5,tt=((U=(Y=W.options)==null?void 0:Y.stars)==null?void 0:U.color)??"#f59e0b",nt=((rt=(X=W.options)==null?void 0:X.stars)==null?void 0:rt.emptyColor)??"#d1d5db",Z=Math.max(0,Math.min(L,G)),pt=Math.floor(Z),gt=((dt=(xt=W.options)==null?void 0:xt.stars)==null?void 0:dt.halfStars)&&Z-pt>=.5,lt=12,ut=2,mt=L*lt+(L-1)*ut;let It=W.align==="right"?K+Q-q.TEXT_PADDING-mt:W.align==="center"?K+(Q-mt)/2:K+q.TEXT_PADDING;const Wt=e+(i-lt)/2,jt=(bt,St,Ot)=>{const vt=Ot/2,Gt=vt*.4;let un="";for(let _t=0;_t<5;_t++){const fn=(_t*72-90)*Math.PI/180,dn=(_t*72+36-90)*Math.PI/180,hn=bt+vt*Math.cos(fn),pn=St+vt*Math.sin(fn),lo=bt+Gt*Math.cos(dn),co=St+Gt*Math.sin(dn);un+=(_t===0?`M${hn},${pn}`:`L${hn},${pn}`)+`L${lo},${co}`}return un+"Z"};for(let bt=0;bt<L;bt++){const St=It+lt/2,Ot=Wt+lt/2,Gt=bt<pt||bt===pt&&gt?tt:nt;f.push(`<path d="${jt(St,Ot,lt)}" fill="${Gt}"/>`),It+=lt+ut}}}else{const G=(at=t.cellStyles)==null?void 0:at[W.field],L=t.style;let tt=a.typography.fontWeightNormal;(G!=null&&G.bold||G!=null&&G.emphasis||L!=null&&L.bold||L!=null&&L.emphasis)&&(tt=a.typography.fontWeightBold);let nt="normal";(G!=null&&G.italic||L!=null&&L.italic)&&(nt="italic");let Z=a.colors.foreground;G!=null&&G.color?Z=G.color:G!=null&&G.muted?Z=a.colors.muted:G!=null&&G.accent?Z=a.colors.accent:L!=null&&L.color?Z=L.color:L!=null&&L.muted?Z=a.colors.muted:L!=null&&L.accent&&(Z=a.colors.accent),f.push(`<text x="${S}" y="${g}"
        font-family="${a.typography.fontFamily}"
        font-size="${d}px"
        font-weight="${tt}"
        font-style="${nt}"
        text-anchor="${O}"
        fill="${Z}">${J(ht)}</text>`)}}return f.join(`
`)}function eo(t,n,o,e,i,a){if(Array.isArray(o.axis.tickValues)&&o.axis.tickValues.length>0){const[y,m]=t.domain();let w=o.axis.tickValues.filter(k=>k>=y&&k<=m);const T=o.axis.nullTick!==!1,C=e>=y&&e<=m;return T&&C&&!w.includes(e)&&(w=[...w,e].sort((k,H)=>k-H)),w}const[s,h]=t.domain(),c=o.axis.nullTick!==!1,r=e>=s&&e<=h,l=Pt.MIN_TICK_SPACING,u=Math.max(2,Math.floor(i/l)),f=Math.min(n,Math.min(7,u)),d=a&&a.length>0?a.filter(y=>y>=s&&y<=h):t.ticks(f);if(d.length===0)return c&&r?[e]:[];const g=t(e),N=d.filter(y=>y<e).reverse(),I=d.filter(y=>y>e),A=d.some(y=>y===e),x=[];let _=g;for(const y of N){const m=t(y);_-m>=l&&(x.unshift(y),_=m)}const b=[];let D=g;for(const y of I){const m=t(y);m-D>=l&&(b.push(y),D=m)}const p=[...x];if((A||c&&r)&&p.push(e),p.push(...b),p.length<2){const y=new Set(p);y.has(s)||p.unshift(s),p.length<2&&!y.has(h)&&p.push(h)}return p}function Yt(t,n,o,e,i,a,s,h=1,c=.6){let l=`<line x1="${t}" x2="${t}" y1="${n}" y2="${o}"
    stroke="${i}" stroke-width="${h}" stroke-opacity="${c}" stroke-dasharray="${e==="dashed"?"6,4":e==="dotted"?"2,2":"none"}"/>`;if(s){const u=a.colors.secondary;l+=`<text x="${t}" y="${n-4}" text-anchor="middle"
      font-family="${a.typography.fontFamily}"
      font-size="${a.typography.fontSizeSm}"
      font-weight="${a.typography.fontWeightMedium}"
      fill="${u}">${J(s)}</text>`}return l}class Nt extends Error{constructor(n){super(`SVG Generator: ${n}`),this.name="SVGGeneratorError"}}function ro(t){if(!t||typeof t!="object")throw new Nt("Invalid spec: expected an object");const n=t;if(!n.data||typeof n.data!="object")throw new Nt("Invalid spec: missing or invalid 'data' property");const o=n.data;if(!Array.isArray(o.rows))throw new Nt("Invalid spec: 'data.rows' must be an array");if(!n.theme||typeof n.theme!="object")throw new Nt("Invalid spec: missing or invalid 'theme' property");const e=n.theme;if(!e.colors||typeof e.colors!="object")throw new Nt("Invalid spec: missing or invalid 'theme.colors'");if(!e.typography||typeof e.typography!="object")throw new Nt("Invalid spec: missing or invalid 'theme.typography'");if(!e.spacing||typeof e.spacing!="object")throw new Nt("Invalid spec: missing or invalid 'theme.spacing'")}function ao(t){var a;const o=Xt(t.columns,void 0).find(s=>s.type==="forest");if(!o||!((a=o.options)!=null&&a.forest))return{scale:"linear",nullValue:0,effects:[],axisLabel:"Effect",pointCol:null,lowerCol:null,upperCol:null};const e=o.options.forest,i=e.scale??"linear";return{scale:i,nullValue:e.nullValue??(i==="log"?1:0),effects:e.effects??[],axisLabel:e.axisLabel??"Effect",pointCol:e.point??null,lowerCol:e.lower??null,upperCol:e.upper??null}}function io(t,n={}){var T,C,k,H,z,V,j;ro(t);const o=t.theme,e=o.spacing.padding,i=Array.isArray(t.columns)?t.columns:[],a=Ut(i),s=[];for(let $=0;$<a.length;$++)a[$].type==="forest"&&s.push($);s.length>0;const h=[];for(let $=0;$<a.length;$++){const v=a[$];(v.type==="viz_bar"||v.type==="viz_boxplot"||v.type==="viz_violin")&&h.push({index:$,type:v.type,column:v})}const c=ao(t),r=Gn(t,n,c.nullValue),l=r.autoWidths,u=$=>{var E,F,M,P,R,B,Y,U;if($.type==="forest"){const X=l.get($.id);return X!==void 0?X:typeof $.width=="number"?$.width:((F=(E=$.options)==null?void 0:E.forest)==null?void 0:F.width)??r.forestWidth}if($.type==="viz_bar"){const X=l.get($.id);return X!==void 0?X:typeof $.width=="number"?$.width:((P=(M=$.options)==null?void 0:M.vizBar)==null?void 0:P.width)??r.forestWidth}if($.type==="viz_boxplot"){const X=l.get($.id);return X!==void 0?X:typeof $.width=="number"?$.width:((B=(R=$.options)==null?void 0:R.vizBoxplot)==null?void 0:B.width)??r.forestWidth}if($.type==="viz_violin"){const X=l.get($.id);return X!==void 0?X:typeof $.width=="number"?$.width:((U=(Y=$.options)==null?void 0:Y.vizViolin)==null?void 0:U.width)??r.forestWidth}const v=l.get($.id);return v!==void 0?v:typeof $.width=="number"?$.width:$t.DEFAULT_COLUMN_WIDTH},f=[];let d=e+r.labelWidth;for(const $ of a)f.push(d),d+=u($);const g=[];g.push(`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg"
  width="${r.totalWidth}" height="${r.totalHeight}"
  viewBox="0 0 ${r.totalWidth} ${r.totalHeight}">
<style>
  text { font-variant-numeric: tabular-nums; }
</style>`);const N=n.backgroundColor??o.colors.background;g.push(`<rect width="100%" height="100%" fill="${N}"/>`),g.push(Rn(t,r,o)),(!!((T=t.labels)!=null&&T.title)||!!((C=t.labels)!=null&&C.subtitle))&&g.push(`<line x1="${e}" x2="${r.totalWidth-e}"
      y1="${r.mainY}" y2="${r.mainY}"
      stroke="${o.colors.border}" stroke-width="2"/>`);const A=r.mainY;g.push(no(i,a,e,A,r.headerHeight,o,t.data.labelHeader??"Study",r.labelWidth,l,u)),g.push(`<line x1="${e}" x2="${r.totalWidth-e}"
    y1="${A+r.headerHeight}" y2="${A+r.headerHeight}"
    stroke="${o.colors.border}" stroke-width="2"/>`);const x=sn(t),_=[],b=[];let D=0;for(const $ of x){const E=$.type==="data"&&((k=$.row.style)==null?void 0:k.type)==="spacer"?r.rowHeight/2:r.rowHeight;_.push(D),b.push(E),D+=E}const p=r.mainY+r.headerHeight;o.layout.banding&&x.forEach(($,v)=>{var E,F;if($.type==="data"){const M=$.row,P=((E=M.style)==null?void 0:E.type)==="spacer",R=(F=M.style)==null?void 0:F.bg;if(!P&&!R){const B=p+_[v],Y=b[v],X=v%2===1?o.colors.altBg:o.colors.rowBg;X!==o.colors.background&&g.push(`<rect x="${e}" y="${B}"
              width="${r.totalWidth-e*2}" height="${Y}"
              fill="${X}"/>`)}}});for(const $ of s){const v=a[$],E=f[$],F=u(v),M=(H=v.options)==null?void 0:H.forest,P=(M==null?void 0:M.scale)??"linear",R=(M==null?void 0:M.nullValue)??(P==="log"?1:0),B=(M==null?void 0:M.axisLabel)??"Effect",Y=P==="log";let U=(M==null?void 0:M.effects)??[];const X=(M==null?void 0:M.point)??null,rt=(M==null?void 0:M.lower)??null,xt=(M==null?void 0:M.upper)??null;U.length===0&&(X||rt||xt)&&(U=[{pointCol:X,lowerCol:rt,upperCol:xt}]);const dt={scale:P,nullValue:R,effects:U,pointCol:(M==null?void 0:M.point)??null,lowerCol:(M==null?void 0:M.lower)??null,upperCol:(M==null?void 0:M.upper)??null},{scale:at,clipBounds:st,ticks:W}=Pn(t,F,dt,n),K=E+at(R);g.push(Yt(K,p,p+r.plotHeight,"dashed",o.colors.muted,o));const Q=(M==null?void 0:M.annotations)??[];for(const S of Q)if(S.type==="reference_line"){const O=E+at(S.x);g.push(Yt(O,p,p+r.plotHeight,S.style,S.color??o.colors.accent,o,S.label,S.width??1,S.opacity??.6))}const ht=Array.isArray(t.annotations)?t.annotations:[];for(const S of ht)if(S.type==="reference_line"){const O=E+at(S.x);g.push(Yt(O,p,p+r.plotHeight,S.style,S.color??o.colors.accent,o,S.label,S.width??1,S.opacity??.6))}if(x.forEach((S,O)=>{if(S.type==="data"){const G=p+_[O]+b[O]/2;g.push(qn(S.row,G,L=>E+at(L),o,R,U,t.data.weightCol,E,F,st,Y))}}),t.data.overall&&r.showOverallSummary&&typeof t.data.overall.point=="number"&&!Number.isNaN(t.data.overall.point)&&typeof t.data.overall.lower=="number"&&!Number.isNaN(t.data.overall.lower)&&typeof t.data.overall.upper=="number"&&!Number.isNaN(t.data.overall.upper)){const S=p+r.summaryYPosition;g.push(Yn(t.data.overall.point,t.data.overall.lower,t.data.overall.upper,S,at,E,F,o))}g.push(to(at,r,o,B,E,F,R,W))}const y=t.data.rows;for(const $ of h){const v=$.column,E=f[$.index],F=u(v);if($.type==="viz_bar"){const M=(z=v.options)==null?void 0:z.vizBar;if(!M)continue;const P=Zn(y,M,F);x.forEach((R,B)=>{if(R.type==="data"){const Y=p+_[B]+b[B]/2,U=b[B];g.push(jn(R.row,Y,U,E,F,M,P,o))}}),M.showAxis!==!1&&(g.push(`<g transform="translate(0, ${p+r.plotHeight})">`),g.push(qt(P,r,o,M.axisLabel,E,F,M.nullValue)),g.push("</g>"))}else if($.type==="viz_boxplot"){const M=(V=v.options)==null?void 0:V.vizBoxplot;if(!M)continue;const P=Jn(y,M,F);x.forEach((R,B)=>{if(R.type==="data"){const Y=p+_[B]+b[B]/2,U=b[B];g.push(On(R.row,Y,U,E,F,M,P,o))}}),M.showAxis!==!1&&(g.push(`<g transform="translate(0, ${p+r.plotHeight})">`),g.push(qt(P,r,o,M.axisLabel,E,F,M.nullValue)),g.push("</g>"))}else if($.type==="viz_violin"){const M=(j=v.options)==null?void 0:j.vizViolin;if(!M)continue;const P=Qn(y,M,F);x.forEach((R,B)=>{if(R.type==="data"){const Y=p+_[B]+b[B]/2,U=b[B];g.push(Kn(R.row,Y,U,E,F,M,P,o))}}),M.showAxis!==!1&&(g.push(`<g transform="translate(0, ${p+r.plotHeight})">`),g.push(qt(P,r,o,M.axisLabel,E,F,M.nullValue)),g.push("</g>"))}}const m=r.mainY+r.headerHeight,w=Vn(y,a);return x.forEach(($,v)=>{var M,P;const E=m+_[v],F=b[v];if($.type==="group_header")g.push(zn($.label,$.depth,e,E,F,r.totalWidth-e*2,o));else{const R=$.row,B=$.depth;g.push(oo(R,a,e,E,F,o,r.labelWidth,B,w,l,u,f))}if($.type==="data"){const R=$.row,B=((M=R.style)==null?void 0:M.type)==="summary",Y=((P=R.style)==null?void 0:P.type)==="spacer";B&&g.push(`<line x1="${e}" x2="${r.totalWidth-e}"
          y1="${E}" y2="${E}"
          stroke="${o.colors.border}" stroke-width="2"/>`),Y||g.push(`<line x1="${e}" x2="${r.totalWidth-e}"
          y1="${E+F}" y2="${E+F}"
          stroke="${o.colors.border}" stroke-width="1"/>`)}else g.push(`<line x1="${e}" x2="${r.totalWidth-e}"
        y1="${E+F}" y2="${E+F}"
        stroke="${o.colors.border}" stroke-width="1"/>`)}),g.push(Bn(t,r,o)),g.push("</svg>"),g.join(`
`)}function so(t,n){const o=JSON.parse(t);return io(o,n)}globalThis.generateSVG=so})();
