(function(){"use strict";const Kt=[1,5,2,2.5,4,3],ct=[.001,.002,.005,.01,.02,.05,.1,.15,.2,.25,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.75,2,2.5,3,4,5,6,7,8,10,12,15,20,25,30,40,50,75,100,150,200,300,500,750,1e3];function _t(t,n){return n?gn(t):mn(t)}function gn(t){if(t[0]<=0||t[1]<=0)return[.1,10];if(t[0]>=t[1])return t;let n=ct[0];for(const o of ct)if(o<=t[0])n=o;else break;t[0]<ct[0]&&(n=Math.pow(10,Math.floor(Math.log10(t[0]))));let e=ct[ct.length-1];for(let o=ct.length-1;o>=0&&ct[o]>=t[1];o--)e=ct[o];return t[1]>ct[ct.length-1]&&(e=Math.pow(10,Math.ceil(Math.log10(t[1])))),[n,e]}function mn(t){const n=t[1]-t[0];if(n===0)return t;if(n<0)return[t[1],t[0]];const e=Math.pow(10,Math.floor(Math.log10(n)));let o=e,s=1/0;for(const h of Kt)for(const c of[.1,1,10]){const r=h*e*c;if(r<=0)continue;const l=Math.floor(t[0]/r)*r,d=(Math.ceil(t[1]/r)*r-l)/n-1;d>=0&&d<s&&(s=d,o=r)}const a=Math.floor(t[0]/o)*o,i=Math.ceil(t[1]/o)*o;return[Math.round(a*1e10)/1e10,Math.round(i*1e10)/1e10]}function ut(t,n,e,o,s=!1){if(t&&e in t){const a=t[e];if(typeof a=="number"&&Number.isFinite(a)&&(!s||a>0))return a}return e===o&&n!=null&&Number.isFinite(n)&&(!s||n>0)?n:null}const gt=12;function yn(t){const{rows:n,config:e,scale:o,nullValue:s,forestWidth:a,pointSize:i,effects:h=[],pointCol:c,lowerCol:r,upperCol:l}=t,u=$n(n,e,o,s,h,c,r,l),f=xn(u,e,o,a,i),d=Zt(u,e,o,s);return{axisLimits:u,plotRegion:f,ticks:d}}function $n(t,n,e,o,s=[],a,i,h){const c=n.rangeMin!=null,r=n.rangeMax!=null;if(c&&r)return[n.rangeMin,n.rangeMax];const l=[],u=e==="log",f=a||"point";for(const E of t){const H=ut(E.metadata,void 0,f,"point",u);H!=null&&l.push(H);for(const b of s){const P=ut(E.metadata,void 0,b.pointCol,"point",u);P!=null&&l.push(P)}}if(l.length===0)return e==="log"?[.1,10]:[-1,1];let d=Math.min(...l),g=Math.max(...l);(n.includeNull??!0)&&(d=Math.min(d,o),g=Math.max(g,o));const I=d,A=g;let x;if(u){const E=Math.max(d,.001),H=Math.max(g,.001);x=Math.log(H)-Math.log(E)}else x=g-d;if(x===0||!Number.isFinite(x)){const E=l[0];if(u)return _t([E/2,E*2],!0);{const H=Math.max(1,Math.abs(E)*.1);return _t([E-H,E+H],!1)}}const[_,M]=_t([d,g],u),D=n.ciClipFactor??2;let p=_,y=M;const m=[],w=[],T=i||"lower",C=h||"upper";for(const E of t){const H=ut(E.metadata,void 0,T,"lower",u);H!=null&&m.push(H);const b=ut(E.metadata,void 0,C,"upper",u);b!=null&&w.push(b);for(const P of s){const R=ut(E.metadata,void 0,P.lowerCol,"lower",u);R!=null&&m.push(R);const B=ut(E.metadata,void 0,P.upperCol,"upper",u);B!=null&&w.push(B)}}let k,F;if(u)k=p/D,F=y*D;else{const E=y-p;k=p-E*D,F=y+E*D}let V=!1,z=!1;for(const E of m)E>=k?p=Math.min(p,E):V=!0;for(const E of w)E<=F?y=Math.max(y,E):z=!0;if(V&&(p=Math.min(p,k)),z&&(y=Math.max(y,F)),n.symmetric===!0&&!c&&!r)if(e==="log"){const E=Math.log(o),H=Math.max(Math.abs(Math.log(Math.max(I,.001))-E),Math.abs(Math.log(A)-E));p=Math.exp(E-H),y=Math.exp(E+H)}else{const E=Math.max(Math.abs(I-o),Math.abs(A-o));p=o-E,y=o+E}let $=c?n.rangeMin:p,v=r?n.rangeMax:y;return _t([$,v],e==="log")}function xn(t,n,e,o,s){if(!(n.markerMargin??!0)||o<=0)return t;const i=o-2*gt;if(i<=0)return t;if(e==="log"){const r=Math.log(Math.max(t[0],.001)),l=Math.log(Math.max(t[1],.001)),u=l-r,f=s/2*(u/i),d=Math.min(f,.5);return[Math.exp(r-d),Math.exp(l+d)]}const h=t[1]-t[0],c=s/2*(h/i);return[t[0]-c,t[1]+c]}function Zt(t,n,e,o){const[s,a]=t,i=o>=s&&o<=a,h=(n.nullTick??!0)&&i;if(n.tickValues&&n.tickValues.length>0){let l=n.tickValues.filter(u=>u>=s&&u<=a);return h&&!l.includes(o)&&(l=[...l,o].sort((u,f)=>u-f)),l}const c=n.tickCount??5;let r=e==="log"?bn(t,c):Mn(t,c);return h&&!r.includes(o)&&(r=[...r,o].sort((l,u)=>l-u)),r}function Mn(t,n){const[e,o]=t,s=o-e;if(s===0)return[e];const a=s/Math.max(n-1,1),i=Math.pow(10,Math.floor(Math.log10(a)));let h=i,c=1/0;for(const u of Kt){const f=u*i,d=Math.floor(s/f)+1,g=Math.abs(d-n);g<c&&(c=g,h=f);const N=u*i/10;if(N>0){const I=Math.floor(s/N)+1,A=Math.abs(I-n);A<c&&(c=A,h=N)}}const r=Math.ceil(e/h)*h,l=[];for(let u=r;u<=o+h*.001;u+=h){const f=Math.round(u*1e10)/1e10;f>=e&&f<=o&&l.push(f)}return l.length<2&&(l.includes(e)||l.unshift(e),l.includes(o)||l.push(o)),l}function bn(t,n){const[e,o]=t,a=[.01,.02,.05,.1,.15,.2,.25,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.75,2,2.5,3,4,5,6,7,8,10,12,15,20,25,30,40,50,75,100,150,200,500,1e3].filter(c=>c>=e&&c<=o);if(a.length<=n)return a;const i=[1,.1,10,100,.5,2,5,.2,.25,1.5,3,4,20,50],h=[];for(const c of i)a.includes(c)&&h.length<n&&h.push(c);if(h.length<n){const c=a.filter(l=>!h.includes(l)),r=Math.max(1,Math.floor(c.length/(n-h.length)));for(let l=0;l<c.length&&h.length<n;l+=r)h.push(c[l])}return h.sort((c,r)=>c-r)}function Nn(t){var o,s;const n=((o=t==null?void 0:t.shapes)==null?void 0:o.lineWidth)??1.5,e=((s=t==null?void 0:t.colors)==null?void 0:s.intervalLine)??"#475569";return{width:Math.max(4,Math.round(n*3)),height:Math.max(6,Math.round(n*4)),color:e,opacity:1}}function Jt(t,n,e,o){const{width:s,height:a}=o,i=a/2;return t==="left"?`M ${n} ${e} L ${n+s} ${e-i} L ${n+s} ${e+i} Z`:`M ${n} ${e} L ${n-s} ${e-i} L ${n-s} ${e+i} Z`}const Gt={RENDERING_BUFFER:4},xt={FONT_SCALE:.8,PADDING:4,GAP:6},mt={DEFAULT_COLUMN_WIDTH:100,AXIS_HEIGHT:32,AXIS_LABEL_HEIGHT:32,BOTTOM_MARGIN:16,MIN_FOREST_WIDTH:200,DEFAULT_WIDTH:800},st={TITLE_HEIGHT:28,SUBTITLE_HEIGHT:20,CAPTION_HEIGHT:16,FOOTNOTE_HEIGHT:14,DEFAULT_FONT_SIZE:14,REM_BASE:16,TEXT_BASELINE_ADJUSTMENT:1/3},q={INDENT_PER_LEVEL:12,TEXT_PADDING:10,DEFAULT_TICK_COUNT:5},Tn={OVERALL_ROW_HEIGHT_MULTIPLIER:1.5},Nt={MIN:60,MAX:600,LABEL_MAX:400,VISUAL_MIN:{sparkline:92,bar:100,stars:84,range:84,badge:74,forest:200,viz_bar:150,viz_boxplot:150,viz_violin:150}},Ct={CHEVRON_WIDTH:12,GAP:6,SAFETY_MARGIN:8},Qt={SPACING:6},Lt={EDGE_THRESHOLD:35,MIN_TICK_SPACING:50},En={success:"#16a34a",warning:"#d97706",error:"#dc2626",info:"#2563eb"};function wn(t,n){return n<=1?0:-((n-1)*Qt.SPACING)/2+t*Qt.SPACING}function Dt(t,n){const e=t.split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,n),e.join(".")}function Pt(t){const n=Math.abs(t),e=t<0?"-":"";if(n>=1e12)throw new Error(`Cannot abbreviate value >= 1 trillion: ${t}`);if(n>=1e9){const o=n/1e9;return e+Rt(o)+"B"}if(n>=1e6){const o=n/1e6;return e+Rt(o)+"M"}if(n>=1e3){const o=n/1e3;return e+Rt(o)+"K"}return e+Math.round(n).toString()}function Rt(t){const n=Math.round(t*10)/10;return n===Math.floor(n)?n.toFixed(0):n.toFixed(1)}const An={0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹","-":"⁻","+":"⁺"};function In(t){return t.split("").map(n=>An[n]??n).join("")}function Tt(t,n){var h,c,r,l,u;if(t==null||Number.isNaN(t))return(n==null?void 0:n.naText)??"";if(n!=null&&n.percent){const{decimals:f,digits:d,multiply:g=!0,symbol:N=!0}=n.percent,I=g?t*100:t,A=d!=null?I.toPrecision(d):I.toFixed(f??1);return N?`${A}%`:A}if(((h=n==null?void 0:n.numeric)==null?void 0:h.abbreviate)&&Math.abs(t)>=1e3)return Pt(t);const o=(c=n==null?void 0:n.numeric)==null?void 0:c.digits;if(o!=null){const f=t.toPrecision(o),d=(r=n==null?void 0:n.numeric)==null?void 0:r.thousandsSep;return d&&typeof d=="string"?Dt(f,d):f}const s=(l=n==null?void 0:n.numeric)==null?void 0:l.decimals,a=(u=n==null?void 0:n.numeric)==null?void 0:u.thousandsSep;let i;return s!==void 0?i=t.toFixed(s):Number.isInteger(t)||Math.abs(t-Math.round(t))<1e-4?i=Math.round(t).toString():i=t.toFixed(2),a&&typeof a=="string"&&(i=Dt(i,a)),i}function tn(t,n){const{eventsField:e,nField:o,separator:s="/",showPct:a=!1,thousandsSep:i,abbreviate:h}=n.events,c=t.metadata[e],r=t.metadata[o];if(c==null||r===void 0||r===null)return n.naText??"";const l=Number(c),u=Number(r);let f,d;h&&(l>=1e3||u>=1e3)?(f=l>=1e3?Pt(l):String(l),d=u>=1e3?Pt(u):String(u)):(f=String(l),d=String(u),i&&typeof i=="string"&&(f=Dt(f,i),d=Dt(d,i)));let g=`${f}${s}${d}`;if(a&&u>0){const N=(l/u*100).toFixed(1);g+=` (${N}%)`}return g}function nn(t,n,e,o){var h,c,r;if(t==null||Number.isNaN(t))return"";const s=((h=o==null?void 0:o.interval)==null?void 0:h.decimals)??2,a=((c=o==null?void 0:o.interval)==null?void 0:c.sep)??" ",i=(r=o==null?void 0:o.interval)==null?void 0:r.impreciseThreshold;return n==null||e===void 0||e===null||Number.isNaN(n)||Number.isNaN(e)?t.toFixed(s):i!=null&&n>0&&e/n>i?"—":`${t.toFixed(s)}${a}(${n.toFixed(s)}, ${e.toFixed(s)})`}function on(t,n){if(t==null||Number.isNaN(t))return(n==null?void 0:n.naText)??"";const e=n==null?void 0:n.pvalue,o=(e==null?void 0:e.digits)??2,s=(e==null?void 0:e.expThreshold)??.001,a=(e==null?void 0:e.abbrevThreshold)??null,i=(e==null?void 0:e.format)??"auto",h=(e==null?void 0:e.stars)??!1,c=(e==null?void 0:e.thresholds)??[.05,.01,.001];let r="";if(h&&(t<c[2]?r="***":t<c[1]?r="**":t<c[0]&&(r="*")),a!==null&&t<a)return`<${a}${r}`;if(i==="scientific"||i==="auto"&&t<s){const u=Math.floor(Math.log10(t));return`${(t/Math.pow(10,u)).toPrecision(o)}×10${In(u.toString())}${r}`}let l;return t>=.1?l=t.toFixed(o):t>=.01?l=t.toFixed(o+1):l=t.toFixed(o+2),`${l}${r}`}function _n(t,n){var a,i,h,c;const{type:e,field:o,options:s}=n;switch(e){case"interval":{const r=(a=s==null?void 0:s.interval)!=null&&a.point?t.metadata[s.interval.point]:t.point,l=(i=s==null?void 0:s.interval)!=null&&i.lower?t.metadata[s.interval.lower]:t.lower,u=(h=s==null?void 0:s.interval)!=null&&h.upper?t.metadata[s.interval.upper]:t.upper;return nn(r,l,u,s)}case"custom":return s!=null&&s.events?tn(t,s):String(t.metadata[o]??"");case"pvalue":return on(t.metadata[o],s);case"numeric":return Tt(t.metadata[o],s);case"percent":return Tt(t.metadata[o],s);case"sparkline":case"icon":case"stars":case"img":case"range":return"";case"badge":{const r=t.metadata[o];return r==null?"":`  ${String(r)}  `}case"bar":{if(((c=s==null?void 0:s.bar)==null?void 0:c.showLabel)===!1)return"";const r=t.metadata[o];return r==null?"":r>=100?r.toFixed(0):r>=10?r.toFixed(1):r.toFixed(2)}case"text":default:return String(t.metadata[o]??"")}}function ot(t,n){const e="⁰¹²³⁴⁵⁶⁷⁸⁹⁺⁻";let o=0;for(const s of t)e.includes(s)?o+=n*.3:"il1.,;:|!()[]{}' ".includes(s)?o+=n*.35:"×−".includes(s)?o+=n*.5:"mwMW@%".includes(s)?o+=n*.85:s>="0"&&s<="9"?o+=n*.6:o+=n*.55;return o}function Cn(t){if(!t||t.length===0)return{min:NaN,q1:NaN,median:NaN,q3:NaN,max:NaN};const n=t.filter(s=>s!=null&&!Number.isNaN(s)).sort((s,a)=>s-a);if(n.length===0)return{min:NaN,q1:NaN,median:NaN,q3:NaN,max:NaN};const e=n.length,o=s=>{if(e===1)return n[0];const a=(e-1)*s,i=Math.floor(a),h=Math.ceil(a);return i===h?n[i]:n[i]+(a-i)*(n[h]-n[i])};return{min:n[0],q1:o(.25),median:o(.5),q3:o(.75),max:n[e-1]}}function Dn(t,n,e){if(!t||t.length===0||Number.isNaN(n)||Number.isNaN(e))return[];const o=e-n,s=n-1.5*o,a=e+1.5*o;return t.filter(i=>i!=null&&!Number.isNaN(i)&&(i<s||i>a))}function en(t){const n=Cn(t),e=Dn(t,n.q1,n.q3);return{...n,outliers:e}}function kn(t){if(!t||t.length<2)return 1;const n=t.filter(d=>d!=null&&!Number.isNaN(d)).sort((d,g)=>d-g);if(n.length<2)return 1;const e=n.length,o=n.reduce((d,g)=>d+g,0)/e,s=n.reduce((d,g)=>d+(g-o)**2,0)/(e-1),a=Math.sqrt(s),i=Math.floor((e-1)*.25),h=Math.floor((e-1)*.75),c=n[i],l=n[h]-c,f=.9*Math.min(a,l/1.34)*Math.pow(e,-.2);return Math.max(f,.001)}function Hn(t){return Math.exp(-.5*t*t)/Math.sqrt(2*Math.PI)}function Fn(t,n,e=128){if(!t||t.length===0)return{x:[],y:[]};const o=t.filter(d=>d!=null&&!Number.isNaN(d));if(o.length===0)return{x:[],y:[]};const s=n??kn(o),a=Math.min(...o),i=Math.max(...o),h=3*s,c=a-h,l=(i+h-c)/(e-1),u=[],f=[];for(let d=0;d<e;d++){const g=c+d*l;u.push(g);let N=0;for(const I of o)N+=Hn((g-I)/s);N/=o.length*s,f.push(N)}return{x:u,y:f}}function Sn(t,n){if(t.y.length===0)return t;const e=Math.max(...t.y);if(e===0)return t;const o=t.y.map(s=>s/e*n);return{x:t.x,y:o}}function Wn(t,n){var r,l;const e=new Map,o=et(t.theme.typography.fontSizeBase),s=t.theme.typography.headerFontScale??1.05,a=Math.round(o*s*100)/100,i=t.data.rows,h=(t.theme.spacing.cellPaddingX??10)*2,c=(t.theme.spacing.groupPadding??8)*2;for(const u of n){if(u.width!=="auto"&&u.width!==null&&u.width!==void 0)continue;let f=0;u.header&&(f=Math.max(f,ot(u.header,a)));for(const N of i){if(((r=N.style)==null?void 0:r.type)==="header"||((l=N.style)==null?void 0:l.type)==="spacer")continue;const I=_n(N,u);I&&(f=Math.max(f,ot(I,o)))}const d=Nt.VISUAL_MIN[u.type]??Nt.MIN,g=Math.ceil(f+h+Gt.RENDERING_BUFFER);e.set(u.id,Math.min(Nt.MAX,Math.max(d,g)))}return vn(t.columns,e,a,c,Gt.RENDERING_BUFFER),e}function vn(t,n,e,o,s){function a(c){return c.isGroup?c.columns.flatMap(a):[c]}function i(c){const r=n.get(c.id);return r!==void 0?r:typeof c.width=="number"?c.width:Nt.MIN}function h(c){if(c.isGroup){for(const r of c.columns)h(r);if(c.header){const r=ot(c.header,e)+o+s,l=a(c),u=l.reduce((f,d)=>f+i(d),0);if(r>u&&l.length>0){const f=Math.ceil((r-u)/l.length);for(const d of l)n.set(d.id,i(d)+f)}}}}for(const c of t)h(c)}function rn(t,n,e){let o=e.filter(a=>a.groupId===t).length;const s=n.filter(a=>a.parentId===t);for(const a of s)o+=rn(a.id,n,e);return o}function an(t){var c,r;const n=et(t.theme.typography.fontSizeBase),e=(t.theme.spacing.cellPaddingX??10)*2;let o=0;const s=new Map,a=Array.isArray(t.data.groups)?t.data.groups:[];for(const l of a)s.set(l.id,l.depth);const i=l=>l?(s.get(l)??0)+1:0;t.data.labelHeader&&(o=Math.max(o,ot(t.data.labelHeader,n)));for(const l of t.data.rows)if(l.label){const u=i(l.groupId),f=((c=l.style)==null?void 0:c.indent)??0,g=(u+f)*q.INDENT_PER_LEVEL;let N=ot(l.label,n)+g;if((r=l.style)!=null&&r.badge){const I=String(l.style.badge),A=n*xt.FONT_SCALE,_=ot(I,A)+xt.PADDING*2;N+=xt.GAP+_}o=Math.max(o,N)}for(const l of a)if(l.label){const u=l.depth*q.INDENT_PER_LEVEL,f=ot(l.label,n),g=`(${rn(l.id,a,t.data.rows)})`,N=n*.75,I=ot(g,N),A=u+Ct.CHEVRON_WIDTH+Ct.GAP+f+Ct.GAP+I+Ct.SAFETY_MARGIN;o=Math.max(o,A)}const h=Math.ceil(o+e+Gt.RENDERING_BUFFER);return Math.min(Nt.LABEL_MAX,Math.max(Nt.MIN,h))}function Bt(t,n){const e=n.get(t.id);return e!==void 0?e:typeof t.width=="number"?t.width:mt.DEFAULT_COLUMN_WIDTH}function Gn(t,n,e=0){var it,S,K,Q,dt;const o=t.theme,s=o.spacing.rowHeight,a=o.spacing.padding,i=o.spacing.columnGap??8,h=Array.isArray(t.columns)?t.columns:[],c=ln(h,"left"),r=ln(h,"right"),l=kt(c)||kt(r)||kt(h),u=l?2:1,f=o.spacing.cellPaddingY??4,N=(o.spacing.headerHeight/u+(l?f*2:0))*u,I=!!((it=t.labels)!=null&&it.title),A=!!((S=t.labels)!=null&&S.subtitle),x=!!((K=t.labels)!=null&&K.caption),_=!!((Q=t.labels)!=null&&Q.footnote),M=I?st.TITLE_HEIGHT:0,D=A?st.SUBTITLE_HEIGHT:0,p=M+D+(I||A?a:0),y=x?st.CAPTION_HEIGHT:0,m=_?st.FOOTNOTE_HEIGHT:0,w=y+m+(x||_?a:0),T=sn(t),C=!!t.data.overall;let k=0;for(const W of T){const O=W.type==="data"&&((dt=W.row.style)==null?void 0:dt.type)==="spacer";k+=O?s/2:s}C&&(k+=s*Tn.OVERALL_ROW_HEIGHT_MULTIPLIER);const F=Ut(h,"left"),V=Ut(h,"right"),z=zt(h).filter(W=>W.position===void 0),j=[...F,...V,...z];let $,v;if(n.columnWidths){$=new Map;for(const[W,O]of Object.entries(n.columnWidths))W!=="__label__"&&$.set(W,O);v=n.columnWidths.__label__??an(t)}else $=Wn(t,j),v=an(t);const E=v+F.reduce((W,O)=>W+Bt(O,$),0),H=V.reduce((W,O)=>W+Bt(O,$),0),b=z.filter(W=>W.type!=="forest").reduce((W,O)=>W+Bt(O,$),0),P=n.width??mt.DEFAULT_WIDTH,B=j.some(W=>W.type==="forest")||t.data.includeForest,Y=E+H+b;let U;if(!B)U=0;else if(typeof n.forestWidth=="number")U=n.forestWidth;else if(typeof t.layout.plotWidth=="number")U=t.layout.plotWidth;else{const W=P-Y-i*2-a*2;U=Math.max(W,mt.MIN_FOREST_WIDTH)}const X=a*2+Y+U+i*2,rt=Math.max(n.width??P,X);B&&rt>X&&typeof n.forestWidth!="number"&&typeof t.layout.plotWidth!="number"&&(U=rt-Y-a*2-i*2);const ft=(o.spacing.axisGap??12)+mt.AXIS_HEIGHT+mt.AXIS_LABEL_HEIGHT,at=p+a+N+k+ft+w+mt.BOTTOM_MARGIN;return{totalWidth:rt,totalHeight:n.height??at,tableWidth:E+H,forestWidth:U,headerHeight:N,rowHeight:s,plotHeight:k,axisHeight:mt.AXIS_HEIGHT,nullValue:e,summaryYPosition:k-s,showOverallSummary:C,headerTextHeight:p,footerTextHeight:w,titleY:a+st.TITLE_HEIGHT-8,subtitleY:a+M+st.SUBTITLE_HEIGHT-4,mainY:p+a,footerY:p+a+N+k+ft+8,autoWidths:$,labelWidth:v}}function sn(t){var u;const n=t.data.rows,e=Array.isArray(t.data.groups)?t.data.groups:[];if(e.length===0)return n.map(f=>({type:"data",row:f,depth:0}));const o=new Map;for(const f of e)o.set(f.id,f);const s=new Map;for(const f of n){const d=f.groupId??null;s.has(d)||s.set(d,[]),s.get(d).push(f)}const a=new Set;for(const f of s.keys()){if(!f)continue;let d=f;for(;d;)a.add(d),d=(u=o.get(d))==null?void 0:u.parentId}function i(f){return e.filter(d=>(d.parentId??null)===f&&a.has(d.id))}function h(f){if(!f)return 0;const d=o.get(f);return d?d.depth+1:0}function c(f){var g;let d=((g=s.get(f))==null?void 0:g.length)??0;for(const N of i(f))d+=c(N.id);return d}const r=[];function l(f){if(f){const g=o.get(f);if(!g)return;const N=c(f);r.push({type:"group_header",groupId:g.id,label:g.label,depth:g.depth,rowCount:N})}for(const g of i(f))l(g.id);const d=s.get(f)??[];for(const g of d)r.push({type:"data",row:g,depth:h(g.groupId)})}return l(null),r}function Vt(t){const n=[];for(const e of t)e.isGroup?n.push(...Vt(e.columns)):n.push(e);return n}function zt(t){const n=[];for(const e of t)e.isGroup?n.push(...Vt(e.columns)):n.push(e);return n}function Ut(t,n){if(n===void 0)return zt(t);const e=[];for(const o of t)o.position===n&&(o.isGroup?e.push(...Vt(o.columns)):e.push(o));return e}function ln(t,n){return t.filter(e=>e.position===n)}function kt(t){return t.some(n=>n.isGroup)}function et(t){let n;return t.endsWith("rem")?n=parseFloat(t)*st.REM_BASE:t.endsWith("px")?n=parseFloat(t):n=st.DEFAULT_FONT_SIZE,Math.round(n*100)/100}function Ht(t,n,e){return e==="right"?{textX:t+n-q.TEXT_PADDING,anchor:"end"}:e==="center"?{textX:t+n/2,anchor:"middle"}:{textX:t+q.TEXT_PADDING,anchor:"start"}}function J(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function cn(t,n,e,o=0){const s=n-o*2;if(ot(t,e)<=s)return t;const i="…",h=e*.55;let c=0,r=t.length;for(;c<r;){const l=Math.ceil((c+r)/2),u=t.slice(0,l);ot(u,e)+h<=s?c=l:r=l-1}return c===0?i:t.slice(0,c)+i}function Ln(t){return Math.abs(t)<.01?"0":Math.abs(t)>=100?t.toFixed(0):Math.abs(t)>=10?t.toFixed(1):t.toFixed(2)}function Et(t,n){const[e,o]=t,[s,a]=n,i=(a-s)/(o-e),h=c=>s+(c-e)*i;return h.domain=()=>t,h.range=()=>n,h.ticks=c=>{const r=(o-e)/(c-1),l=[];for(let u=0;u<c;u++)l.push(e+r*u);return l},h}function wt(t,n){const[e,o]=t.map(l=>Math.max(l,.001)),[s,a]=n,i=Math.log10(e),h=Math.log10(o),c=(a-s)/(h-i),r=l=>{const u=Math.log10(Math.max(l,.001));return s+(u-i)*c};return r.domain=()=>[e,o],r.range=()=>n,r.ticks=l=>{const u=[],f=Math.floor(Math.log10(e)),d=Math.ceil(Math.log10(o));for(let g=f;g<=d;g++){const N=Math.pow(10,g);for(const I of[1,2,5]){const A=N*I;A>=e&&A<=o&&u.push(A)}}return u.length>0?u:[e,o]},r}function Pn(t,n,e,o){const s=e.scale==="log",a=gt,i=Math.max(n-gt,a+50);if(o!=null&&o.xDomain){const u=o.xDomain,f=o.clipBounds??u,d=Zt(f,t.theme.axis,e.scale,e.nullValue);return s?{scale:wt([Math.max(u[0],.01),Math.max(u[1],.02)],[a,i]),clipBounds:f,ticks:d}:{scale:Et(u,[a,i]),clipBounds:f,ticks:d}}const h=yn({rows:t.data.rows,config:t.theme.axis,scale:e.scale,nullValue:e.nullValue,forestWidth:n,pointSize:t.theme.shapes.pointSize,effects:e.effects,pointCol:e.pointCol,lowerCol:e.lowerCol,upperCol:e.upperCol}),{plotRegion:c,axisLimits:r,ticks:l}=h;return s?{scale:wt([Math.max(c[0],.01),Math.max(c[1],.02)],[a,i]),clipBounds:r,ticks:l}:{scale:Et(c,[a,i]),clipBounds:r,ticks:l}}function Rn(t,n,e){var a,i;const o=[],s=e.spacing.padding;if((a=t.labels)!=null&&a.title){const h=et(e.typography.fontSizeLg);o.push(`<text x="${s}" y="${n.titleY}"
      font-family="${e.typography.fontFamily}"
      font-size="${h}px"
      font-weight="${e.typography.fontWeightBold}"
      fill="${e.colors.foreground}">${J(t.labels.title)}</text>`)}if((i=t.labels)!=null&&i.subtitle){const h=et(e.typography.fontSizeBase);o.push(`<text x="${s}" y="${n.subtitleY}"
      font-family="${e.typography.fontFamily}"
      font-size="${h}px"
      fill="${e.colors.secondary}">${J(t.labels.subtitle)}</text>`)}return o.join(`
`)}function Bn(t,n,e){var h,c,r,l;const o=[],s=e.spacing.padding;let a=n.footerY;if(!!((h=t.labels)!=null&&h.caption)||!!((c=t.labels)!=null&&c.footnote)){const u=n.footerY-8;o.push(`<line x1="${s}" x2="${n.totalWidth-s}"
      y1="${u}" y2="${u}"
      stroke="${e.colors.border}" stroke-width="1"/>`)}if((r=t.labels)!=null&&r.caption){const u=et(e.typography.fontSizeSm);o.push(`<text x="${s}" y="${a}"
      font-family="${e.typography.fontFamily}"
      font-size="${u}px"
      fill="${e.colors.secondary}">${J(t.labels.caption)}</text>`),a+=st.CAPTION_HEIGHT}if((l=t.labels)!=null&&l.footnote){const u=et(e.typography.fontSizeSm);o.push(`<text x="${s}" y="${a}"
      font-family="${e.typography.fontFamily}"
      font-size="${u}px"
      font-style="italic"
      fill="${e.colors.muted}">${J(t.labels.footnote)}</text>`)}return o.join(`
`)}function Vn(t,n,e,o,s,a,i){const h=[],c=n+1,r=i.groupHeaders;let l,u,f,d,g;if(c===1?(l=et((r==null?void 0:r.level1FontSize)??i.typography.fontSizeBase),u=(r==null?void 0:r.level1FontWeight)??i.typography.fontWeightBold,f=(r==null?void 0:r.level1Italic)??!1,d=(r==null?void 0:r.level1Background)??null,g=(r==null?void 0:r.level1BorderBottom)??!1):c===2?(l=et((r==null?void 0:r.level2FontSize)??i.typography.fontSizeBase),u=(r==null?void 0:r.level2FontWeight)??i.typography.fontWeightMedium,f=(r==null?void 0:r.level2Italic)??!0,d=(r==null?void 0:r.level2Background)??null,g=(r==null?void 0:r.level2BorderBottom)??!1):(l=et((r==null?void 0:r.level3FontSize)??i.typography.fontSizeBase),u=(r==null?void 0:r.level3FontWeight)??i.typography.fontWeightNormal,f=(r==null?void 0:r.level3Italic)??!1,d=(r==null?void 0:r.level3Background)??null,g=(r==null?void 0:r.level3BorderBottom)??!1),!d){const x=i.colors.primary,_=c===1?.15:c===2?.1:.06,M=x.replace("#",""),D=parseInt(M.substring(0,2),16),p=parseInt(M.substring(2,4),16),y=parseInt(M.substring(4,6),16);d=`rgba(${D}, ${p}, ${y}, ${_})`}const N=o+s/2+l*st.TEXT_BASELINE_ADJUSTMENT,I=n*((r==null?void 0:r.indentPerLevel)??q.INDENT_PER_LEVEL);h.push(`<rect x="${e}" y="${o}"
    width="${a}" height="${s}"
    fill="${d}"/>`),g&&h.push(`<line x1="${e}" x2="${e+a}" y1="${o+s}" y2="${o+s}"
      stroke="${i.colors.border}" stroke-width="1" opacity="0.5"/>`);const A=f?' font-style="italic"':"";return h.push(`<text x="${e+q.TEXT_PADDING+I}" y="${N}"
    font-family="${i.typography.fontFamily}"
    font-size="${l}px"
    font-weight="${u}"${A}
    fill="${i.colors.foreground}">${J(t)}</text>`),h.join(`
`)}function zn(t,n){const e=new Map;for(const o of n)if(o.type==="bar"){let s=0;for(const a of t){const i=a.metadata[o.field];typeof i=="number"&&i>s&&(s=i)}e.set(o.field,s>0?s:1)}return e}function Un(t,n){var o,s,a,i,h,c,r,l,u,f,d,g,N,I,A,x,_,M,D;if(n.type==="interval"){const p=(s=(o=n.options)==null?void 0:o.interval)!=null&&s.point?t.metadata[n.options.interval.point]:t.point,y=(i=(a=n.options)==null?void 0:a.interval)!=null&&i.lower?t.metadata[n.options.interval.lower]:t.lower,m=(c=(h=n.options)==null?void 0:h.interval)!=null&&c.upper?t.metadata[n.options.interval.upper]:t.upper;return nn(p,y,m,n.options)}if(n.type==="numeric"){const p=t.metadata[n.field];return typeof p=="number"?Tt(p,n.options):((r=n.options)==null?void 0:r.naText)??""}if(n.type==="custom"&&((l=n.options)!=null&&l.events))return tn(t,n.options);if(n.type==="pvalue"){const p=t.metadata[n.field];return typeof p!="number"?((u=n.options)==null?void 0:u.naText)??"":on(p,n.options)}if(n.type==="icon"){const p=t.metadata[n.field];if(p==null)return"";const y=String(p),m=(d=(f=n.options)==null?void 0:f.icon)==null?void 0:d.mapping;return m&&y in m?m[y]:y}if(n.type==="badge"){const p=t.metadata[n.field];return p!=null?String(p):""}if(n.type==="stars"){const p=t.metadata[n.field];if(typeof p!="number")return"";const y=((N=(g=n.options)==null?void 0:g.stars)==null?void 0:N.maxStars)??5,m=Math.max(0,Math.min(y,p)),w=Math.floor(m),T=y-w;return"★".repeat(w)+"☆".repeat(T)}if(n.type==="img")return((A=(I=n.options)==null?void 0:I.img)==null?void 0:A.fallback)??"[IMG]";if(n.type==="reference"){const p=t.metadata[n.field];if(p==null)return"";const y=String(p),m=((_=(x=n.options)==null?void 0:x.reference)==null?void 0:_.maxChars)??30;return y.length<=m?y:y.substring(0,m)+"..."}if(n.type==="range"){const p=(M=n.options)==null?void 0:M.range;if(!p)return"";const y=t.metadata[p.minField],m=t.metadata[p.maxField],w=p.separator??" – ",T=p.decimals,C=k=>typeof k!="number"?"":T==null?Number.isInteger(k)?String(k):k.toFixed(1):k.toFixed(T);return y===null&&m===null?"":y===null?C(m):m===null?C(y):`${C(y)}${w}${C(m)}`}const e=t.metadata[n.field];return e!=null?String(e):((D=n.options)==null?void 0:D.naText)??""}function Xn(t,n,e,o,s){const a=t.filter(l=>Number.isFinite(l));if(a.length===0)return"";if(a.length===1){const l=n+o/2,u=e+s/2;return`M${l.toFixed(1)},${u.toFixed(1)}`}const i=Math.min(...a),c=Math.max(...a)-i||1;return`M${a.map((l,u)=>{const f=n+u/(a.length-1)*o,d=e+s-(l-i)/c*s;return`${f.toFixed(1)},${d.toFixed(1)}`}).join("L")}`}function qn(t,n,e,o,s,a=[],i,h=0,c=1/0,r,l=!1){var y;let u;if(a.length===0){const m=!l||t.point!=null&&t.point>0?t.point:null,w=!l||t.lower!=null&&t.lower>0?t.lower:null,T=!l||t.upper!=null&&t.upper>0?t.upper:null;u=[{point:m,lower:w,upper:T,color:null,shape:null,opacity:null}]}else u=a.map(m=>({point:ut(t.metadata,t.point,m.pointCol,"point",l),lower:ut(t.metadata,t.lower,m.lowerCol,"lower",l),upper:ut(t.metadata,t.upper,m.upperCol,"upper",l),color:m.color??null,shape:m.shape??null,opacity:m.opacity??null}));const f=u.filter(m=>m.point!=null&&!Number.isNaN(m.point)&&m.lower!=null&&!Number.isNaN(m.lower)&&m.upper!=null&&!Number.isNaN(m.upper));if(f.length===0)return"";const d=o.shapes.pointSize,g=o.shapes.lineWidth,N=o.colors.intervalLine,I=((y=t.style)==null?void 0:y.type)==="summary",x=o.shapes.summaryHeight/2;function _(m){var T;if(m&&((T=t.markerStyle)==null?void 0:T.size)!=null)return d*t.markerStyle.size;const w=i?t.metadata[i]:void 0;if(w){const C=.5+Math.sqrt(w/100)*1.5;return Math.min(Math.max(d*C,3),d*2.5)}return d}function M(m,w){const T=w===0,C=t.markerStyle,k=o.shapes.effectColors,F=o.shapes.markerShapes,V=["square","circle","diamond","triangle"];let z;T&&(C!=null&&C.color)?z=C.color:m.color?z=m.color:k&&k.length>0?z=k[w%k.length]:z=o.colors.interval??o.colors.primary??"#2563eb";let j;T&&(C!=null&&C.shape)?j=C.shape:m.shape?j=m.shape:F&&F.length>0?j=F[w%F.length]:j=V[w%V.length];let $;return T&&(C==null?void 0:C.opacity)!=null?$=C.opacity:m.opacity!=null?$=m.opacity:$=1,{color:z,shape:j,opacity:$}}function D(m,w,T,C){const{color:k,shape:F,opacity:V}=C,z=V<1?` fill-opacity="${V}"`:"";switch(F){case"circle":return`<circle cx="${m}" cy="${w}" r="${T}" fill="${k}"${z}/>`;case"diamond":return`<polygon points="${[`${m},${w-T}`,`${m+T},${w}`,`${m},${w+T}`,`${m-T},${w}`].join(" ")}" fill="${k}"${z}/>`;case"triangle":return`<polygon points="${[`${m},${w-T}`,`${m+T},${w+T}`,`${m-T},${w+T}`].join(" ")}" fill="${k}"${z}/>`;default:return`<rect x="${m-T}" y="${w-T}" width="${T*2}" height="${T*2}" fill="${k}"${z}/>`}}const p=[];return f.forEach((m,w)=>{const T=n+wn(w,f.length),C=e(m.lower),k=e(m.upper),F=e(m.point),V=M(m,w),z=_(w===0),j=N;if(I){const $=V.opacity<1?` fill-opacity="${V.opacity}"`:"",v=[`${C},${T}`,`${F},${T-x}`,`${k},${T}`,`${F},${T+x}`].join(" ");p.push(`
        <g class="interval effect-${w} summary">
          <polygon points="${v}"
            fill="${V.color}"${$} stroke="${o.colors.summaryBorder}" stroke-width="1"/>
        </g>`)}else{const $=h+gt,v=h+c-gt,E=r?m.lower<r[0]:C<$,H=r?m.upper>r[1]:k>v;let b,P;if(r){const ft=Math.max(r[0],Math.min(r[1],m.lower)),at=Math.max(r[0],Math.min(r[1],m.upper));b=e(ft),P=e(at)}else b=Math.max($,Math.min(v,C)),P=Math.max($,Math.min(v,k));const R=Nn(o),B=R.height/2,Y=r?e(r[0]):$,U=r?e(r[1]):v;let X="";E?X=`<path d="${Jt("left",Y,T,R)}" fill="${R.color}"/>`:X=`<line x1="${b}" x2="${b}" y1="${T-B}" y2="${T+B}" stroke="${j}" stroke-width="${g}"/>`;let rt="";H?rt=`<path d="${Jt("right",U,T,R)}" fill="${R.color}"/>`:rt=`<line x1="${P}" x2="${P}" y1="${T-B}" y2="${T+B}" stroke="${j}" stroke-width="${g}"/>`;const yt=r?e(Math.max(r[0],Math.min(r[1],m.point))):Math.max($,Math.min(v,F));p.push(`
        <g class="interval effect-${w}">
          <line x1="${b}" x2="${P}" y1="${T}" y2="${T}"
            stroke="${j}" stroke-width="${g}"/>
          ${X}
          ${rt}
          ${D(yt,T,z,V)}
        </g>`)}}),p.join("")}function Yn(t,n,e,o,s,a,i,h){const r=h.shapes.summaryHeight/2,[l,u]=s.domain().map(D=>s(D)),f=Math.min(l,u),d=Math.max(l,u),g=s(n),N=s(t),I=s(e),A=a+Math.max(f,Math.min(d,g)),x=a+Math.max(f,Math.min(d,N)),_=a+Math.max(f,Math.min(d,I));return`<polygon points="${[`${A},${o}`,`${x},${o-r}`,`${_},${o}`,`${x},${o+r}`].join(" ")}"
    fill="${h.colors.summaryFill}"
    stroke="${h.colors.summaryBorder}"
    stroke-width="1"/>`}function jn(t,n,e,o,s,a,i,h){const c=[],r=a.effects,l=r.length;if(!r.some(A=>{const x=t.metadata[A.value];return x!=null&&!Number.isNaN(x)}))return"";const f=e*.7,d=l>1?2:0,g=(f-d*(l-1))/l,N=Math.max(4,g),I=h.shapes.effectColors??["#3b82f6","#22c55e","#f59e0b","#ef4444","#8b5cf6"];return r.forEach((A,x)=>{const _=t.metadata[A.value];if(_==null||Number.isNaN(_))return;const M=n-f/2+x*(N+d),D=o+i(Math.min(0,_)),p=Math.abs(i(_)-i(0)),y=A.color??I[x%I.length],m=A.opacity??.85;c.push(`<rect
      x="${D}" y="${M}"
      width="${Math.max(1,p)}" height="${N}"
      fill="${y}" fill-opacity="${m}" rx="2"
      class="viz-bar-segment"/>`)}),c.join(`
`)}function On(t,n,e,o,s,a,i,h){const c=[],r=a.effects,l=r.length,u=r.map(x=>{if(x.data){const _=t.metadata[x.data];return!_||!Array.isArray(_)||_.length===0?null:en(_)}if(x.min&&x.q1&&x.median&&x.q3&&x.max){const _=t.metadata[x.min],M=t.metadata[x.q1],D=t.metadata[x.median],p=t.metadata[x.q3],y=t.metadata[x.max];if([_,M,D,p,y].some(w=>w==null||Number.isNaN(w)))return null;let m=[];if(x.outliers){const w=t.metadata[x.outliers];w&&Array.isArray(w)&&(m=w)}return{min:_,q1:M,median:D,q3:p,max:y,outliers:m}}return null});if(!u.some(x=>x!==null))return"";const d=e*.7,g=l>1?2:0,N=Math.max(8,(d-(l-1)*g)/l),I=h.shapes.effectColors??["#3b82f6","#22c55e","#f59e0b","#ef4444","#8b5cf6"],A=h.colors.foreground??"#1a1a1a";return r.forEach((x,_)=>{const M=u[_];if(!M)return;const D=n-d/2+_*(N+g),p=D+N/2,y=x.color??I[_%I.length],m=x.fillOpacity??.7;c.push(`<line
      x1="${o+i(M.min)}" x2="${o+i(M.q1)}"
      y1="${p}" y2="${p}"
      stroke="${A}" stroke-width="1"/>`),c.push(`<line
      x1="${o+i(M.min)}" x2="${o+i(M.min)}"
      y1="${p-N/4}" y2="${p+N/4}"
      stroke="${A}" stroke-width="1"/>`),c.push(`<line
      x1="${o+i(M.q3)}" x2="${o+i(M.max)}"
      y1="${p}" y2="${p}"
      stroke="${A}" stroke-width="1"/>`),c.push(`<line
      x1="${o+i(M.max)}" x2="${o+i(M.max)}"
      y1="${p-N/4}" y2="${p+N/4}"
      stroke="${A}" stroke-width="1"/>`);const w=Math.max(2,i(M.q3)-i(M.q1));if(c.push(`<rect
      x="${o+i(M.q1)}" y="${D}"
      width="${w}" height="${N}"
      fill="${y}" fill-opacity="${m}"
      stroke="${A}" stroke-width="1"/>`),c.push(`<line
      x1="${o+i(M.median)}" x2="${o+i(M.median)}"
      y1="${D}" y2="${D+N}"
      stroke="${A}" stroke-width="2"/>`),a.showOutliers!==!1&&M.outliers.length>0)for(const T of M.outliers)c.push(`<circle
          cx="${o+i(T)}" cy="${p}"
          r="2.5"
          fill="none" stroke="${y}" stroke-width="1.5"/>`)}),c.join(`
`)}function Kn(t,n,e,o,s,a,i,h){const c=[],r=a.effects,l=r.length,u=r.map(M=>{const D=t.metadata[M.data];return!D||!Array.isArray(D)||D.length<2?null:Fn(D,a.bandwidth)}),f=r.map(M=>{const D=t.metadata[M.data];if(!D||!Array.isArray(D)||D.length<2)return null;const p=D.filter(w=>w!=null&&!Number.isNaN(w)).sort((w,T)=>w-T);if(p.length===0)return null;const y=p.length,m=w=>{if(y===1)return p[0];const T=(y-1)*w,C=Math.floor(T),k=Math.ceil(T);return C===k?p[C]:p[C]+(T-C)*(p[k]-p[C])};return{q1:m(.25),median:m(.5),q3:m(.75)}});if(!u.some(M=>M!==null))return"";const g=e*.8,N=l>1?2:0,I=Math.max(10,(g-(l-1)*N)/l),A=I/2,x=h.shapes.effectColors??["#3b82f6","#22c55e","#f59e0b","#ef4444","#8b5cf6"],_=h.colors.foreground??"#1a1a1a";return r.forEach((M,D)=>{const p=u[D],y=f[D];if(!p||p.x.length<2)return;const m=n-g/2+I/2+D*(I+N),w=M.color??x[D%x.length],T=M.fillOpacity??.5,C=Sn(p,A),k=[];for(let F=0;F<C.x.length;F++){const V=o+i(C.x[F]),z=m-C.y[F];k.push(F===0?`M ${V} ${z}`:`L ${V} ${z}`)}for(let F=C.x.length-1;F>=0;F--){const V=o+i(C.x[F]),z=m+C.y[F];k.push(`L ${V} ${z}`)}if(k.push("Z"),c.push(`<path
      d="${k.join(" ")}"
      fill="${w}" fill-opacity="${T}"
      stroke="${_}" stroke-width="0.5"/>`),a.showMedian!==!1&&y){const F=o+i(y.median);c.push(`<line
        x1="${F}" x2="${F}"
        y1="${m-A*.6}" y2="${m+A*.6}"
        stroke="${_}" stroke-width="2"/>`)}if(a.showQuartiles&&y){const F=o+i(y.q1),V=o+i(y.q3);c.push(`<line
        x1="${F}" x2="${F}"
        y1="${m-A*.4}" y2="${m+A*.4}"
        stroke="${_}" stroke-width="1" stroke-dasharray="2,2"/>`),c.push(`<line
        x1="${V}" x2="${V}"
        y1="${m-A*.4}" y2="${m+A*.4}"
        stroke="${_}" stroke-width="1" stroke-dasharray="2,2"/>`)}}),c.join(`
`)}function Zn(t,n,e){var h,c;const o=n.scale==="log",s=gt;let a=(h=n.axisRange)==null?void 0:h[0],i=(c=n.axisRange)==null?void 0:c[1];if(a==null||i==null){const r=[];for(const l of t)for(const u of n.effects){const f=l.metadata[u.value];f!=null&&!Number.isNaN(f)&&r.push(f)}r.length>0?(a=a??Math.min(0,...r),i=i??Math.max(...r)*1.1):(a=a??0,i=i??100)}return o?wt([Math.max(.01,a),i],[s,e-s]):Et([a,i],[s,e-s])}function Jn(t,n,e){var h,c;const o=n.scale==="log",s=gt;let a=(h=n.axisRange)==null?void 0:h[0],i=(c=n.axisRange)==null?void 0:c[1];if(a==null||i==null){const r=[];for(const l of t)for(const u of n.effects)if(u.data){const f=l.metadata[u.data];if(f&&Array.isArray(f)){const d=en(f);r.push(d.min,d.max),n.showOutliers!==!1&&r.push(...d.outliers)}}else if(u.min&&u.max){const f=l.metadata[u.min],d=l.metadata[u.max];f!=null&&!Number.isNaN(f)&&r.push(f),d!=null&&!Number.isNaN(d)&&r.push(d)}if(r.length>0){const l=Math.min(...r),u=Math.max(...r),f=u-l;a=a??l-f*.05,i=i??u+f*.05}else a=a??0,i=i??100}return o?wt([Math.max(.01,a),i],[s,e-s]):Et([a,i],[s,e-s])}function Qn(t,n,e){var h,c;const o=n.scale==="log",s=gt;let a=(h=n.axisRange)==null?void 0:h[0],i=(c=n.axisRange)==null?void 0:c[1];if(a==null||i==null){const r=[];for(const l of t)for(const u of n.effects){const f=l.metadata[u.data];f&&Array.isArray(f)&&r.push(...f.filter(d=>d!=null&&!Number.isNaN(d)))}if(r.length>0){a=a??Math.min(...r),i=i??Math.max(...r);const l=(i??0)-(a??0);a=(a??0)-l*.1,i=(i??0)+l*.1}else a=a??0,i=i??100}return o?wt([Math.max(.01,a),i],[s,e-s]):Et([a,i],[s,e-s])}function Xt(t,n,e,o,s,a,i){const h=[],c=et(e.typography.fontSizeSm),r=Lt.EDGE_THRESHOLD,l=I=>I<r?"start":I>a-r?"end":"middle",u=I=>I<r?2:I>a-r?-2:0;h.push(`<line x1="${s}" x2="${s+a}"
    y1="0" y2="0" stroke="${e.colors.border}" stroke-width="1"/>`);const f=t.domain(),d=5,g=[],N=f[1]-f[0];for(let I=0;I<=d;I++)g.push(f[0]+N*I/d);for(const I of g){const A=t(I),x=s+A,_=l(A),M=u(A),D=Tt(I);h.push(`<line x1="${x}" x2="${x}" y1="0" y2="4" stroke="${e.colors.border}" stroke-width="1"/>`),h.push(`<text x="${x+M}" y="14"
      text-anchor="${_}"
      font-family="${e.typography.fontFamily}"
      font-size="${c}px"
      fill="${e.colors.foreground}">${D}</text>`)}return o&&h.push(`<text x="${s+a/2}" y="28"
      text-anchor="middle"
      font-family="${e.typography.fontFamily}"
      font-size="${c}px"
      font-weight="${e.typography.fontWeightMedium}"
      fill="${e.colors.foreground}">${J(o)}</text>`),h.join(`
`)}function to(t,n,e,o,s,a,i=1,h){const c=[],r=typeof e.axis.tickCount=="number"?e.axis.tickCount:q.DEFAULT_TICK_COUNT,l=eo(t,r,e,i,a,h),u=et(e.typography.fontSizeSm),f=Lt.EDGE_THRESHOLD,d=N=>N<f?"start":N>a-f?"end":"middle",g=N=>N<f?2:N>a-f?-2:0;c.push(`<line x1="${s}" x2="${s+a}"
    y1="0" y2="0" stroke="${e.colors.border}" stroke-width="1"/>`);for(const N of l){const I=t(N),A=s+I,x=d(I),_=g(I);c.push(`<line x1="${A}" x2="${A}" y1="0" y2="4"
      stroke="${e.colors.border}" stroke-width="1"/>`),c.push(`<text x="${A+_}" y="16" text-anchor="${x}"
      font-family="${e.typography.fontFamily}"
      font-size="${u}px"
      fill="${e.colors.secondary}">${Ln(N)}</text>`)}return o&&c.push(`<text x="${s+a/2}" y="28"
      text-anchor="middle"
      font-family="${e.typography.fontFamily}"
      font-size="${u}px"
      font-weight="${e.typography.fontWeightMedium}"
      fill="${e.colors.secondary}">${J(o)}</text>`),`<g transform="translate(0, ${n.mainY+n.headerHeight+n.plotHeight})">${c.join(`
`)}</g>`}function no(t,n,e,o,s,a,i,h,c,r){const l=[],u=et(a.typography.fontSizeBase),f=a.typography.headerFontScale??1.05,d=Math.round(u*f*100)/100,g=a.typography.fontWeightBold,N=a.typography.fontWeightBold,I=kt(t),A=(x,_)=>x+_/2+d*st.TEXT_BASELINE_ADJUSTMENT;if(I){const x=s/2,_=s/2;let M=e;l.push(`<text x="${M+q.TEXT_PADDING}" y="${A(o,s)}"
      font-family="${a.typography.fontFamily}"
      font-size="${d}px"
      font-weight="${g}"
      fill="${a.colors.foreground}">${J(i)}</text>`),M+=h;const D=[];for(const p of t)if(p.isGroup){const y=p.columns.reduce((w,T)=>T.isGroup?w+T.columns.reduce((C,k)=>C+r(k),0):w+r(T),0),m=M+y/2;l.push(`<text x="${m}" y="${A(o,x)}"
          font-family="${a.typography.fontFamily}"
          font-size="${d}px"
          font-weight="${N}"
          text-anchor="middle"
          fill="${a.colors.foreground}">${J(p.header)}</text>`),D.push({x1:M,x2:M+y}),M+=y}else{const y=r(p),m=p.headerAlign??p.align,{textX:w,anchor:T}=Ht(M,y,m),C=cn(p.header,y,d,q.TEXT_PADDING);l.push(`<text x="${w}" y="${A(o,s)}"
          font-family="${a.typography.fontFamily}"
          font-size="${d}px"
          font-weight="${g}"
          text-anchor="${T}"
          fill="${a.colors.foreground}">${J(C)}</text>`),M+=y}for(const p of D)l.push(`<line x1="${p.x1}" x2="${p.x2}"
        y1="${o+x}" y2="${o+x}"
        stroke="${a.colors.border}" stroke-width="1"/>`);M=e+h;for(const p of t)if(p.isGroup){for(const y of p.columns)if(!y.isGroup){const m=r(y),w=y.headerAlign??y.align,{textX:T,anchor:C}=Ht(M,m,w);l.push(`<text x="${T}" y="${A(o+x,_)}"
              font-family="${a.typography.fontFamily}"
              font-size="${d}px"
              font-weight="${g}"
              text-anchor="${C}"
              fill="${a.colors.foreground}">${J(y.header)}</text>`),M+=m}}else M+=r(p)}else{let x=e;l.push(`<text x="${x+q.TEXT_PADDING}" y="${A(o,s)}"
      font-family="${a.typography.fontFamily}"
      font-size="${d}px"
      font-weight="${g}"
      fill="${a.colors.foreground}">${J(i)}</text>`),x+=h;for(const _ of n){const M=r(_),D=_.headerAlign??_.align,{textX:p,anchor:y}=Ht(x,M,D),m=cn(_.header,M,d,q.TEXT_PADDING);l.push(`<text x="${p}" y="${A(o,s)}"
        font-family="${a.typography.fontFamily}"
        font-size="${d}px"
        font-weight="${g}"
        text-anchor="${y}"
        fill="${a.colors.foreground}">${J(m)}</text>`),x+=M}}return l.join(`
`)}function oo(t,n,e,o,s,a,i,h,c,r,l,u){var _,M,D,p,y,m,w,T,C,k,F,V,z,j,$,v,E,H,b,P,R,B,Y,U,X,rt,yt,ft,at;const f=[],d=et(a.typography.fontSizeBase),g=o+s/2+d*st.TEXT_BASELINE_ADJUSTMENT,N=h*q.INDENT_PER_LEVEL+(((_=t.style)==null?void 0:_.indent)??0)*q.INDENT_PER_LEVEL,I=(M=t.style)!=null&&M.bold||(D=t.style)!=null&&D.emphasis?a.typography.fontWeightBold:a.typography.fontWeightNormal,A=(p=t.style)!=null&&p.italic?"italic":"normal";let x=a.colors.foreground;if((y=t.style)!=null&&y.color?x=t.style.color:(m=t.style)!=null&&m.muted?x=a.colors.muted:(w=t.style)!=null&&w.accent&&(x=a.colors.accent),f.push(`<text x="${e+q.TEXT_PADDING+N}" y="${g}"
    font-family="${a.typography.fontFamily}"
    font-size="${d}px"
    font-weight="${I}"
    font-style="${A}"
    fill="${x}">${J(t.label)}</text>`),(T=t.style)!=null&&T.badge){const it=String(t.style.badge),S=d*xt.FONT_SCALE,K=S+xt.PADDING*2,Q=ot(t.label,d),dt=e+q.TEXT_PADDING+N+Q+xt.GAP,O=ot(it,S)+xt.PADDING*2,G=o+(s-K)/2;f.push(`<rect x="${dt}" y="${G}" width="${O}" height="${K}"
      rx="3" fill="${a.colors.primary}" opacity="0.15"/>`),f.push(`<text x="${dt+O/2}" y="${G+K/2+S*.35}"
      text-anchor="middle"
      font-family="${a.typography.fontFamily}"
      font-size="${S}px"
      font-weight="${a.typography.fontWeightMedium}"
      fill="${a.colors.primary}">${J(it)}</text>`)}for(let it=0;it<n.length;it++){const S=n[it],K=u[it],Q=l(S);if(S.type==="forest"||S.type==="viz_bar"||S.type==="viz_boxplot"||S.type==="viz_violin")continue;const dt=Un(t,S),{textX:W,anchor:O}=Ht(K,Q,S.align);if(S.type==="bar"&&typeof t.metadata[S.field]=="number"){const G=t.metadata[S.field],L=c.get(S.field),tt=((k=(C=S.options)==null?void 0:C.bar)==null?void 0:k.maxValue)??L??100,nt=((V=(F=S.options)==null?void 0:F.bar)==null?void 0:V.color)??a.colors.primary,Z=a.shapes.pointSize*2,pt=Q-q.TEXT_PADDING*2-50,lt=Math.min(G/tt*pt,pt);f.push(`<rect x="${K+q.TEXT_PADDING}" y="${o+s/2-Z/2}"
        width="${Math.max(0,lt)}" height="${Z}"
        fill="${nt}" opacity="0.7" rx="2"/>`),f.push(`<text x="${K+Q-q.TEXT_PADDING}" y="${g}"
        font-family="${a.typography.fontFamily}"
        font-size="${d}px"
        text-anchor="end"
        fill="${a.colors.foreground}">${Tt(G)}</text>`)}else if(S.type==="sparkline"&&Array.isArray(t.metadata[S.field])){let G=t.metadata[S.field];Array.isArray(G[0])&&(G=G[0]);const L=((j=(z=S.options)==null?void 0:z.sparkline)==null?void 0:j.height)??16,tt=((v=($=S.options)==null?void 0:$.sparkline)==null?void 0:v.color)??a.colors.primary,nt=q.TEXT_PADDING*2,Z=Xn(G,K+q.TEXT_PADDING,o+s/2-L/2,Q-nt,L);f.push(`<path d="${Z}" fill="none" stroke="${tt}" stroke-width="1.5"/>`)}else if(S.type==="badge"){const G=t.metadata[S.field];if(G!=null){const L=String(G),tt=d*.85,nt=tt+8,Z=(H=(E=S.options)==null?void 0:E.badge)==null?void 0:H.variants,ht=(P=(b=S.options)==null?void 0:b.badge)==null?void 0:P.colors;let pt=a.colors.primary,lt=a.colors.primary;if(ht&&L in ht)pt=ht[L],lt=ht[L];else if(Z&&L in Z){const jt=Z[L];pt={default:a.colors.primary,...En,muted:a.colors.muted}[jt]??a.colors.primary,lt=pt}const bt=ot(L,tt)+12,At=S.align==="right"?K+Q-q.TEXT_PADDING-bt:S.align==="center"?K+(Q-bt)/2:K+q.TEXT_PADDING,Ft=o+(s-nt)/2;f.push(`<rect x="${At}" y="${Ft}" width="${bt}" height="${nt}"
          rx="${nt/2}" fill="${pt}" opacity="0.15"/>`),f.push(`<text x="${At+bt/2}" y="${Ft+nt/2+tt*.35}"
          text-anchor="middle"
          font-family="${a.typography.fontFamily}"
          font-size="${tt}px"
          font-weight="${a.typography.fontWeightMedium}"
          fill="${lt}">${J(L)}</text>`)}}else if(S.type==="stars"){const G=t.metadata[S.field];if(typeof G=="number"){const L=((B=(R=S.options)==null?void 0:R.stars)==null?void 0:B.maxStars)??5,tt=((U=(Y=S.options)==null?void 0:Y.stars)==null?void 0:U.color)??"#f59e0b",nt=((rt=(X=S.options)==null?void 0:X.stars)==null?void 0:rt.emptyColor)??"#d1d5db",Z=Math.max(0,Math.min(L,G)),ht=Math.floor(Z),pt=((ft=(yt=S.options)==null?void 0:yt.stars)==null?void 0:ft.halfStars)&&Z-ht>=.5,lt=12,Yt=2,bt=L*lt+(L-1)*Yt;let At=S.align==="right"?K+Q-q.TEXT_PADDING-bt:S.align==="center"?K+(Q-bt)/2:K+q.TEXT_PADDING;const Ft=o+(s-lt)/2,jt=($t,St,Ot)=>{const Wt=Ot/2,vt=Wt*.4;let un="";for(let It=0;It<5;It++){const fn=(It*72-90)*Math.PI/180,dn=(It*72+36-90)*Math.PI/180,hn=$t+Wt*Math.cos(fn),pn=St+Wt*Math.sin(fn),lo=$t+vt*Math.cos(dn),co=St+vt*Math.sin(dn);un+=(It===0?`M${hn},${pn}`:`L${hn},${pn}`)+`L${lo},${co}`}return un+"Z"};for(let $t=0;$t<L;$t++){const St=At+lt/2,Ot=Ft+lt/2,vt=$t<ht||$t===ht&&pt?tt:nt;f.push(`<path d="${jt(St,Ot,lt)}" fill="${vt}"/>`),At+=lt+Yt}}}else{const G=(at=t.cellStyles)==null?void 0:at[S.field],L=t.style;let tt=a.typography.fontWeightNormal;(G!=null&&G.bold||G!=null&&G.emphasis||L!=null&&L.bold||L!=null&&L.emphasis)&&(tt=a.typography.fontWeightBold);let nt="normal";(G!=null&&G.italic||L!=null&&L.italic)&&(nt="italic");let Z=a.colors.foreground;G!=null&&G.color?Z=G.color:G!=null&&G.muted?Z=a.colors.muted:G!=null&&G.accent?Z=a.colors.accent:L!=null&&L.color?Z=L.color:L!=null&&L.muted?Z=a.colors.muted:L!=null&&L.accent&&(Z=a.colors.accent),f.push(`<text x="${W}" y="${g}"
        font-family="${a.typography.fontFamily}"
        font-size="${d}px"
        font-weight="${tt}"
        font-style="${nt}"
        text-anchor="${O}"
        fill="${Z}">${J(dt)}</text>`)}}return f.join(`
`)}function eo(t,n,e,o,s,a){if(Array.isArray(e.axis.tickValues)&&e.axis.tickValues.length>0){const[y,m]=t.domain();let w=e.axis.tickValues.filter(k=>k>=y&&k<=m);const T=e.axis.nullTick!==!1,C=o>=y&&o<=m;return T&&C&&!w.includes(o)&&(w=[...w,o].sort((k,F)=>k-F)),w}const[i,h]=t.domain(),c=e.axis.nullTick!==!1,r=o>=i&&o<=h,l=Lt.MIN_TICK_SPACING,u=Math.max(2,Math.floor(s/l)),f=Math.min(n,Math.min(7,u)),d=a&&a.length>0?a.filter(y=>y>=i&&y<=h):t.ticks(f);if(d.length===0)return c&&r?[o]:[];const g=t(o),N=d.filter(y=>y<o).reverse(),I=d.filter(y=>y>o),A=d.some(y=>y===o),x=[];let _=g;for(const y of N){const m=t(y);_-m>=l&&(x.unshift(y),_=m)}const M=[];let D=g;for(const y of I){const m=t(y);m-D>=l&&(M.push(y),D=m)}const p=[...x];if((A||c&&r)&&p.push(o),p.push(...M),p.length<2){const y=new Set(p);y.has(i)||p.unshift(i),p.length<2&&!y.has(h)&&p.push(h)}return p}function qt(t,n,e,o,s,a,i=1,h=.6){let r=`<line x1="${t}" x2="${t}" y1="${n}" y2="${e}"
    stroke="${s}" stroke-width="${i}" stroke-opacity="${h}" stroke-dasharray="${o==="dashed"?"6,4":o==="dotted"?"2,2":"none"}"/>`;return a&&(r+=`<text x="${t}" y="${n-4}" text-anchor="middle"
      font-size="10px" fill="${s}">${J(a)}</text>`),r}class Mt extends Error{constructor(n){super(`SVG Generator: ${n}`),this.name="SVGGeneratorError"}}function ro(t){if(!t||typeof t!="object")throw new Mt("Invalid spec: expected an object");const n=t;if(!n.data||typeof n.data!="object")throw new Mt("Invalid spec: missing or invalid 'data' property");const e=n.data;if(!Array.isArray(e.rows))throw new Mt("Invalid spec: 'data.rows' must be an array");if(!n.theme||typeof n.theme!="object")throw new Mt("Invalid spec: missing or invalid 'theme' property");const o=n.theme;if(!o.colors||typeof o.colors!="object")throw new Mt("Invalid spec: missing or invalid 'theme.colors'");if(!o.typography||typeof o.typography!="object")throw new Mt("Invalid spec: missing or invalid 'theme.typography'");if(!o.spacing||typeof o.spacing!="object")throw new Mt("Invalid spec: missing or invalid 'theme.spacing'")}function ao(t){var a;const e=Ut(t.columns,void 0).find(i=>i.type==="forest");if(!e||!((a=e.options)!=null&&a.forest))return{scale:"linear",nullValue:0,effects:[],axisLabel:"Effect",pointCol:null,lowerCol:null,upperCol:null};const o=e.options.forest,s=o.scale??"linear";return{scale:s,nullValue:o.nullValue??(s==="log"?1:0),effects:o.effects??[],axisLabel:o.axisLabel??"Effect",pointCol:o.point??null,lowerCol:o.lower??null,upperCol:o.upper??null}}function so(t,n={}){var T,C,k,F,V,z,j;ro(t);const e=t.theme,o=e.spacing.padding,s=Array.isArray(t.columns)?t.columns:[],a=zt(s),i=[];for(let $=0;$<a.length;$++)a[$].type==="forest"&&i.push($);i.length>0;const h=[];for(let $=0;$<a.length;$++){const v=a[$];(v.type==="viz_bar"||v.type==="viz_boxplot"||v.type==="viz_violin")&&h.push({index:$,type:v.type,column:v})}const c=ao(t),r=Gn(t,n,c.nullValue),l=r.autoWidths,u=$=>{var E,H,b,P,R,B,Y,U;if($.type==="forest"){const X=l.get($.id);return X!==void 0?X:typeof $.width=="number"?$.width:((H=(E=$.options)==null?void 0:E.forest)==null?void 0:H.width)??r.forestWidth}if($.type==="viz_bar"){const X=l.get($.id);return X!==void 0?X:typeof $.width=="number"?$.width:((P=(b=$.options)==null?void 0:b.vizBar)==null?void 0:P.width)??r.forestWidth}if($.type==="viz_boxplot"){const X=l.get($.id);return X!==void 0?X:typeof $.width=="number"?$.width:((B=(R=$.options)==null?void 0:R.vizBoxplot)==null?void 0:B.width)??r.forestWidth}if($.type==="viz_violin"){const X=l.get($.id);return X!==void 0?X:typeof $.width=="number"?$.width:((U=(Y=$.options)==null?void 0:Y.vizViolin)==null?void 0:U.width)??r.forestWidth}const v=l.get($.id);return v!==void 0?v:typeof $.width=="number"?$.width:mt.DEFAULT_COLUMN_WIDTH},f=[];let d=o+r.labelWidth;for(const $ of a)f.push(d),d+=u($);const g=[];g.push(`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg"
  width="${r.totalWidth}" height="${r.totalHeight}"
  viewBox="0 0 ${r.totalWidth} ${r.totalHeight}">
<style>
  text { font-variant-numeric: tabular-nums; }
</style>`);const N=n.backgroundColor??e.colors.background;g.push(`<rect width="100%" height="100%" fill="${N}"/>`),g.push(Rn(t,r,e)),(!!((T=t.labels)!=null&&T.title)||!!((C=t.labels)!=null&&C.subtitle))&&g.push(`<line x1="${o}" x2="${r.totalWidth-o}"
      y1="${r.mainY}" y2="${r.mainY}"
      stroke="${e.colors.border}" stroke-width="2"/>`);const A=r.mainY;g.push(no(s,a,o,A,r.headerHeight,e,t.data.labelHeader??"Study",r.labelWidth,l,u)),g.push(`<line x1="${o}" x2="${r.totalWidth-o}"
    y1="${A+r.headerHeight}" y2="${A+r.headerHeight}"
    stroke="${e.colors.border}" stroke-width="2"/>`);const x=sn(t),_=[],M=[];let D=0;for(const $ of x){const E=$.type==="data"&&((k=$.row.style)==null?void 0:k.type)==="spacer"?r.rowHeight/2:r.rowHeight;_.push(D),M.push(E),D+=E}const p=r.mainY+r.headerHeight;e.layout.banding&&x.forEach(($,v)=>{var E,H;if($.type==="data"){const b=$.row,P=((E=b.style)==null?void 0:E.type)==="spacer",R=(H=b.style)==null?void 0:H.bg;if(!P&&!R){const B=p+_[v],Y=M[v],X=v%2===1?e.colors.altBg:e.colors.rowBg;X!==e.colors.background&&g.push(`<rect x="${o}" y="${B}"
              width="${r.totalWidth-o*2}" height="${Y}"
              fill="${X}"/>`)}}});for(const $ of i){const v=a[$],E=f[$],H=u(v),b=(F=v.options)==null?void 0:F.forest,P=(b==null?void 0:b.scale)??"linear",R=(b==null?void 0:b.nullValue)??(P==="log"?1:0),B=(b==null?void 0:b.axisLabel)??"Effect",Y=P==="log";let U=(b==null?void 0:b.effects)??[];const X=(b==null?void 0:b.point)??null,rt=(b==null?void 0:b.lower)??null,yt=(b==null?void 0:b.upper)??null;U.length===0&&(X||rt||yt)&&(U=[{pointCol:X,lowerCol:rt,upperCol:yt}]);const ft={scale:P,nullValue:R,effects:U,pointCol:(b==null?void 0:b.point)??null,lowerCol:(b==null?void 0:b.lower)??null,upperCol:(b==null?void 0:b.upper)??null},{scale:at,clipBounds:it,ticks:S}=Pn(t,H,ft,n),K=E+at(R);g.push(qt(K,p,p+r.plotHeight,"dashed",e.colors.muted));const Q=(b==null?void 0:b.annotations)??[];for(const W of Q)if(W.type==="reference_line"){const O=E+at(W.x);g.push(qt(O,p,p+r.plotHeight,W.style,W.color??e.colors.accent,W.label,W.width??1,W.opacity??.6))}const dt=Array.isArray(t.annotations)?t.annotations:[];for(const W of dt)if(W.type==="reference_line"){const O=E+at(W.x);g.push(qt(O,p,p+r.plotHeight,W.style,W.color??e.colors.accent,W.label,W.width??1,W.opacity??.6))}if(x.forEach((W,O)=>{if(W.type==="data"){const G=p+_[O]+M[O]/2;g.push(qn(W.row,G,L=>E+at(L),e,R,U,t.data.weightCol,E,H,it,Y))}}),t.data.overall&&r.showOverallSummary&&typeof t.data.overall.point=="number"&&!Number.isNaN(t.data.overall.point)&&typeof t.data.overall.lower=="number"&&!Number.isNaN(t.data.overall.lower)&&typeof t.data.overall.upper=="number"&&!Number.isNaN(t.data.overall.upper)){const W=p+r.summaryYPosition;g.push(Yn(t.data.overall.point,t.data.overall.lower,t.data.overall.upper,W,at,E,H,e))}g.push(to(at,r,e,B,E,H,R,S))}const y=t.data.rows;for(const $ of h){const v=$.column,E=f[$.index],H=u(v);if($.type==="viz_bar"){const b=(V=v.options)==null?void 0:V.vizBar;if(!b)continue;const P=Zn(y,b,H);x.forEach((R,B)=>{if(R.type==="data"){const Y=p+_[B]+M[B]/2,U=M[B];g.push(jn(R.row,Y,U,E,H,b,P,e))}}),b.showAxis!==!1&&(g.push(`<g transform="translate(0, ${p+r.plotHeight})">`),g.push(Xt(P,r,e,b.axisLabel,E,H,b.nullValue)),g.push("</g>"))}else if($.type==="viz_boxplot"){const b=(z=v.options)==null?void 0:z.vizBoxplot;if(!b)continue;const P=Jn(y,b,H);x.forEach((R,B)=>{if(R.type==="data"){const Y=p+_[B]+M[B]/2,U=M[B];g.push(On(R.row,Y,U,E,H,b,P,e))}}),b.showAxis!==!1&&(g.push(`<g transform="translate(0, ${p+r.plotHeight})">`),g.push(Xt(P,r,e,b.axisLabel,E,H,b.nullValue)),g.push("</g>"))}else if($.type==="viz_violin"){const b=(j=v.options)==null?void 0:j.vizViolin;if(!b)continue;const P=Qn(y,b,H);x.forEach((R,B)=>{if(R.type==="data"){const Y=p+_[B]+M[B]/2,U=M[B];g.push(Kn(R.row,Y,U,E,H,b,P,e))}}),b.showAxis!==!1&&(g.push(`<g transform="translate(0, ${p+r.plotHeight})">`),g.push(Xt(P,r,e,b.axisLabel,E,H,b.nullValue)),g.push("</g>"))}}const m=r.mainY+r.headerHeight,w=zn(y,a);return x.forEach(($,v)=>{var b,P;const E=m+_[v],H=M[v];if($.type==="group_header")g.push(Vn($.label,$.depth,o,E,H,r.totalWidth-o*2,e));else{const R=$.row,B=$.depth;g.push(oo(R,a,o,E,H,e,r.labelWidth,B,w,l,u,f))}if($.type==="data"){const R=$.row,B=((b=R.style)==null?void 0:b.type)==="summary",Y=((P=R.style)==null?void 0:P.type)==="spacer";B&&g.push(`<line x1="${o}" x2="${r.totalWidth-o}"
          y1="${E}" y2="${E}"
          stroke="${e.colors.border}" stroke-width="2"/>`),Y||g.push(`<line x1="${o}" x2="${r.totalWidth-o}"
          y1="${E+H}" y2="${E+H}"
          stroke="${e.colors.border}" stroke-width="1"/>`)}else g.push(`<line x1="${o}" x2="${r.totalWidth-o}"
        y1="${E+H}" y2="${E+H}"
        stroke="${e.colors.border}" stroke-width="1"/>`)}),g.push(Bn(t,r,e)),g.push("</svg>"),g.join(`
`)}function io(t,n){const e=JSON.parse(t);return so(e,n)}globalThis.generateSVG=io})();
