(function(){"use strict";function dt(t,e){if(e){const s=[.05,.1,.15,.2,.25,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.75,2,2.5,3,4,5,6,7,8,10,12,15,20,25,30,40,50,75,100];let l=s[0];for(const a of s)if(a<=t[0])l=a;else break;let c=s[s.length-1];for(let a=s.length-1;a>=0&&s[a]>=t[1];a--)c=s[a];return[l,c]}const n=t[1]-t[0];if(n===0)return t;const o=Math.pow(10,Math.floor(Math.log10(n))),i=n/o;let r;i<=1?r=o*.1:i<=2?r=o*.2:i<=5?r=o*.5:r=o;const f=Math.floor(t[0]/r)*r,u=Math.ceil(t[1]/r)*r;return[f,u]}const ot=.15,ht=.06,pt=.05,nt=.04;function gt(t){return t<=0?0:nt+t*nt}const D={DEFAULT_LABEL_WIDTH:200,DEFAULT_COLUMN_WIDTH:100,AXIS_HEIGHT:32,AXIS_LABEL_HEIGHT:20,BOTTOM_MARGIN:16,MIN_FOREST_WIDTH:200,DEFAULT_WIDTH:800,COLUMN_GAP:16},F={TITLE_HEIGHT:28,SUBTITLE_HEIGHT:20,CAPTION_HEIGHT:16,FOOTNOTE_HEIGHT:14,DEFAULT_FONT_SIZE:14,REM_BASE:16,TEXT_BASELINE_ADJUSTMENT:1/3},L={INDENT_PER_LEVEL:12,TEXT_PADDING:10,WHISKER_HALF_HEIGHT:4,DEFAULT_TICK_COUNT:5},et={GROUP_HEADER_HEIGHT_MULTIPLIER:1.5,OVERALL_ROW_HEIGHT_MULTIPLIER:1.5};function $t(t,e){var C,O,V,z;const n=t.theme,o=n.spacing.rowHeight,i=n.spacing.padding,r=Array.isArray(t.columns)?t.columns:[],f=Y(r,"left"),u=Y(r,"right"),l=K(f)||K(u)?n.spacing.headerHeight*et.GROUP_HEADER_HEIGHT_MULTIPLIER:n.spacing.headerHeight,c=!!((C=t.labels)!=null&&C.title),a=!!((O=t.labels)!=null&&O.subtitle),g=!!((V=t.labels)!=null&&V.caption),b=!!((z=t.labels)!=null&&z.footnote),p=c?F.TITLE_HEIGHT:0,A=a?F.SUBTITLE_HEIGHT:0,h=p+A+(c||a?i:0),x=g?F.CAPTION_HEIGHT:0,m=b?F.FOOTNOTE_HEIGHT:0,_=x+m+(g||b?i:0),d=rt(t).length,$=!!t.data.overall,y=d*o+($?o*et.OVERALL_ROW_HEIGHT_MULTIPLIER:0),T=j(r,"left"),H=j(r,"right"),N=D.DEFAULT_LABEL_WIDTH+T.reduce((k,U)=>k+(typeof U.width=="number"?U.width:D.DEFAULT_COLUMN_WIDTH),0),E=H.reduce((k,U)=>k+(typeof U.width=="number"?U.width:D.DEFAULT_COLUMN_WIDTH),0),w=e.width??D.DEFAULT_WIDTH,S=t.data.includeForest,R=N+E;let W;if(!S)W=0;else if(typeof t.layout.plotWidth=="number")W=t.layout.plotWidth;else{const k=w-R-D.COLUMN_GAP*2-i*2;W=Math.max(k,D.MIN_FOREST_WIDTH)}const G=i*2+R+W+D.COLUMN_GAP*2,P=Math.max(e.width??w,G),v=h+i+l+y+D.AXIS_HEIGHT+D.AXIS_LABEL_HEIGHT+_+D.BOTTOM_MARGIN;return{totalWidth:P,totalHeight:e.height??v,tableWidth:N+E,forestWidth:W,headerHeight:l,rowHeight:o,plotHeight:y,axisHeight:D.AXIS_HEIGHT,nullValue:t.data.nullValue,summaryYPosition:y-o,showOverallSummary:$,headerTextHeight:h,footerTextHeight:_,titleY:i+F.TITLE_HEIGHT-8,subtitleY:i+p+F.SUBTITLE_HEIGHT-4,mainY:h+i,footerY:h+i+l+y+D.AXIS_HEIGHT+D.AXIS_LABEL_HEIGHT+i}}function rt(t){var c;const e=t.data.rows,n=Array.isArray(t.data.groups)?t.data.groups:[];if(n.length===0)return e.map(a=>({type:"data",row:a,depth:0}));const o=new Map;for(const a of n)o.set(a.id,a);const i=new Map;for(const a of e){const g=a.groupId??null;i.has(g)||i.set(g,[]),i.get(g).push(a)}const r=new Set;for(const a of i.keys()){if(!a)continue;let g=a;for(;g;)r.add(g),g=(c=o.get(g))==null?void 0:c.parentId}function f(a){return n.filter(g=>(g.parentId??null)===a&&r.has(g.id))}function u(a){if(!a)return 0;const g=o.get(a);return g?g.depth+1:0}const s=[];function l(a){var b;if(a){const p=o.get(a);if(!p)return;const A=((b=i.get(a))==null?void 0:b.length)??0;s.push({type:"group_header",groupId:p.id,label:p.label,depth:p.depth,rowCount:A})}for(const p of f(a))l(p.id);const g=i.get(a)??[];for(const p of g)s.push({type:"data",row:p,depth:u(p.groupId)})}return l(null),s}function it(t){const e=[];for(const n of t)n.isGroup?e.push(...it(n.columns)):e.push(n);return e}function j(t,e){const n=[];for(const o of t)o.position===e&&(o.isGroup?n.push(...it(o.columns)):n.push(o));return n}function Y(t,e){return t.filter(n=>n.position===e)}function K(t){return t.some(e=>e.isGroup)}function at(t,e){return t.isGroup?t.columns.reduce((n,o)=>n+at(o,e),0):typeof t.width=="number"?t.width:e}function X(t){return t.endsWith("rem")?parseFloat(t)*F.REM_BASE:t.endsWith("px")?parseFloat(t):F.DEFAULT_FONT_SIZE}function J(t,e,n){return n==="right"?{textX:t+e-L.TEXT_PADDING,anchor:"end"}:n==="center"?{textX:t+e/2,anchor:"middle"}:{textX:t+L.TEXT_PADDING,anchor:"start"}}function M(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function q(t,e,n,o=0){const i=n*.55,r=e-o*2,f=Math.floor(r/i);return t.length<=f?t:t.slice(0,f-1)+"…"}function Z(t,e){const n=t.split(".");return n[0]=n[0].replace(/\B(?=(\d{3})+(?!\d))/g,e),n.join(".")}function Q(t,e){var r,f;if(t==null||Number.isNaN(t))return(e==null?void 0:e.naText)??"";if(e!=null&&e.percent){const{decimals:u=1,multiply:s=!1,symbol:l=!0}=e.percent,a=(s?t*100:t).toFixed(u);return l?`${a}%`:a}const n=(r=e==null?void 0:e.numeric)==null?void 0:r.decimals,o=(f=e==null?void 0:e.numeric)==null?void 0:f.thousandsSep;let i;return n!==void 0?i=t.toFixed(n):Number.isInteger(t)||Math.abs(t-Math.round(t))<1e-4?i=Math.round(t).toString():i=t.toFixed(2),o&&typeof o=="string"&&(i=Z(i,o)),i}function yt(t,e){const{eventsField:n,nField:o,separator:i="/",showPct:r=!1,thousandsSep:f}=e.events,u=t.metadata[n],s=t.metadata[o];if(u==null||s===void 0||s===null)return e.naText??"";const l=Number(u),c=Number(s);let a=String(l),g=String(c);f&&typeof f=="string"&&(a=Z(a,f),g=Z(g,f));let b=`${a}${i}${g}`;if(r&&c>0){const p=(l/c*100).toFixed(1);b+=` (${p}%)`}return b}function mt(t,e,n){return t==null||Number.isNaN(t)?"":e==null||n===void 0||n===null||Number.isNaN(e)||Number.isNaN(n)?Q(t):`${t.toFixed(2)} (${e.toFixed(2)}, ${n.toFixed(2)})`}const xt={0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹","-":"⁻","+":"⁺"};function Tt(t){return t.split("").map(e=>xt[e]??e).join("")}function Et(t,e){const n=e==null?void 0:e.pvalue,o=(n==null?void 0:n.digits)??2,i=(n==null?void 0:n.expThreshold)??.001,r=(n==null?void 0:n.format)??"auto",f=(n==null?void 0:n.stars)??!1,u=(n==null?void 0:n.thresholds)??[.05,.01,.001];let s="";if(f&&(t<u[2]?s="***":t<u[1]?s="**":t<u[0]&&(s="*")),t<1e-4)return`<0.0001${s}`;if(r==="scientific"||r==="auto"&&t<i){const c=Math.floor(Math.log10(t));return`${(t/Math.pow(10,c)).toPrecision(o)}×10${Tt(c.toString())}${s}`}let l;return t>=.1?l=t.toFixed(o):t>=.01?l=t.toFixed(o+1):l=t.toFixed(o+2),`${l}${s}`}function bt(t){return Math.abs(t)<.01?"0":Math.abs(t)>=100?t.toFixed(0):Math.abs(t)>=10?t.toFixed(1):t.toFixed(2)}function _t(t,e){const[n,o]=t,[i,r]=e,f=(r-i)/(o-n),u=s=>i+(s-n)*f;return u.domain=()=>t,u.range=()=>e,u.ticks=s=>{const l=(o-n)/(s-1),c=[];for(let a=0;a<s;a++)c.push(n+l*a);return c},u}function It(t,e){const[n,o]=t.map(c=>Math.max(c,.001)),[i,r]=e,f=Math.log10(n),u=Math.log10(o),s=(r-i)/(u-f),l=c=>{const a=Math.log10(Math.max(c,.001));return i+(a-f)*s};return l.domain=()=>[n,o],l.range=()=>e,l.ticks=c=>{const a=[],g=Math.floor(Math.log10(n)),b=Math.ceil(Math.log10(o));for(let p=g;p<=b;p++){const A=Math.pow(10,p);for(const h of[1,2,5]){const x=A*h;x>=n&&x<=o&&a.push(x)}}return a.length>0?a:[n,o]},l}function Ht(t,e){const n=t.data.rows,o=t.theme.axis,i=t.data.scale==="log",r=typeof(o==null?void 0:o.rangeMin)=="number",f=typeof(o==null?void 0:o.rangeMax)=="number";let u;if(r&&f)u=[o.rangeMin,o.rangeMax];else{const l=n.flatMap(c=>[c.lower,c.upper]).filter(c=>c!=null&&!Number.isNaN(c)&&Number.isFinite(c));if(l.length===0)u=i?[.1,10]:[0,1];else{const[c,a]=[Math.min(...l),Math.max(...l)],g=a-c||1;u=[r?o.rangeMin:c-g*ot,f?o.rangeMax:a+g*ot]}}const s=dt(u,i);return i?It([Math.max(s[0],.01),Math.max(s[1],.02)],[0,e]):_t(s,[0,e])}function At(t,e,n){var r,f;const o=[],i=n.spacing.padding;if((r=t.labels)!=null&&r.title){const u=X(n.typography.fontSizeLg);o.push(`<text x="${i}" y="${e.titleY}"
      font-family="${n.typography.fontFamily}"
      font-size="${u}px"
      font-weight="${n.typography.fontWeightBold}"
      fill="${n.colors.foreground}">${M(t.labels.title)}</text>`)}if((f=t.labels)!=null&&f.subtitle){const u=X(n.typography.fontSizeBase);o.push(`<text x="${i}" y="${e.subtitleY}"
      font-family="${n.typography.fontFamily}"
      font-size="${u}px"
      fill="${n.colors.secondary}">${M(t.labels.subtitle)}</text>`)}return o.join(`
`)}function Nt(t,e,n){var f,u;const o=[],i=n.spacing.padding;let r=e.footerY;if((f=t.labels)!=null&&f.caption){const s=X(n.typography.fontSizeSm);o.push(`<text x="${i}" y="${r}"
      font-family="${n.typography.fontFamily}"
      font-size="${s}px"
      fill="${n.colors.secondary}">${M(t.labels.caption)}</text>`),r+=F.CAPTION_HEIGHT}if((u=t.labels)!=null&&u.footnote){const s=X(n.typography.fontSizeSm);o.push(`<text x="${i}" y="${r}"
      font-family="${n.typography.fontFamily}"
      font-size="${s}px"
      font-style="italic"
      fill="${n.colors.muted}">${M(t.labels.footnote)}</text>`)}return o.join(`
`)}function st(t,e,n,o,i,r,f,u){const s=[],l=X(r.typography.fontSizeSm),c=r.typography.fontWeightMedium,a=r.typography.fontWeightBold,g=K(t),b=D.DEFAULT_COLUMN_WIDTH,p=u??D.DEFAULT_LABEL_WIDTH,A=(h,x)=>h+x/2+l*F.TEXT_BASELINE_ADJUSTMENT;if(g){const h=i/2,x=i/2;let m=n;f&&(s.push(`<text x="${m+L.TEXT_PADDING}" y="${A(o,i)}"
        font-family="${r.typography.fontFamily}"
        font-size="${l}px"
        font-weight="${c}"
        fill="${r.colors.foreground}">${M(f)}</text>`),s.push(`<line x1="${m+p}" x2="${m+p}"
        y1="${o}" y2="${o+i}"
        stroke="${r.colors.border}" stroke-width="1" opacity="0.3"/>`),m+=p);for(const _ of t)if(_.isGroup){const I=at(_,b),d=m+I/2;s.push(`<text x="${d}" y="${A(o,h)}"
          font-family="${r.typography.fontFamily}"
          font-size="${l}px"
          font-weight="${a}"
          text-anchor="middle"
          fill="${r.colors.foreground}">${M(_.header)}</text>`),s.push(`<line x1="${m}" x2="${m+I}"
          y1="${o+h}" y2="${o+h}"
          stroke="${r.colors.border}" stroke-width="1" opacity="0.5"/>`),m+=I}else{const I=typeof _.width=="number"?_.width:b,d=_.headerAlign??_.align,{textX:$,anchor:y}=J(m,I,d),T=q(_.header,I,l,L.TEXT_PADDING);s.push(`<text x="${$}" y="${A(o,i)}"
          font-family="${r.typography.fontFamily}"
          font-size="${l}px"
          font-weight="${c}"
          text-anchor="${y}"
          fill="${r.colors.foreground}">${M(T)}</text>`),m+=I}m=n+(f?p:0);for(const _ of t)if(_.isGroup){for(const I of _.columns)if(!I.isGroup){const d=typeof I.width=="number"?I.width:b,$=I.headerAlign??I.align,{textX:y,anchor:T}=J(m,d,$);s.push(`<text x="${y}" y="${A(o+h,x)}"
              font-family="${r.typography.fontFamily}"
              font-size="${l}px"
              font-weight="${c}"
              text-anchor="${T}"
              fill="${r.colors.foreground}">${M(I.header)}</text>`),m+=d}}else{const I=typeof _.width=="number"?_.width:b;m+=I}}else{let h=n;f&&(s.push(`<text x="${h+L.TEXT_PADDING}" y="${A(o,i)}"
        font-family="${r.typography.fontFamily}"
        font-size="${l}px"
        font-weight="${c}"
        fill="${r.colors.foreground}">${M(f)}</text>`),h+=p);for(const x of e){const m=typeof x.width=="number"?x.width:b,_=x.headerAlign??x.align,{textX:I,anchor:d}=J(h,m,_),$=q(x.header,m,l,L.TEXT_PADDING);s.push(`<text x="${I}" y="${A(o,i)}"
        font-family="${r.typography.fontFamily}"
        font-size="${l}px"
        font-weight="${c}"
        text-anchor="${d}"
        fill="${r.colors.foreground}">${M($)}</text>`),h+=m}}return s.join(`
`)}function Dt(t,e,n,o,i,r,f){const u=[],s=X(f.typography.fontSizeBase),l=o+i/2+s*F.TEXT_BASELINE_ADJUSTMENT,c=e*L.INDENT_PER_LEVEL;return u.push(`<rect x="${n}" y="${o}"
    width="${r}" height="${i}"
    fill="${f.colors.primary}" opacity="${pt}"/>`),u.push(`<text x="${n+L.TEXT_PADDING+c}" y="${l}"
    font-family="${f.typography.fontFamily}"
    font-size="${s}px"
    font-weight="${f.typography.fontWeightBold}"
    fill="${f.colors.foreground}">${M(t)}</text>`),u.join(`
`)}function lt(t,e){const n=new Map;for(const o of e)if(o.type==="bar"){let i=0;for(const r of t){const f=r.metadata[o.field];typeof f=="number"&&f>i&&(i=f)}n.set(o.field,i>0?i:1)}return n}function ct(t,e,n,o,i,r,f,u=D.DEFAULT_LABEL_WIDTH,s=0,l){var p,A,h,x,m,_,I,d,$,y,T,H,N;const c=[],a=X(r.typography.fontSizeBase),g=o+i/2+a*F.TEXT_BASELINE_ADJUSTMENT;let b=n;if(f){const E=s*L.INDENT_PER_LEVEL+(((p=t.style)==null?void 0:p.indent)??0)*L.INDENT_PER_LEVEL,w=(A=t.style)!=null&&A.bold?r.typography.fontWeightBold:r.typography.fontWeightNormal,S=(h=t.style)!=null&&h.italic?"italic":"normal",R=u-E-L.TEXT_PADDING*2,W=q(t.label,R,a,0);if(c.push(`<text x="${b+L.TEXT_PADDING+E}" y="${g}"
      font-family="${r.typography.fontFamily}"
      font-size="${a}px"
      font-weight="${w}"
      font-style="${S}"
      fill="${((x=t.style)==null?void 0:x.color)??r.colors.foreground}">${M(W)}</text>`),(m=t.style)!=null&&m.badge){const G=String(t.style.badge),P=a*.8,v=4,C=P+v*2,O=t.label.length*a*.55,V=b+L.TEXT_PADDING+E+O+6,k=G.length*P*.6+v*2,U=o+(i-C)/2;c.push(`<rect x="${V}" y="${U}" width="${k}" height="${C}"
        rx="3" fill="${r.colors.primary}" opacity="0.15"/>`),c.push(`<text x="${V+k/2}" y="${U+C/2+P*.35}"
        text-anchor="middle"
        font-family="${r.typography.fontFamily}"
        font-size="${P}px"
        font-weight="500"
        fill="${r.colors.primary}">${M(G)}</text>`)}b+=u}for(const E of e){const w=typeof E.width=="number"?E.width:D.DEFAULT_COLUMN_WIDTH,S=wt(t,E),{textX:R,anchor:W}=J(b,w,E.align);if(E.type==="bar"&&typeof t.metadata[E.field]=="number"){const G=t.metadata[E.field],P=l==null?void 0:l.get(E.field),v=((I=(_=E.options)==null?void 0:_.bar)==null?void 0:I.maxValue)??P??100,C=(($=(d=E.options)==null?void 0:d.bar)==null?void 0:$.color)??r.colors.primary,O=r.shapes.pointSize*2,z=w-L.TEXT_PADDING*2-50,k=Math.min(G/v*z,z);c.push(`<rect x="${b+L.TEXT_PADDING}" y="${o+i/2-O/2}"
        width="${Math.max(0,k)}" height="${O}"
        fill="${C}" opacity="0.7" rx="2"/>`);const U=b+w-L.TEXT_PADDING;c.push(`<text x="${U}" y="${g}"
        font-family="${r.typography.fontFamily}"
        font-size="${a}px"
        text-anchor="end"
        fill="${r.colors.foreground}">${Q(G)}</text>`)}else if(E.type==="sparkline"&&Array.isArray(t.metadata[E.field])){let G=t.metadata[E.field];Array.isArray(G[0])&&(G=G[0]);const P=((T=(y=E.options)==null?void 0:y.sparkline)==null?void 0:T.height)??16,v=((N=(H=E.options)==null?void 0:H.sparkline)==null?void 0:N.color)??r.colors.primary,C=L.TEXT_PADDING*2,O=Lt(G,b+L.TEXT_PADDING,o+i/2-P/2,w-C,P);c.push(`<path d="${O}" fill="none" stroke="${v}" stroke-width="1.5"/>`)}else c.push(`<text x="${R}" y="${g}"
        font-family="${r.typography.fontFamily}"
        font-size="${a}px"
        text-anchor="${W}"
        fill="${r.colors.foreground}">${M(S)}</text>`);b+=w}return c.join(`
`)}function wt(t,e){var o,i,r,f,u,s,l,c,a,g,b,p,A;if(e.type==="interval")return mt(t.point,t.lower,t.upper);if(e.type==="numeric"){const h=t.metadata[e.field];return typeof h=="number"?Q(h,e.options):((o=e.options)==null?void 0:o.naText)??""}if(e.type==="custom"&&((i=e.options)!=null&&i.events))return yt(t,e.options);if(e.type==="pvalue"){const h=t.metadata[e.field];return typeof h!="number"?((r=e.options)==null?void 0:r.naText)??"":Et(h,e.options)}if(e.type==="icon"){const h=t.metadata[e.field];if(h==null)return"";const x=String(h),m=(u=(f=e.options)==null?void 0:f.icon)==null?void 0:u.mapping;return m&&x in m?m[x]:x}if(e.type==="badge"){const h=t.metadata[e.field];return h!=null?String(h):""}if(e.type==="stars"){const h=t.metadata[e.field];if(typeof h!="number")return"";const x=((l=(s=e.options)==null?void 0:s.stars)==null?void 0:l.maxStars)??5,m=Math.max(0,Math.min(x,h)),_=Math.floor(m),I=x-_;return"★".repeat(_)+"☆".repeat(I)}if(e.type==="img")return((a=(c=e.options)==null?void 0:c.img)==null?void 0:a.fallback)??"[IMG]";if(e.type==="reference"){const h=t.metadata[e.field];if(h==null)return"";const x=String(h),m=((b=(g=e.options)==null?void 0:g.reference)==null?void 0:b.maxChars)??30;return x.length<=m?x:x.substring(0,m)+"..."}if(e.type==="range"){const h=(p=e.options)==null?void 0:p.range;if(!h)return"";const x=t.metadata[h.minField],m=t.metadata[h.maxField],_=h.separator??" – ",I=h.decimals,d=$=>typeof $!="number"?"":I==null?Number.isInteger($)?String($):$.toFixed(1):$.toFixed(I);return x===null&&m===null?"":x===null?d(m):m===null?d(x):`${d(x)}${_}${d(m)}`}const n=t.metadata[e.field];return n!=null?String(n):((A=e.options)==null?void 0:A.naText)??""}function Lt(t,e,n,o,i){if(t.length===0)return"";const r=Math.min(...t),u=Math.max(...t)-r||1;return`M${t.map((l,c)=>{const a=e+c/(t.length-1)*o,g=n+i-(l-r)/u*i;return`${a.toFixed(1)},${g.toFixed(1)}`}).join("L")}`}const ft=6;function tt(t,e,n){const o=t.metadata[e];return o!=null&&typeof o=="number"&&!Number.isNaN(o)?o:n}function Mt(t,e){return e<=1?0:-((e-1)*ft)/2+t*ft}function St(t,e,n,o,i,r=[],f){var I;let u;r.length===0?u=[{point:t.point,lower:t.lower,upper:t.upper,color:null,shape:null,opacity:null}]:u=r.map(d=>({point:tt(t,d.pointCol,t.point),lower:tt(t,d.lowerCol,t.lower),upper:tt(t,d.upperCol,t.upper),color:d.color??null,shape:d.shape??null,opacity:d.opacity??null}));const s=u.filter(d=>d.point!=null&&!Number.isNaN(d.point)&&d.lower!=null&&!Number.isNaN(d.lower)&&d.upper!=null&&!Number.isNaN(d.upper));if(s.length===0)return"";const l=o.shapes.pointSize,c=o.shapes.lineWidth,a=o.colors.intervalLine,g=L.WHISKER_HALF_HEIGHT,b=((I=t.style)==null?void 0:I.type)==="summary",A=o.shapes.summaryHeight/2;function h(d){var y;if(d&&((y=t.markerStyle)==null?void 0:y.size)!=null)return l*t.markerStyle.size;const $=f?t.metadata[f]:void 0;if($){const T=.5+Math.sqrt($/100)*1.5;return Math.min(Math.max(l*T,3),l*2.5)}return l}function x(d,$){const y=$===0,T=t.markerStyle;let H;y&&(T!=null&&T.color)?H=T.color:d.color?H=d.color:H=o.colors.interval??o.colors.primary??"#2563eb";let N;y&&(T!=null&&T.shape)?N=T.shape:d.shape?N=d.shape:N="square";let E;return y&&(T==null?void 0:T.opacity)!=null?E=T.opacity:d.opacity!=null?E=d.opacity:E=1,{color:H,shape:N,opacity:E}}function m(d,$,y,T){const{color:H,shape:N,opacity:E}=T,w=E<1?` fill-opacity="${E}"`:"";switch(N){case"circle":return`<circle cx="${d}" cy="${$}" r="${y}" fill="${H}"${w}/>`;case"diamond":return`<polygon points="${[`${d},${$-y}`,`${d+y},${$}`,`${d},${$+y}`,`${d-y},${$}`].join(" ")}" fill="${H}"${w}/>`;case"triangle":return`<polygon points="${[`${d},${$-y}`,`${d+y},${$+y}`,`${d-y},${$+y}`].join(" ")}" fill="${H}"${w}/>`;default:return`<rect x="${d-y}" y="${$-y}" width="${y*2}" height="${y*2}" fill="${H}"${w}/>`}}const _=[];return s.forEach((d,$)=>{const y=e+Mt($,s.length),T=n(d.lower),H=n(d.upper),N=n(d.point),E=x(d,$),w=h($===0),S=a;if(b){const R=E.opacity<1?` fill-opacity="${E.opacity}"`:"",W=[`${T},${y}`,`${N},${y-A}`,`${H},${y}`,`${N},${y+A}`].join(" ");_.push(`
        <g class="interval effect-${$} summary">
          <polygon points="${W}"
            fill="${E.color}"${R} stroke="${o.colors.summaryBorder}" stroke-width="1"/>
        </g>`)}else _.push(`
        <g class="interval effect-${$}">
          <line x1="${T}" x2="${H}" y1="${y}" y2="${y}"
            stroke="${S}" stroke-width="${c}"/>
          <line x1="${T}" x2="${T}" y1="${y-g}" y2="${y+g}"
            stroke="${S}" stroke-width="${c}"/>
          <line x1="${H}" x2="${H}" y1="${y-g}" y2="${y+g}"
            stroke="${S}" stroke-width="${c}"/>
          ${m(N,y,w,E)}
        </g>`)}),_.join("")}function Ft(t,e,n,o,i,r,f,u){const l=u.shapes.summaryHeight/2,c=i(e),a=i(t),g=i(n),b=r+Math.max(0,Math.min(f,c)),p=r+Math.max(0,Math.min(f,a)),A=r+Math.max(0,Math.min(f,g));return`<polygon points="${[`${b},${o}`,`${p},${o-l}`,`${A},${o}`,`${p},${o+l}`].join(" ")}"
    fill="${u.colors.summaryFill}"
    stroke="${u.colors.summaryBorder}"
    stroke-width="1"/>`}function Gt(t,e,n,o,i){const r=[],f=typeof n.axis.tickCount=="number"?n.axis.tickCount:L.DEFAULT_TICK_COUNT,u=Array.isArray(n.axis.tickValues)?n.axis.tickValues:t.ticks(f),s=X(n.typography.fontSizeSm);r.push(`<line x1="${i}" x2="${i+e.forestWidth}"
    y1="0" y2="0" stroke="${n.colors.border}" stroke-width="1"/>`);for(const l of u){const c=i+t(l);r.push(`<line x1="${c}" x2="${c}" y1="0" y2="4"
      stroke="${n.colors.border}" stroke-width="1"/>`),r.push(`<text x="${c}" y="16" text-anchor="middle"
      font-family="${n.typography.fontFamily}"
      font-size="${s}px"
      fill="${n.colors.secondary}">${bt(l)}</text>`)}return o&&r.push(`<text x="${i+e.forestWidth/2}" y="28"
      text-anchor="middle"
      font-family="${n.typography.fontFamily}"
      font-size="${s}px"
      font-weight="500"
      fill="${n.colors.secondary}">${M(o)}</text>`),`<g transform="translate(0, ${e.mainY+e.headerHeight+e.plotHeight})">${r.join(`
`)}</g>`}function ut(t,e,n,o,i,r){let u=`<line x1="${t}" x2="${t}" y1="${e}" y2="${n}"
    stroke="${i}" stroke-width="1" stroke-dasharray="${o==="dashed"?"6,4":o==="dotted"?"2,2":"none"}"/>`;return r&&(u+=`<text x="${t}" y="${e-4}" text-anchor="middle"
      font-size="10px" fill="${i}">${M(r)}</text>`),u}class B extends Error{constructor(e){super(`SVG Generator: ${e}`),this.name="SVGGeneratorError"}}function Wt(t){if(!t||typeof t!="object")throw new B("Invalid spec: expected an object");const e=t;if(!e.data||typeof e.data!="object")throw new B("Invalid spec: missing or invalid 'data' property");const n=e.data;if(!Array.isArray(n.rows))throw new B("Invalid spec: 'data.rows' must be an array");if(!e.theme||typeof e.theme!="object")throw new B("Invalid spec: missing or invalid 'theme' property");const o=e.theme;if(!o.colors||typeof o.colors!="object")throw new B("Invalid spec: missing or invalid 'theme.colors'");if(!o.typography||typeof o.typography!="object")throw new B("Invalid spec: missing or invalid 'theme.typography'");if(!o.spacing||typeof o.spacing!="object")throw new B("Invalid spec: missing or invalid 'theme.spacing'")}function Pt(t,e={}){Wt(t);const n=t.theme,o=$t(t,e),i=n.spacing.padding,r=Array.isArray(t.columns)?t.columns:[],f=Y(r,"left"),u=Y(r,"right"),s=j(r,"left"),l=j(r,"right"),c=D.DEFAULT_LABEL_WIDTH+s.reduce(($,y)=>$+(typeof y.width=="number"?y.width:D.DEFAULT_COLUMN_WIDTH),0),a=i+c,g=Ht(t,o.forestWidth),b=a+o.forestWidth,p=[];p.push(`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg"
  width="${o.totalWidth}" height="${o.totalHeight}"
  viewBox="0 0 ${o.totalWidth} ${o.totalHeight}">`);const A=e.backgroundColor??n.colors.background;p.push(`<rect width="100%" height="100%" fill="${A}"/>`),p.push(At(t,o,n));const h=o.mainY;p.push(st(f,s,i,h,o.headerHeight,n,t.data.labelHeader??"Study",D.DEFAULT_LABEL_WIDTH)),l.length>0&&p.push(st(u,l,b,h,o.headerHeight,n)),p.push(`<line x1="${i}" x2="${o.totalWidth-i}"
    y1="${h+o.headerHeight}" y2="${h+o.headerHeight}"
    stroke="${n.colors.border}" stroke-width="1"/>`);const x=rt(t);if(t.data.includeForest&&o.forestWidth>0){const $=o.mainY+o.headerHeight,y=a+g(t.data.nullValue);p.push(ut(y,$,$+o.plotHeight,"dashed",n.colors.muted));const T=Array.isArray(t.annotations)?t.annotations:[];for(const H of T)if(H.type==="reference_line"){const N=a+g(H.x);p.push(ut(N,$,$+o.plotHeight,H.style,H.color??n.colors.accent,H.label))}if(x.forEach((H,N)=>{if(H.type==="data"){const E=$+N*o.rowHeight+o.rowHeight/2;p.push(St(H.row,E,w=>a+g(w),n,t.data.nullValue,t.data.effects,t.data.weightCol))}}),t.data.overall&&o.showOverallSummary&&typeof t.data.overall.point=="number"&&!Number.isNaN(t.data.overall.point)&&typeof t.data.overall.lower=="number"&&!Number.isNaN(t.data.overall.lower)&&typeof t.data.overall.upper=="number"&&!Number.isNaN(t.data.overall.upper)){const H=$+o.summaryYPosition;p.push(Ft(t.data.overall.point,t.data.overall.lower,t.data.overall.upper,H,g,a,o.forestWidth,n))}p.push(Gt(g,o,n,t.data.axisLabel,a))}const m=o.mainY+o.headerHeight,_=t.data.rows,I=lt(_,s),d=lt(_,l);return x.forEach(($,y)=>{const T=m+y*o.rowHeight;if($.type==="group_header")p.push(Dt($.label,$.depth,i,T,o.rowHeight,o.totalWidth-i*2,n));else{const H=$.row,N=$.depth,E=gt(N),w=y%2===1?ht:0,S=Math.max(E,w);S>0&&p.push(`<rect x="${i}" y="${T}"
          width="${o.totalWidth-i*2}" height="${o.rowHeight}"
          fill="${n.colors.muted}" opacity="${S}"/>`),p.push(ct(H,s,i,T,o.rowHeight,n,!0,D.DEFAULT_LABEL_WIDTH,N,I)),l.length>0&&p.push(ct(H,l,b,T,o.rowHeight,n,!1,0,N,d))}p.push(`<line x1="${i}" x2="${o.totalWidth-i}"
      y1="${T+o.rowHeight}" y2="${T+o.rowHeight}"
      stroke="${n.colors.border}" stroke-width="1" opacity="0.5"/>`)}),p.push(Nt(t,o,n)),p.push("</svg>"),p.join(`
`)}function Ct(t,e){const n=JSON.parse(t);return Pt(n,e)}globalThis.generateSVG=Ct})();
