(function(){"use strict";const Zt=[1,5,2,2.5,4,3],ct=[.001,.002,.005,.01,.02,.05,.1,.15,.2,.25,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.75,2,2.5,3,4,5,6,7,8,10,12,15,20,25,30,40,50,75,100,150,200,300,500,750,1e3];function _t(t,n){return n?mn(t):yn(t)}function mn(t){if(t[0]<=0||t[1]<=0)return[.1,10];if(t[0]>=t[1])return t;let n=ct[0];for(const e of ct)if(e<=t[0])n=e;else break;t[0]<ct[0]&&(n=Math.pow(10,Math.floor(Math.log10(t[0]))));let o=ct[ct.length-1];for(let e=ct.length-1;e>=0&&ct[e]>=t[1];e--)o=ct[e];return t[1]>ct[ct.length-1]&&(o=Math.pow(10,Math.ceil(Math.log10(t[1])))),[n,o]}function yn(t){const n=t[1]-t[0];if(n===0)return t;if(n<0)return[t[1],t[0]];const o=Math.pow(10,Math.floor(Math.log10(n)));let e=o,i=1/0;for(const c of Zt)for(const u of[.1,1,10]){const s=c*o*u;if(s<=0)continue;const a=Math.floor(t[0]/s)*s,h=(Math.ceil(t[1]/s)*s-a)/n-1;h>=0&&h<i&&(i=h,e=s)}const r=Math.floor(t[0]/e)*e,l=Math.ceil(t[1]/e)*e;return[Math.round(r*1e10)/1e10,Math.round(l*1e10)/1e10]}function dt(t,n,o,e,i=!1){if(t&&o in t){const r=t[o];if(typeof r=="number"&&Number.isFinite(r)&&(!i||r>0))return r}return o===e&&n!=null&&Number.isFinite(n)&&(!i||n>0)?n:null}const mt=12;function $n(t){const{rows:n,config:o,scale:e,nullValue:i,forestWidth:r,pointSize:l,effects:c=[],pointCol:u,lowerCol:s,upperCol:a}=t,f=xn(n,o,e,i,c,u,s,a),d=bn(f,o,e,r,l),h=Qt(f,o,e,i);return{axisLimits:f,plotRegion:d,ticks:h}}function xn(t,n,o,e,i=[],r,l,c){const u=n.rangeMin!=null,s=n.rangeMax!=null;if(u&&s)return[n.rangeMin,n.rangeMax];const a=[],f=o==="log",d=r||"point";for(const I of t){const $=dt(I.metadata,void 0,d,"point",f);$!=null&&a.push($);for(const L of i){const S=dt(I.metadata,void 0,L.pointCol,"point",f);S!=null&&a.push(S)}}if(a.length===0)return o==="log"?[.1,10]:[-1,1];let h=Math.min(...a),g=Math.max(...a);(n.includeNull??!0)&&(h=Math.min(h,e),g=Math.max(g,e));const A=h,w=g;let x;if(f){const I=Math.max(h,.001),$=Math.max(g,.001);x=Math.log($)-Math.log(I)}else x=g-h;if(x===0||!Number.isFinite(x)){const I=a[0];if(f)return _t([I/2,I*2],!0);{const $=Math.max(1,Math.abs(I)*.1);return _t([I-$,I+$],!1)}}const[C,b]=_t([h,g],f),_=n.ciClipFactor??2;let p=C,y=b;const m=[],T=[],E=l||"lower",W=c||"upper";for(const I of t){const $=dt(I.metadata,void 0,E,"lower",f);$!=null&&m.push($);const L=dt(I.metadata,void 0,W,"upper",f);L!=null&&T.push(L);for(const S of i){const G=dt(I.metadata,void 0,S.lowerCol,"lower",f);G!=null&&m.push(G);const B=dt(I.metadata,void 0,S.upperCol,"upper",f);B!=null&&T.push(B)}}let F,H;if(f)F=p/_,H=y*_;else{const I=y-p;F=p-I*_,H=y+I*_}let V=!1,z=!1;for(const I of m)I>=F?p=Math.min(p,I):V=!0;for(const I of T)I<=H?y=Math.max(y,I):z=!0;if(V&&(p=Math.min(p,F)),z&&(y=Math.max(y,H)),n.symmetric===!0&&!u&&!s)if(o==="log"){const I=Math.log(e),$=Math.max(Math.abs(Math.log(Math.max(A,.001))-I),Math.abs(Math.log(w)-I));p=Math.exp(I-$),y=Math.exp(I+$)}else{const I=Math.max(Math.abs(A-e),Math.abs(w-e));p=e-I,y=e+I}let k=u?n.rangeMin:p,D=s?n.rangeMax:y;return _t([k,D],o==="log")}function bn(t,n,o,e,i){if(!(n.markerMargin??!0)||e<=0)return t;const l=e-2*mt;if(l<=0)return t;if(o==="log"){const s=Math.log(Math.max(t[0],.001)),a=Math.log(Math.max(t[1],.001)),f=a-s,d=i/2*(f/l),h=Math.min(d,.5);return[Math.exp(s-h),Math.exp(a+h)]}const c=t[1]-t[0],u=i/2*(c/l);return[t[0]-u,t[1]+u]}function Qt(t,n,o,e){const[i,r]=t,l=e>=i&&e<=r,c=(n.nullTick??!0)&&l;if(n.tickValues&&n.tickValues.length>0){let a=n.tickValues.filter(f=>f>=i&&f<=r);return c&&!a.includes(e)&&(a=[...a,e].sort((f,d)=>f-d)),a}const u=n.tickCount??5;let s=o==="log"?Nn(t,u):Mn(t,u);return c&&!s.includes(e)&&(s=[...s,e].sort((a,f)=>a-f)),s}function Mn(t,n){const[o,e]=t,i=e-o;if(i===0)return[o];const r=i/Math.max(n-1,1),l=Math.pow(10,Math.floor(Math.log10(r)));let c=l,u=1/0;for(const f of Zt){const d=f*l,h=Math.floor(i/d)+1,g=Math.abs(h-n);g<u&&(u=g,c=d);const N=f*l/10;if(N>0){const A=Math.floor(i/N)+1,w=Math.abs(A-n);w<u&&(u=w,c=N)}}const s=Math.ceil(o/c)*c,a=[];for(let f=s;f<=e+c*.001;f+=c){const d=Math.round(f*1e10)/1e10;d>=o&&d<=e&&a.push(d)}return a.length<2&&(a.includes(o)||a.unshift(o),a.includes(e)||a.push(e)),a}function Nn(t,n){const[o,e]=t,r=[.01,.02,.05,.1,.15,.2,.25,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.75,2,2.5,3,4,5,6,7,8,10,12,15,20,25,30,40,50,75,100,150,200,500,1e3].filter(u=>u>=o&&u<=e);if(r.length<=n)return r;const l=[1,.1,10,100,.5,2,5,.2,.25,1.5,3,4,20,50],c=[];for(const u of l)r.includes(u)&&c.length<n&&c.push(u);if(c.length<n){const u=r.filter(a=>!c.includes(a)),s=Math.max(1,Math.floor(u.length/(n-c.length)));for(let a=0;a<u.length&&c.length<n;a+=s)c.push(u[a])}return c.sort((u,s)=>u-s)}function Tn(t){var e,i;const n=((e=t==null?void 0:t.shapes)==null?void 0:e.lineWidth)??1.5,o=((i=t==null?void 0:t.colors)==null?void 0:i.intervalLine)??"#475569";return{width:Math.max(4,Math.round(n*3)),height:Math.max(6,Math.round(n*4)),color:o,opacity:1}}function Jt(t,n,o,e){const{width:i,height:r}=e,l=r/2;return t==="left"?`M ${n} ${o} L ${n+i} ${o-l} L ${n+i} ${o+l} Z`:`M ${n} ${o} L ${n-i} ${o-l} L ${n-i} ${o+l} Z`}const Lt={RENDERING_BUFFER:4},bt={FONT_SCALE:.8,PADDING:4,GAP:6},yt={DEFAULT_COLUMN_WIDTH:100,AXIS_HEIGHT:32,AXIS_LABEL_HEIGHT:32,BOTTOM_MARGIN:16,MIN_FOREST_WIDTH:200,DEFAULT_WIDTH:800},ut={TITLE_HEIGHT:28,SUBTITLE_HEIGHT:20,CAPTION_HEIGHT:16,FOOTNOTE_HEIGHT:14,DEFAULT_FONT_SIZE:14,REM_BASE:16,PT_TO_PX:96/72},Y={INDENT_PER_LEVEL:12,TEXT_PADDING:10,DEFAULT_TICK_COUNT:5},En={OVERALL_ROW_HEIGHT_MULTIPLIER:1.5},Tt={MIN:60,MAX:600,LABEL_MAX:400,VISUAL_MIN:{sparkline:92,bar:100,stars:84,range:84,badge:74,forest:200,viz_bar:150,viz_boxplot:150,viz_violin:150}},Wt={CHEVRON_WIDTH:12,GAP:6,SAFETY_MARGIN:8},tn={SPACING:6},Rt={EDGE_THRESHOLD:35,MIN_TICK_SPACING:50},wn={success:"#16a34a",warning:"#d97706",error:"#dc2626",info:"#2563eb"};function In(t,n){return n<=1?0:-((n-1)*tn.SPACING)/2+t*tn.SPACING}function Ft(t,n){const o=t.split(".");return o[0]=o[0].replace(/\B(?=(\d{3})+(?!\d))/g,n),o.join(".")}function Bt(t){const n=Math.abs(t),o=t<0?"-":"";if(n>=1e12)throw new Error(`Cannot abbreviate value >= 1 trillion: ${t}`);if(n>=1e9){const e=n/1e9;return o+Vt(e)+"B"}if(n>=1e6){const e=n/1e6;return o+Vt(e)+"M"}if(n>=1e3){const e=n/1e3;return o+Vt(e)+"K"}return o+Math.round(n).toString()}function Vt(t){const n=Math.round(t*10)/10;return n===Math.floor(n)?n.toFixed(0):n.toFixed(1)}const An={0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹","-":"⁻","+":"⁺"};function Cn(t){return t.split("").map(n=>An[n]??n).join("")}function Et(t,n){var c,u,s,a,f;if(t==null||Number.isNaN(t))return(n==null?void 0:n.naText)??"";if(n!=null&&n.percent){const{decimals:d,digits:h,multiply:g=!0,symbol:N=!0}=n.percent,A=g?t*100:t,w=h!=null?A.toPrecision(h):A.toFixed(d??1);return N?`${w}%`:w}if(((c=n==null?void 0:n.numeric)==null?void 0:c.abbreviate)&&Math.abs(t)>=1e3)return Bt(t);const e=(u=n==null?void 0:n.numeric)==null?void 0:u.digits;if(e!=null){const d=t.toPrecision(e),h=(s=n==null?void 0:n.numeric)==null?void 0:s.thousandsSep;return h&&typeof h=="string"?Ft(d,h):d}const i=(a=n==null?void 0:n.numeric)==null?void 0:a.decimals,r=(f=n==null?void 0:n.numeric)==null?void 0:f.thousandsSep;let l;return i!==void 0?l=t.toFixed(i):Number.isInteger(t)||Math.abs(t-Math.round(t))<1e-4?l=Math.round(t).toString():l=t.toFixed(2),r&&typeof r=="string"&&(l=Ft(l,r)),l}function nn(t,n){const{eventsField:o,nField:e,separator:i="/",showPct:r=!1,thousandsSep:l,abbreviate:c}=n.events,u=t.metadata[o],s=t.metadata[e];if(u==null||s===void 0||s===null)return n.naText??"";const a=Number(u),f=Number(s);let d,h;c&&(a>=1e3||f>=1e3)?(d=a>=1e3?Bt(a):String(a),h=f>=1e3?Bt(f):String(f)):(d=String(a),h=String(f),l&&typeof l=="string"&&(d=Ft(d,l),h=Ft(h,l)));let g=`${d}${i}${h}`;if(r&&f>0){const N=(a/f*100).toFixed(1);g+=` (${N}%)`}return g}function on(t,n,o,e){var c,u,s;if(t==null||Number.isNaN(t))return"";const i=((c=e==null?void 0:e.interval)==null?void 0:c.decimals)??2,r=((u=e==null?void 0:e.interval)==null?void 0:u.sep)??" ",l=(s=e==null?void 0:e.interval)==null?void 0:s.impreciseThreshold;return n==null||o===void 0||o===null||Number.isNaN(n)||Number.isNaN(o)?t.toFixed(i):l!=null&&n>0&&o/n>l?"—":`${t.toFixed(i)}${r}(${n.toFixed(i)}, ${o.toFixed(i)})`}function en(t,n){if(t==null||Number.isNaN(t))return(n==null?void 0:n.naText)??"";const o=n==null?void 0:n.pvalue,e=(o==null?void 0:o.digits)??2,i=(o==null?void 0:o.expThreshold)??.001,r=(o==null?void 0:o.abbrevThreshold)??null,l=(o==null?void 0:o.format)??"auto",c=(o==null?void 0:o.stars)??!1,u=(o==null?void 0:o.thresholds)??[.05,.01,.001];let s="";if(c&&(t<u[2]?s="***":t<u[1]?s="**":t<u[0]&&(s="*")),r!==null&&t<r)return`<${r}${s}`;if(l==="scientific"||l==="auto"&&t<i){const f=Math.floor(Math.log10(t));return`${(t/Math.pow(10,f)).toPrecision(e)}×10${Cn(f.toString())}${s}`}let a;return t>=.1?a=t.toFixed(e):t>=.01?a=t.toFixed(e+1):a=t.toFixed(e+2),`${a}${s}`}function _n(t,n){var r,l,c,u;const{type:o,field:e,options:i}=n;switch(o){case"interval":{const s=(r=i==null?void 0:i.interval)!=null&&r.point?t.metadata[i.interval.point]:t.point,a=(l=i==null?void 0:i.interval)!=null&&l.lower?t.metadata[i.interval.lower]:t.lower,f=(c=i==null?void 0:i.interval)!=null&&c.upper?t.metadata[i.interval.upper]:t.upper;return on(s,a,f,i)}case"custom":return i!=null&&i.events?nn(t,i):String(t.metadata[e]??"");case"pvalue":return en(t.metadata[e],i);case"numeric":return Et(t.metadata[e],i);case"percent":return Et(t.metadata[e],i);case"sparkline":case"icon":case"stars":case"img":case"range":return"";case"badge":{const s=t.metadata[e];return s==null?"":`  ${String(s)}  `}case"bar":{if(((u=i==null?void 0:i.bar)==null?void 0:u.showLabel)===!1)return"";const s=t.metadata[e];return s==null?"":s>=100?s.toFixed(0):s>=10?s.toFixed(1):s.toFixed(2)}case"text":default:return String(t.metadata[e]??"")}}function lt(t,n){const o="⁰¹²³⁴⁵⁶⁷⁸⁹⁺⁻",e="ilI1.,;:|!()[]{}' -",i="mwMW@%",r="ABCDEFGHJKLNOPQRSTUVXYZ";let l=0;for(const c of t)o.includes(c)?l+=n*.3:e.includes(c)?l+=n*.35:"×−".includes(c)?l+=n*.5:i.includes(c)?l+=n*.85:c>="0"&&c<="9"?l+=n*.6:r.includes(c)?l+=n*.68:l+=n*.55;return l}function Wn(t,n,o,e=400){if(typeof document>"u")return null;const r=document.createElement("canvas").getContext("2d");return r?(r.font=`${e} ${n} ${o}`,r.measureText(t).width):null}function Fn(t){if(!t||t.length===0)return{min:NaN,q1:NaN,median:NaN,q3:NaN,max:NaN};const n=t.filter(i=>i!=null&&!Number.isNaN(i)).sort((i,r)=>i-r);if(n.length===0)return{min:NaN,q1:NaN,median:NaN,q3:NaN,max:NaN};const o=n.length,e=i=>{if(o===1)return n[0];const r=(o-1)*i,l=Math.floor(r),c=Math.ceil(r);return l===c?n[l]:n[l]+(r-l)*(n[c]-n[l])};return{min:n[0],q1:e(.25),median:e(.5),q3:e(.75),max:n[o-1]}}function kn(t,n,o){if(!t||t.length===0||Number.isNaN(n)||Number.isNaN(o))return[];const e=o-n,i=n-1.5*e,r=o+1.5*e;return t.filter(l=>l!=null&&!Number.isNaN(l)&&(l<i||l>r))}function rn(t){const n=Fn(t),o=kn(t,n.q1,n.q3);return{...n,outliers:o}}function Dn(t){if(!t||t.length<2)return 1;const n=t.filter(h=>h!=null&&!Number.isNaN(h)).sort((h,g)=>h-g);if(n.length<2)return 1;const o=n.length,e=n.reduce((h,g)=>h+g,0)/o,i=n.reduce((h,g)=>h+(g-e)**2,0)/(o-1),r=Math.sqrt(i),l=Math.floor((o-1)*.25),c=Math.floor((o-1)*.75),u=n[l],a=n[c]-u,d=.9*Math.min(r,a/1.34)*Math.pow(o,-.2);return Math.max(d,.001)}function Hn(t){return Math.exp(-.5*t*t)/Math.sqrt(2*Math.PI)}function Sn(t,n,o=128){if(!t||t.length===0)return{x:[],y:[]};const e=t.filter(h=>h!=null&&!Number.isNaN(h));if(e.length===0)return{x:[],y:[]};const i=n??Dn(e),r=Math.min(...e),l=Math.max(...e),c=3*i,u=r-c,a=(l+c-u)/(o-1),f=[],d=[];for(let h=0;h<o;h++){const g=u+h*a;f.push(g);let N=0;for(const A of e)N+=Hn((g-A)/i);N/=e.length*i,d.push(N)}return{x:f,y:d}}function vn(t,n){if(t.y.length===0)return t;const o=Math.max(...t.y);if(o===0)return t;const e=t.y.map(i=>i/o*n);return{x:t.x,y:e}}function kt(t,n,o,e=400){const i=Wn(t,`${n}px`,o,e);if(i!==null)return i;const r=1+Math.max(0,(e-400)/100)*.02;return lt(t,n)*r}function Gn(t,n){var s,a;const o=new Map,e=ot(t.theme.typography.fontSizeBase),i=t.theme.typography.headerFontScale??1.05,r=Math.round(e*i*100)/100,l=t.data.rows,c=(t.theme.spacing.cellPaddingX??10)*2,u=(t.theme.spacing.groupPadding??8)*2;for(const f of n){if(f.width!=="auto"&&f.width!==null&&f.width!==void 0)continue;let d=0;f.header&&(d=Math.max(d,lt(f.header,r)));for(const N of l){if(((s=N.style)==null?void 0:s.type)==="header"||((a=N.style)==null?void 0:a.type)==="spacer")continue;const A=_n(N,f);A&&(d=Math.max(d,lt(A,e)))}const h=Tt.VISUAL_MIN[f.type]??Tt.MIN,g=Math.ceil(d+c+Lt.RENDERING_BUFFER);o.set(f.id,Math.min(Tt.MAX,Math.max(h,g)))}return Pn(t.columns,o,r,u,Lt.RENDERING_BUFFER),o}function Pn(t,n,o,e,i){function r(u){return u.isGroup?u.columns.flatMap(r):[u]}function l(u){const s=n.get(u.id);return s!==void 0?s:typeof u.width=="number"?u.width:Tt.MIN}function c(u){if(u.isGroup){for(const s of u.columns)c(s);if(u.header){const s=lt(u.header,o)+e+i,a=r(u),f=a.reduce((d,h)=>d+l(h),0);if(s>f&&a.length>0){const d=Math.ceil((s-f)/a.length);for(const h of a)n.set(h.id,l(h)+d)}}}}for(const u of t)c(u)}function an(t,n,o){let e=o.filter(r=>r.groupId===t).length;const i=n.filter(r=>r.parentId===t);for(const r of i)e+=an(r.id,n,o);return e}function sn(t){var u,s;const n=ot(t.theme.typography.fontSizeBase),o=(t.theme.spacing.cellPaddingX??10)*2;let e=0;const i=new Map,r=Array.isArray(t.data.groups)?t.data.groups:[];for(const a of r)i.set(a.id,a.depth);const l=a=>a?(i.get(a)??0)+1:0;t.data.labelHeader&&(e=Math.max(e,lt(t.data.labelHeader,n)));for(const a of t.data.rows)if(a.label){const f=l(a.groupId),d=((u=a.style)==null?void 0:u.indent)??0,g=(f+d)*Y.INDENT_PER_LEVEL;let N=lt(a.label,n)+g;if((s=a.style)!=null&&s.badge){const A=String(a.style.badge),w=n*bt.FONT_SCALE,C=lt(A,w)+bt.PADDING*2;N+=bt.GAP+C}e=Math.max(e,N)}for(const a of r)if(a.label){const f=a.depth*Y.INDENT_PER_LEVEL,d=lt(a.label,n),g=`(${an(a.id,r,t.data.rows)})`,N=n*.75,A=lt(g,N),w=f+Wt.CHEVRON_WIDTH+Wt.GAP+d+Wt.GAP+A+Wt.SAFETY_MARGIN;e=Math.max(e,w)}const c=Math.ceil(e+o+Lt.RENDERING_BUFFER);return Math.min(Tt.LABEL_MAX,Math.max(Tt.MIN,c))}function zt(t,n){const o=n.get(t.id);return o!==void 0?o:typeof t.width=="number"?t.width:yt.DEFAULT_COLUMN_WIDTH}function Ln(t,n,o=0){var st,v,j,nt,q;const e=t.theme,i=e.spacing.rowHeight,r=e.spacing.padding,l=e.spacing.columnGap??8,c=Array.isArray(t.columns)?t.columns:[],u=cn(c,"left"),s=cn(c,"right"),a=Dt(u)||Dt(s)||Dt(c),f=a?2:1,d=e.spacing.cellPaddingY??4,N=(e.spacing.headerHeight/f+(a?d*2:0))*f,A=!!((st=t.labels)!=null&&st.title),w=!!((v=t.labels)!=null&&v.subtitle),x=!!((j=t.labels)!=null&&j.caption),C=!!((nt=t.labels)!=null&&nt.footnote),b=A?ut.TITLE_HEIGHT:0,_=w?ut.SUBTITLE_HEIGHT:0,p=b+_+(A||w?r:0),y=x?ut.CAPTION_HEIGHT:0,m=C?ut.FOOTNOTE_HEIGHT:0,T=y+m+(x||C?r:0),E=ln(t),W=!!t.data.overall;let F=0;for(const X of E){const J=X.type==="data"&&((q=X.row.style)==null?void 0:q.type)==="spacer";F+=J?i/2:i}W&&(F+=i*En.OVERALL_ROW_HEIGHT_MULTIPLIER);const H=qt(c,"left"),V=qt(c,"right"),z=Ut(c).filter(X=>X.position===void 0),M=[...H,...V,...z];let k,D;if(n.columnWidths){k=new Map;for(const[X,J]of Object.entries(n.columnWidths))X!=="__label__"&&k.set(X,J);D=n.columnWidths.__label__??sn(t)}else k=Gn(t,M),D=sn(t);const I=D+H.reduce((X,J)=>X+zt(J,k),0),$=V.reduce((X,J)=>X+zt(J,k),0),L=z.filter(X=>X.type!=="forest").reduce((X,J)=>X+zt(J,k),0),S=n.width??yt.DEFAULT_WIDTH,B=M.some(X=>X.type==="forest")||t.data.includeForest,O=I+$+L;let U;if(!B)U=0;else if(typeof n.forestWidth=="number")U=n.forestWidth;else if(typeof t.layout.plotWidth=="number")U=t.layout.plotWidth;else{const X=S-O-l*2-r*2;U=Math.max(X,yt.MIN_FOREST_WIDTH)}const tt=r*2+O+U+l*2,rt=Math.max(n.width??S,tt);B&&rt>tt&&typeof n.forestWidth!="number"&&typeof t.layout.plotWidth!="number"&&(U=rt-O-r*2-l*2);const Q=(e.spacing.axisGap??12)+yt.AXIS_HEIGHT+yt.AXIS_LABEL_HEIGHT,$t=p+r+N+F+Q+T+yt.BOTTOM_MARGIN;return{totalWidth:rt,totalHeight:n.height??$t,tableWidth:I+$,forestWidth:U,headerHeight:N,rowHeight:i,plotHeight:F,axisHeight:yt.AXIS_HEIGHT,nullValue:o,summaryYPosition:F-i,showOverallSummary:W,headerTextHeight:p,footerTextHeight:T,titleY:r+ut.TITLE_HEIGHT-4,subtitleY:r+b+ut.SUBTITLE_HEIGHT-4,mainY:p+r,footerY:p+r+N+F+Q+8,autoWidths:k,labelWidth:D}}function ln(t){var f;const n=t.data.rows,o=Array.isArray(t.data.groups)?t.data.groups:[];if(o.length===0)return n.map(d=>({type:"data",row:d,depth:0}));const e=new Map;for(const d of o)e.set(d.id,d);const i=new Map;for(const d of n){const h=d.groupId??null;i.has(h)||i.set(h,[]),i.get(h).push(d)}const r=new Set;for(const d of i.keys()){if(!d)continue;let h=d;for(;h;)r.add(h),h=(f=e.get(h))==null?void 0:f.parentId}function l(d){return o.filter(h=>(h.parentId??null)===d&&r.has(h.id))}function c(d){if(!d)return 0;const h=e.get(d);return h?h.depth+1:0}function u(d){var g;let h=((g=i.get(d))==null?void 0:g.length)??0;for(const N of l(d))h+=u(N.id);return h}const s=[];function a(d){if(d){const g=e.get(d);if(!g)return;const N=u(d);s.push({type:"group_header",groupId:g.id,label:g.label,depth:g.depth,rowCount:N})}for(const g of l(d))a(g.id);const h=i.get(d)??[];for(const g of h)s.push({type:"data",row:g,depth:c(g.groupId)})}return a(null),s}function Xt(t){const n=[];for(const o of t)o.isGroup?n.push(...Xt(o.columns)):n.push(o);return n}function Ut(t){const n=[];for(const o of t)o.isGroup?n.push(...Xt(o.columns)):n.push(o);return n}function qt(t,n){if(n===void 0)return Ut(t);const o=[];for(const e of t)e.position===n&&(e.isGroup?o.push(...Xt(e.columns)):o.push(e));return o}function cn(t,n){return t.filter(o=>o.position===n)}function Dt(t){return t.some(n=>n.isGroup)}function ot(t){let n;return t.endsWith("rem")?n=parseFloat(t)*ut.REM_BASE:t.endsWith("px")?n=parseFloat(t):t.endsWith("pt")?n=parseFloat(t)*ut.PT_TO_PX:n=ut.DEFAULT_FONT_SIZE,Math.round(n*100)/100}function Ht(t,n,o){return o==="right"?{textX:t+n-Y.TEXT_PADDING,anchor:"end"}:o==="center"?{textX:t+n/2,anchor:"middle"}:{textX:t+Y.TEXT_PADDING,anchor:"start"}}function Z(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function un(t,n,o,e=0){const i=n-e*2;if(lt(t,o)<=i)return t;const l="…",c=o*.55;let u=0,s=t.length;for(;u<s;){const a=Math.ceil((u+s)/2),f=t.slice(0,a);lt(f,o)+c<=i?u=a:s=a-1}return u===0?l:t.slice(0,u)+l}function Rn(t){return Math.abs(t)<.01?"0":Math.abs(t)>=100?t.toFixed(0):Math.abs(t)>=10?t.toFixed(1):t.toFixed(2)}function wt(t,n){const[o,e]=t,[i,r]=n,l=(r-i)/(e-o),c=u=>i+(u-o)*l;return c.domain=()=>t,c.range=()=>n,c.ticks=u=>{const s=(e-o)/(u-1),a=[];for(let f=0;f<u;f++)a.push(o+s*f);return a},c}function It(t,n){const[o,e]=t.map(a=>Math.max(a,.001)),[i,r]=n,l=Math.log10(o),c=Math.log10(e),u=(r-i)/(c-l),s=a=>{const f=Math.log10(Math.max(a,.001));return i+(f-l)*u};return s.domain=()=>[o,e],s.range=()=>n,s.ticks=a=>{const f=[],d=Math.floor(Math.log10(o)),h=Math.ceil(Math.log10(e));for(let g=d;g<=h;g++){const N=Math.pow(10,g);for(const A of[1,2,5]){const w=N*A;w>=o&&w<=e&&f.push(w)}}return f.length>0?f:[o,e]},s}function Bn(t,n,o,e){const i=o.scale==="log",r=mt,l=Math.max(n-mt,r+50);if(e!=null&&e.xDomain){const f=e.xDomain,d=e.clipBounds??f,h=Qt(d,t.theme.axis,o.scale,o.nullValue);return i?{scale:It([Math.max(f[0],.01),Math.max(f[1],.02)],[r,l]),clipBounds:d,ticks:h}:{scale:wt(f,[r,l]),clipBounds:d,ticks:h}}const c=$n({rows:t.data.rows,config:t.theme.axis,scale:o.scale,nullValue:o.nullValue,forestWidth:n,pointSize:t.theme.shapes.pointSize,effects:o.effects,pointCol:o.pointCol,lowerCol:o.lowerCol,upperCol:o.upperCol}),{plotRegion:u,axisLimits:s,ticks:a}=c;return i?{scale:It([Math.max(u[0],.01),Math.max(u[1],.02)],[r,l]),clipBounds:s,ticks:a}:{scale:wt(u,[r,l]),clipBounds:s,ticks:a}}function Vn(t,n,o){var r,l;const e=[],i=o.spacing.padding;if((r=t.labels)!=null&&r.title){const c=ot(o.typography.fontSizeLg);e.push(`<text x="${i}" y="${n.titleY}"
      font-family="${o.typography.fontFamily}"
      font-size="${c}px"
      font-weight="${o.typography.fontWeightBold}"
      fill="${o.colors.foreground}">${Z(t.labels.title)}</text>`)}if((l=t.labels)!=null&&l.subtitle){const c=ot(o.typography.fontSizeBase);e.push(`<text x="${i}" y="${n.subtitleY}"
      font-family="${o.typography.fontFamily}"
      font-size="${c}px"
      font-weight="${o.typography.fontWeightNormal}"
      fill="${o.colors.secondary}">${Z(t.labels.subtitle)}</text>`)}return e.join(`
`)}function zn(t,n,o){var c,u,s,a;const e=[],i=o.spacing.padding;let r=n.footerY;if(!!((c=t.labels)!=null&&c.caption)||!!((u=t.labels)!=null&&u.footnote)){const f=n.footerY-8;e.push(`<line x1="${i}" x2="${n.totalWidth-i}"
      y1="${f}" y2="${f}"
      stroke="${o.colors.border}" stroke-width="1"/>`)}if((s=t.labels)!=null&&s.caption){const f=ot(o.typography.fontSizeSm);e.push(`<text x="${i}" y="${r}"
      font-family="${o.typography.fontFamily}"
      font-size="${f}px"
      font-weight="${o.typography.fontWeightNormal}"
      fill="${o.colors.secondary}">${Z(t.labels.caption)}</text>`),r+=ut.CAPTION_HEIGHT}if((a=t.labels)!=null&&a.footnote){const f=ot(o.typography.fontSizeSm);e.push(`<text x="${i}" y="${r}"
      font-family="${o.typography.fontFamily}"
      font-size="${f}px"
      font-weight="${o.typography.fontWeightNormal}"
      font-style="italic"
      fill="${o.colors.muted}">${Z(t.labels.footnote)}</text>`)}return e.join(`
`)}function Xn(t,n,o,e,i,r,l,c){const u=[],s=n+1,a=c.groupHeaders;let f,d,h,g,N;if(s===1?(f=ot((a==null?void 0:a.level1FontSize)??c.typography.fontSizeBase),d=(a==null?void 0:a.level1FontWeight)??c.typography.fontWeightBold,h=(a==null?void 0:a.level1Italic)??!1,g=(a==null?void 0:a.level1Background)??null,N=(a==null?void 0:a.level1BorderBottom)??!1):s===2?(f=ot((a==null?void 0:a.level2FontSize)??c.typography.fontSizeBase),d=(a==null?void 0:a.level2FontWeight)??c.typography.fontWeightMedium,h=(a==null?void 0:a.level2Italic)??!0,g=(a==null?void 0:a.level2Background)??null,N=(a==null?void 0:a.level2BorderBottom)??!1):(f=ot((a==null?void 0:a.level3FontSize)??c.typography.fontSizeBase),d=(a==null?void 0:a.level3FontWeight)??c.typography.fontWeightNormal,h=(a==null?void 0:a.level3Italic)??!1,g=(a==null?void 0:a.level3Background)??null,N=(a==null?void 0:a.level3BorderBottom)??!1),!g){const b=c.colors.primary,_=s===1?.15:s===2?.1:.06,p=b.replace("#",""),y=parseInt(p.substring(0,2),16),m=parseInt(p.substring(2,4),16),T=parseInt(p.substring(4,6),16);g=`rgba(${y}, ${m}, ${T}, ${_})`}const A=i+r/2,w=n*((a==null?void 0:a.indentPerLevel)??Y.INDENT_PER_LEVEL);u.push(`<rect x="${e}" y="${i}"
    width="${l}" height="${r}"
    fill="${g}"/>`),N&&u.push(`<line x1="${e}" x2="${e+l}" y1="${i+r}" y2="${i+r}"
      stroke="${c.colors.border}" stroke-width="1" opacity="0.5"/>`);const x=h?' font-style="italic"':"",C=e+Y.TEXT_PADDING+w;if(u.push(`<text class="cell-text" x="${C}" y="${A}"
    font-family="${c.typography.fontFamily}"
    font-size="${f}px"
    font-weight="${d}"${x}
    fill="${c.colors.foreground}">${Z(t)}</text>`),o>0){const b=kt(t,f,c.typography.fontFamily,d),_=C+b+6,p=ot(c.typography.fontSizeSm??"0.75rem");u.push(`<text class="cell-text" x="${_}" y="${A}"
      font-family="${c.typography.fontFamily}"
      font-size="${p}px"
      font-weight="${c.typography.fontWeightNormal}"
      fill="${c.colors.muted}">(${o})</text>`)}return u.join(`
`)}function Un(t,n){const o=new Map;for(const e of n)if(e.type==="bar"){let i=0;for(const r of t){const l=r.metadata[e.field];typeof l=="number"&&l>i&&(i=l)}o.set(e.field,i>0?i:1)}return o}function qn(t,n){var e,i,r,l,c,u,s,a,f,d,h,g,N,A,w,x,C,b,_;if(n.type==="interval"){const p=(i=(e=n.options)==null?void 0:e.interval)!=null&&i.point?t.metadata[n.options.interval.point]:t.point,y=(l=(r=n.options)==null?void 0:r.interval)!=null&&l.lower?t.metadata[n.options.interval.lower]:t.lower,m=(u=(c=n.options)==null?void 0:c.interval)!=null&&u.upper?t.metadata[n.options.interval.upper]:t.upper;return on(p,y,m,n.options)}if(n.type==="numeric"){const p=t.metadata[n.field];return typeof p=="number"?Et(p,n.options):((s=n.options)==null?void 0:s.naText)??""}if(n.type==="custom"&&((a=n.options)!=null&&a.events))return nn(t,n.options);if(n.type==="pvalue"){const p=t.metadata[n.field];return typeof p!="number"?((f=n.options)==null?void 0:f.naText)??"":en(p,n.options)}if(n.type==="icon"){const p=t.metadata[n.field];if(p==null)return"";const y=String(p),m=(h=(d=n.options)==null?void 0:d.icon)==null?void 0:h.mapping;return m&&y in m?m[y]:y}if(n.type==="badge"){const p=t.metadata[n.field];return p!=null?String(p):""}if(n.type==="stars"){const p=t.metadata[n.field];if(typeof p!="number")return"";const y=((N=(g=n.options)==null?void 0:g.stars)==null?void 0:N.maxStars)??5,m=Math.max(0,Math.min(y,p)),T=Math.floor(m),E=y-T;return"★".repeat(T)+"☆".repeat(E)}if(n.type==="img")return((w=(A=n.options)==null?void 0:A.img)==null?void 0:w.fallback)??"[IMG]";if(n.type==="reference"){const p=t.metadata[n.field];if(p==null)return"";const y=String(p),m=((C=(x=n.options)==null?void 0:x.reference)==null?void 0:C.maxChars)??30;return y.length<=m?y:y.substring(0,m)+"..."}if(n.type==="range"){const p=(b=n.options)==null?void 0:b.range;if(!p)return"";const y=t.metadata[p.minField],m=t.metadata[p.maxField],T=p.separator??" – ",E=p.decimals,W=F=>typeof F!="number"?"":E==null?Number.isInteger(F)?String(F):F.toFixed(1):F.toFixed(E);return y===null&&m===null?"":y===null?W(m):m===null?W(y):`${W(y)}${T}${W(m)}`}const o=t.metadata[n.field];return o!=null?String(o):((_=n.options)==null?void 0:_.naText)??""}function On(t,n,o,e,i){const r=t.filter(a=>Number.isFinite(a));if(r.length===0)return"";if(r.length===1){const a=n+e/2,f=o+i/2;return`M${a.toFixed(1)},${f.toFixed(1)}`}const l=Math.min(...r),u=Math.max(...r)-l||1;return`M${r.map((a,f)=>{const d=n+f/(r.length-1)*e,h=o+i-(a-l)/u*i;return`${d.toFixed(1)},${h.toFixed(1)}`}).join("L")}`}function Yn(t,n,o,e,i,r=[],l,c=0,u=1/0,s,a=!1){var y;let f;if(r.length===0){const m=!a||t.point!=null&&t.point>0?t.point:null,T=!a||t.lower!=null&&t.lower>0?t.lower:null,E=!a||t.upper!=null&&t.upper>0?t.upper:null;f=[{point:m,lower:T,upper:E,color:null,shape:null,opacity:null}]}else f=r.map(m=>({point:dt(t.metadata,t.point,m.pointCol,"point",a),lower:dt(t.metadata,t.lower,m.lowerCol,"lower",a),upper:dt(t.metadata,t.upper,m.upperCol,"upper",a),color:m.color??null,shape:m.shape??null,opacity:m.opacity??null}));const d=f.filter(m=>m.point!=null&&!Number.isNaN(m.point)&&m.lower!=null&&!Number.isNaN(m.lower)&&m.upper!=null&&!Number.isNaN(m.upper));if(d.length===0)return"";const h=e.shapes.pointSize,g=e.shapes.lineWidth,N=e.colors.intervalLine,A=((y=t.style)==null?void 0:y.type)==="summary",x=e.shapes.summaryHeight/2;function C(m){var E;if(m&&((E=t.markerStyle)==null?void 0:E.size)!=null)return h*t.markerStyle.size;const T=l?t.metadata[l]:void 0;if(T){const W=.5+Math.sqrt(T/100)*1.5;return Math.min(Math.max(h*W,3),h*2.5)}return h}function b(m,T){const E=T===0,W=t.markerStyle,F=e.shapes.effectColors,H=e.shapes.markerShapes,V=["square","circle","diamond","triangle"];let z;E&&(W!=null&&W.color)?z=W.color:m.color?z=m.color:F&&F.length>0?z=F[T%F.length]:z=e.colors.interval??e.colors.primary??"#2563eb";let M;E&&(W!=null&&W.shape)?M=W.shape:m.shape?M=m.shape:H&&H.length>0?M=H[T%H.length]:M=V[T%V.length];let k;return E&&(W==null?void 0:W.opacity)!=null?k=W.opacity:m.opacity!=null?k=m.opacity:k=1,{color:z,shape:M,opacity:k}}function _(m,T,E,W){const{color:F,shape:H,opacity:V}=W,z=V<1?` fill-opacity="${V}"`:"";switch(H){case"circle":return`<circle cx="${m}" cy="${T}" r="${E}" fill="${F}"${z}/>`;case"diamond":return`<polygon points="${[`${m},${T-E}`,`${m+E},${T}`,`${m},${T+E}`,`${m-E},${T}`].join(" ")}" fill="${F}"${z}/>`;case"triangle":return`<polygon points="${[`${m},${T-E}`,`${m+E},${T+E}`,`${m-E},${T+E}`].join(" ")}" fill="${F}"${z}/>`;default:return`<rect x="${m-E}" y="${T-E}" width="${E*2}" height="${E*2}" fill="${F}"${z}/>`}}const p=[];return d.forEach((m,T)=>{const E=n+In(T,d.length),W=o(m.lower),F=o(m.upper),H=o(m.point),V=b(m,T),z=C(T===0),M=N;if(A){const k=V.opacity<1?` fill-opacity="${V.opacity}"`:"",D=[`${W},${E}`,`${H},${E-x}`,`${F},${E}`,`${H},${E+x}`].join(" ");p.push(`
        <g class="interval effect-${T} summary">
          <polygon points="${D}"
            fill="${V.color}"${k} stroke="${e.colors.summaryBorder}" stroke-width="1"/>
        </g>`)}else{const k=c+mt,D=c+u-mt,I=s?m.lower<s[0]:W<k,$=s?m.upper>s[1]:F>D;let L,S;if(s){const Q=Math.max(s[0],Math.min(s[1],m.lower)),$t=Math.max(s[0],Math.min(s[1],m.upper));L=o(Q),S=o($t)}else L=Math.max(k,Math.min(D,W)),S=Math.max(k,Math.min(D,F));const G=Tn(e),B=G.height/2,O=s?o(s[0]):k,U=s?o(s[1]):D;let tt="";I?tt=`<path d="${Jt("left",O,E,G)}" fill="${G.color}"/>`:tt=`<line x1="${L}" x2="${L}" y1="${E-B}" y2="${E+B}" stroke="${M}" stroke-width="${g}"/>`;let rt="";$?rt=`<path d="${Jt("right",U,E,G)}" fill="${G.color}"/>`:rt=`<line x1="${S}" x2="${S}" y1="${E-B}" y2="${E+B}" stroke="${M}" stroke-width="${g}"/>`;const Nt=s?o(Math.max(s[0],Math.min(s[1],m.point))):Math.max(k,Math.min(D,H));p.push(`
        <g class="interval effect-${T}">
          <line x1="${L}" x2="${S}" y1="${E}" y2="${E}"
            stroke="${M}" stroke-width="${g}"/>
          ${tt}
          ${rt}
          ${_(Nt,E,z,V)}
        </g>`)}}),p.join("")}function jn(t,n,o,e,i,r,l,c){const s=c.shapes.summaryHeight/2,[a,f]=i.domain().map(_=>i(_)),d=Math.min(a,f),h=Math.max(a,f),g=i(n),N=i(t),A=i(o),w=r+Math.max(d,Math.min(h,g)),x=r+Math.max(d,Math.min(h,N)),C=r+Math.max(d,Math.min(h,A));return`<polygon points="${[`${w},${e}`,`${x},${e-s}`,`${C},${e}`,`${x},${e+s}`].join(" ")}"
    fill="${c.colors.summaryFill}"
    stroke="${c.colors.summaryBorder}"
    stroke-width="1"/>`}function Kn(t,n,o,e,i,r,l,c){const u=[],s=r.effects,a=s.length;if(!s.some(w=>{const x=t.metadata[w.value];return x!=null&&!Number.isNaN(x)}))return"";const d=o*.7,h=a>1?2:0,g=(d-h*(a-1))/a,N=Math.max(4,g),A=c.shapes.effectColors??["#3b82f6","#22c55e","#f59e0b","#ef4444","#8b5cf6"];return s.forEach((w,x)=>{const C=t.metadata[w.value];if(C==null||Number.isNaN(C))return;const b=n-d/2+x*(N+h),_=e+l(Math.min(0,C)),p=Math.abs(l(C)-l(0)),y=w.color??A[x%A.length],m=w.opacity??.85;u.push(`<rect
      x="${_}" y="${b}"
      width="${Math.max(1,p)}" height="${N}"
      fill="${y}" fill-opacity="${m}" rx="2"
      class="viz-bar-segment"/>`)}),u.join(`
`)}function Zn(t,n,o,e,i,r,l,c){const u=[],s=r.effects,a=s.length,f=s.map(x=>{if(x.data){const C=t.metadata[x.data];return!C||!Array.isArray(C)||C.length===0?null:rn(C)}if(x.min&&x.q1&&x.median&&x.q3&&x.max){const C=t.metadata[x.min],b=t.metadata[x.q1],_=t.metadata[x.median],p=t.metadata[x.q3],y=t.metadata[x.max];if([C,b,_,p,y].some(T=>T==null||Number.isNaN(T)))return null;let m=[];if(x.outliers){const T=t.metadata[x.outliers];T&&Array.isArray(T)&&(m=T)}return{min:C,q1:b,median:_,q3:p,max:y,outliers:m}}return null});if(!f.some(x=>x!==null))return"";const h=o*.7,g=a>1?2:0,N=Math.max(8,(h-(a-1)*g)/a),A=c.shapes.effectColors??["#3b82f6","#22c55e","#f59e0b","#ef4444","#8b5cf6"],w=c.colors.foreground??"#1a1a1a";return s.forEach((x,C)=>{const b=f[C];if(!b)return;const _=n-h/2+C*(N+g),p=_+N/2,y=x.color??A[C%A.length],m=x.fillOpacity??.7;u.push(`<line
      x1="${e+l(b.min)}" x2="${e+l(b.q1)}"
      y1="${p}" y2="${p}"
      stroke="${w}" stroke-width="1"/>`),u.push(`<line
      x1="${e+l(b.min)}" x2="${e+l(b.min)}"
      y1="${p-N/4}" y2="${p+N/4}"
      stroke="${w}" stroke-width="1"/>`),u.push(`<line
      x1="${e+l(b.q3)}" x2="${e+l(b.max)}"
      y1="${p}" y2="${p}"
      stroke="${w}" stroke-width="1"/>`),u.push(`<line
      x1="${e+l(b.max)}" x2="${e+l(b.max)}"
      y1="${p-N/4}" y2="${p+N/4}"
      stroke="${w}" stroke-width="1"/>`);const T=Math.max(2,l(b.q3)-l(b.q1));if(u.push(`<rect
      x="${e+l(b.q1)}" y="${_}"
      width="${T}" height="${N}"
      fill="${y}" fill-opacity="${m}"
      stroke="${w}" stroke-width="1"/>`),u.push(`<line
      x1="${e+l(b.median)}" x2="${e+l(b.median)}"
      y1="${_}" y2="${_+N}"
      stroke="${w}" stroke-width="2"/>`),r.showOutliers!==!1&&b.outliers.length>0)for(const E of b.outliers)u.push(`<circle
          cx="${e+l(E)}" cy="${p}"
          r="2.5"
          fill="none" stroke="${y}" stroke-width="1.5"/>`)}),u.join(`
`)}function Qn(t,n,o,e,i,r,l,c){const u=[],s=r.effects,a=s.length,f=s.map(b=>{const _=t.metadata[b.data];return!_||!Array.isArray(_)||_.length<2?null:Sn(_,r.bandwidth)}),d=s.map(b=>{const _=t.metadata[b.data];if(!_||!Array.isArray(_)||_.length<2)return null;const p=_.filter(T=>T!=null&&!Number.isNaN(T)).sort((T,E)=>T-E);if(p.length===0)return null;const y=p.length,m=T=>{if(y===1)return p[0];const E=(y-1)*T,W=Math.floor(E),F=Math.ceil(E);return W===F?p[W]:p[W]+(E-W)*(p[F]-p[W])};return{q1:m(.25),median:m(.5),q3:m(.75)}});if(!f.some(b=>b!==null))return"";const g=o*.8,N=a>1?2:0,A=Math.max(10,(g-(a-1)*N)/a),w=A/2,x=c.shapes.effectColors??["#3b82f6","#22c55e","#f59e0b","#ef4444","#8b5cf6"],C=c.colors.foreground??"#1a1a1a";return s.forEach((b,_)=>{const p=f[_],y=d[_];if(!p||p.x.length<2)return;const m=n-g/2+A/2+_*(A+N),T=b.color??x[_%x.length],E=b.fillOpacity??.5,W=vn(p,w),F=[];for(let H=0;H<W.x.length;H++){const V=e+l(W.x[H]),z=m-W.y[H];F.push(H===0?`M ${V} ${z}`:`L ${V} ${z}`)}for(let H=W.x.length-1;H>=0;H--){const V=e+l(W.x[H]),z=m+W.y[H];F.push(`L ${V} ${z}`)}if(F.push("Z"),u.push(`<path
      d="${F.join(" ")}"
      fill="${T}" fill-opacity="${E}"
      stroke="${C}" stroke-width="0.5"/>`),r.showMedian!==!1&&y){const H=e+l(y.median);u.push(`<line
        x1="${H}" x2="${H}"
        y1="${m-w*.6}" y2="${m+w*.6}"
        stroke="${C}" stroke-width="2"/>`)}if(r.showQuartiles&&y){const H=e+l(y.q1),V=e+l(y.q3);u.push(`<line
        x1="${H}" x2="${H}"
        y1="${m-w*.4}" y2="${m+w*.4}"
        stroke="${C}" stroke-width="1" stroke-dasharray="2,2"/>`),u.push(`<line
        x1="${V}" x2="${V}"
        y1="${m-w*.4}" y2="${m+w*.4}"
        stroke="${C}" stroke-width="1" stroke-dasharray="2,2"/>`)}}),u.join(`
`)}function Jn(t,n,o){var c,u;const e=n.scale==="log",i=mt;let r=(c=n.axisRange)==null?void 0:c[0],l=(u=n.axisRange)==null?void 0:u[1];if(r==null||l==null){const s=[];for(const a of t)for(const f of n.effects){const d=a.metadata[f.value];d!=null&&!Number.isNaN(d)&&s.push(d)}s.length>0?(r=r??Math.min(0,...s),l=l??Math.max(...s)*1.1):(r=r??0,l=l??100)}return e?It([Math.max(.01,r),l],[i,o-i]):wt([r,l],[i,o-i])}function to(t,n,o){var c,u;const e=n.scale==="log",i=mt;let r=(c=n.axisRange)==null?void 0:c[0],l=(u=n.axisRange)==null?void 0:u[1];if(r==null||l==null){const s=[];for(const a of t)for(const f of n.effects)if(f.data){const d=a.metadata[f.data];if(d&&Array.isArray(d)){const h=rn(d);s.push(h.min,h.max),n.showOutliers!==!1&&s.push(...h.outliers)}}else if(f.min&&f.max){const d=a.metadata[f.min],h=a.metadata[f.max];d!=null&&!Number.isNaN(d)&&s.push(d),h!=null&&!Number.isNaN(h)&&s.push(h)}if(s.length>0){const a=Math.min(...s),f=Math.max(...s),d=f-a;r=r??a-d*.05,l=l??f+d*.05}else r=r??0,l=l??100}return e?It([Math.max(.01,r),l],[i,o-i]):wt([r,l],[i,o-i])}function no(t,n,o){var c,u;const e=n.scale==="log",i=mt;let r=(c=n.axisRange)==null?void 0:c[0],l=(u=n.axisRange)==null?void 0:u[1];if(r==null||l==null){const s=[];for(const a of t)for(const f of n.effects){const d=a.metadata[f.data];d&&Array.isArray(d)&&s.push(...d.filter(h=>h!=null&&!Number.isNaN(h)))}if(s.length>0){r=r??Math.min(...s),l=l??Math.max(...s);const a=(l??0)-(r??0);r=(r??0)-a*.1,l=(l??0)+a*.1}else r=r??0,l=l??100}return e?It([Math.max(.01,r),l],[i,o-i]):wt([r,l],[i,o-i])}function Ot(t,n,o,e,i,r,l){const c=[],u=ot(o.typography.fontSizeSm),s=Rt.EDGE_THRESHOLD,a=A=>A<s?"start":A>r-s?"end":"middle",f=A=>A<s?2:A>r-s?-2:0;c.push(`<line x1="${i}" x2="${i+r}"
    y1="0" y2="0" stroke="${o.colors.border}" stroke-width="1"/>`);const d=t.domain(),h=5,g=[],N=d[1]-d[0];for(let A=0;A<=h;A++)g.push(d[0]+N*A/h);for(const A of g){const w=t(A),x=i+w,C=a(w),b=f(w),_=Et(A);c.push(`<line x1="${x}" x2="${x}" y1="0" y2="4" stroke="${o.colors.border}" stroke-width="1"/>`),c.push(`<text x="${x+b}" y="14"
      text-anchor="${C}"
      font-family="${o.typography.fontFamily}"
      font-size="${u}px"
      font-weight="${o.typography.fontWeightNormal}"
      fill="${o.colors.foreground}">${_}</text>`)}return e&&c.push(`<text x="${i+r/2}" y="28"
      text-anchor="middle"
      font-family="${o.typography.fontFamily}"
      font-size="${u}px"
      font-weight="${o.typography.fontWeightMedium}"
      fill="${o.colors.foreground}">${Z(e)}</text>`),c.join(`
`)}function oo(t,n,o,e,i,r,l=1,c){const u=[],s=typeof o.axis.tickCount=="number"?o.axis.tickCount:Y.DEFAULT_TICK_COUNT,a=ao(t,s,o,l,r,c),f=ot(o.typography.fontSizeSm),d=Rt.EDGE_THRESHOLD,h=N=>N<d?"start":N>r-d?"end":"middle",g=N=>N<d?2:N>r-d?-2:0;u.push(`<line x1="${i}" x2="${i+r}"
    y1="0" y2="0" stroke="${o.colors.border}" stroke-width="1"/>`);for(const N of a){const A=t(N),w=i+A,x=h(A),C=g(A);u.push(`<line x1="${w}" x2="${w}" y1="0" y2="4"
      stroke="${o.colors.border}" stroke-width="1"/>`),u.push(`<text x="${w+C}" y="16" text-anchor="${x}"
      font-family="${o.typography.fontFamily}"
      font-size="${f}px"
      font-weight="${o.typography.fontWeightNormal}"
      fill="${o.colors.secondary}">${Rn(N)}</text>`)}return e&&u.push(`<text x="${i+r/2}" y="28"
      text-anchor="middle"
      font-family="${o.typography.fontFamily}"
      font-size="${f}px"
      font-weight="${o.typography.fontWeightMedium}"
      fill="${o.colors.secondary}">${Z(e)}</text>`),`<g transform="translate(0, ${n.mainY+n.headerHeight+n.plotHeight})">${u.join(`
`)}</g>`}function eo(t,n,o,e,i,r,l,c,u,s){const a=[],f=ot(r.typography.fontSizeBase),d=r.typography.headerFontScale??1.05,h=Math.round(f*d*100)/100,g=r.typography.fontWeightBold,N=r.typography.fontWeightBold,A=Dt(t),w=(x,C)=>x+C/2;if(A){const x=i/2,C=i/2;let b=o;a.push(`<text class="cell-text" x="${b+Y.TEXT_PADDING}" y="${w(e,i)}"
      font-family="${r.typography.fontFamily}"
      font-size="${h}px"
      font-weight="${g}"
      fill="${r.colors.foreground}">${Z(l)}</text>`),b+=c;const _=[];for(const p of t)if(p.isGroup){const y=p.columns.reduce((T,E)=>E.isGroup?T+E.columns.reduce((W,F)=>W+s(F),0):T+s(E),0),m=b+y/2;a.push(`<text class="cell-text" x="${m}" y="${w(e,x)}"
          font-family="${r.typography.fontFamily}"
          font-size="${h}px"
          font-weight="${N}"
          text-anchor="middle"
          fill="${r.colors.foreground}">${Z(p.header)}</text>`),_.push({x1:b,x2:b+y}),b+=y}else{const y=s(p),m=p.headerAlign??p.align,{textX:T,anchor:E}=Ht(b,y,m),W=un(p.header,y,h,Y.TEXT_PADDING);a.push(`<text class="cell-text" x="${T}" y="${w(e,i)}"
          font-family="${r.typography.fontFamily}"
          font-size="${h}px"
          font-weight="${g}"
          text-anchor="${E}"
          fill="${r.colors.foreground}">${Z(W)}</text>`),b+=y}for(const p of _)a.push(`<line x1="${p.x1}" x2="${p.x2}"
        y1="${e+x}" y2="${e+x}"
        stroke="${r.colors.border}" stroke-width="1"/>`);b=o+c;for(const p of t)if(p.isGroup){for(const y of p.columns)if(!y.isGroup){const m=s(y),T=y.headerAlign??y.align,{textX:E,anchor:W}=Ht(b,m,T);a.push(`<text class="cell-text" x="${E}" y="${w(e+x,C)}"
              font-family="${r.typography.fontFamily}"
              font-size="${h}px"
              font-weight="${g}"
              text-anchor="${W}"
              fill="${r.colors.foreground}">${Z(y.header)}</text>`),b+=m}}else b+=s(p)}else{let x=o;a.push(`<text class="cell-text" x="${x+Y.TEXT_PADDING}" y="${w(e,i)}"
      font-family="${r.typography.fontFamily}"
      font-size="${h}px"
      font-weight="${g}"
      fill="${r.colors.foreground}">${Z(l)}</text>`),x+=c;for(const C of n){const b=s(C),_=C.headerAlign??C.align,{textX:p,anchor:y}=Ht(x,b,_),m=un(C.header,b,h,Y.TEXT_PADDING);a.push(`<text class="cell-text" x="${p}" y="${w(e,i)}"
        font-family="${r.typography.fontFamily}"
        font-size="${h}px"
        font-weight="${g}"
        text-anchor="${y}"
        fill="${r.colors.foreground}">${Z(m)}</text>`),x+=b}}return a.join(`
`)}function ro(t,n,o,e,i,r,l,c,u,s,a,f){var C,b,_,p,y,m,T,E,W,F,H,V,z,M,k,D,I,$,L,S,G,B,O,U,tt,rt,Nt,Q,$t;const d=[],h=ot(r.typography.fontSizeBase),g=e+i/2,N=c*Y.INDENT_PER_LEVEL+(((C=t.style)==null?void 0:C.indent)??0)*Y.INDENT_PER_LEVEL,A=(b=t.style)!=null&&b.bold||(_=t.style)!=null&&_.emphasis?r.typography.fontWeightBold:r.typography.fontWeightNormal,w=(p=t.style)!=null&&p.italic?"italic":"normal";let x=r.colors.foreground;if((y=t.style)!=null&&y.color?x=t.style.color:(m=t.style)!=null&&m.muted?x=r.colors.muted:(T=t.style)!=null&&T.accent&&(x=r.colors.accent),d.push(`<text class="cell-text" x="${o+Y.TEXT_PADDING+N}" y="${g}"
    font-family="${r.typography.fontFamily}"
    font-size="${h}px"
    font-weight="${A}"
    font-style="${w}"
    fill="${x}">${Z(t.label)}</text>`),(E=t.style)!=null&&E.badge){const st=String(t.style.badge),v=h*bt.FONT_SCALE,j=v+bt.PADDING*2,nt=kt(t.label,h,r.typography.fontFamily,A),q=o+Y.TEXT_PADDING+N+nt+bt.GAP,J=kt(st,v,r.typography.fontFamily,r.typography.fontWeightBold)+bt.PADDING*2,P=e+(i-j)/2;d.push(`<rect x="${q}" y="${P}" width="${J}" height="${j}"
      rx="3" fill="${r.colors.primary}" opacity="0.15"/>`),d.push(`<text class="cell-text" x="${q+J/2}" y="${P+j/2}"
      text-anchor="middle"
      font-family="${r.typography.fontFamily}"
      font-size="${v}px"
      font-weight="${r.typography.fontWeightBold}"
      fill="${r.colors.primary}">${Z(st)}</text>`)}for(let st=0;st<n.length;st++){const v=n[st],j=f[st],nt=a(v);if(v.type==="forest"||v.type==="viz_bar"||v.type==="viz_boxplot"||v.type==="viz_violin")continue;const q=qn(t,v),{textX:X,anchor:J}=Ht(j,nt,v.align);if(v.type==="bar"&&typeof t.metadata[v.field]=="number"){const P=t.metadata[v.field],R=u.get(v.field),at=((F=(W=v.options)==null?void 0:W.bar)==null?void 0:F.maxValue)??R??100,et=((V=(H=v.options)==null?void 0:H.bar)==null?void 0:V.color)??r.colors.primary,K=r.shapes.pointSize*2,pt=nt-Y.TEXT_PADDING*2-50,it=Math.min(P/at*pt,pt),ft=t.style,gt=ft!=null&&ft.bold||ft!=null&&ft.emphasis?r.typography.fontWeightBold:r.typography.fontWeightNormal;d.push(`<rect x="${j+Y.TEXT_PADDING}" y="${e+i/2-K/2}"
        width="${Math.max(0,it)}" height="${K}"
        fill="${et}" opacity="0.7" rx="2"/>`),d.push(`<text class="cell-text" x="${j+nt-Y.TEXT_PADDING}" y="${g}"
        font-family="${r.typography.fontFamily}"
        font-size="${h}px"
        font-weight="${gt}"
        text-anchor="end"
        fill="${r.colors.foreground}">${Et(P)}</text>`)}else if(v.type==="sparkline"&&Array.isArray(t.metadata[v.field])){let P=t.metadata[v.field];Array.isArray(P[0])&&(P=P[0]);const R=((M=(z=v.options)==null?void 0:z.sparkline)==null?void 0:M.height)??16,at=((D=(k=v.options)==null?void 0:k.sparkline)==null?void 0:D.color)??r.colors.primary,et=Y.TEXT_PADDING*2,K=On(P,j+Y.TEXT_PADDING,e+i/2-R/2,nt-et,R);d.push(`<path d="${K}" fill="none" stroke="${at}" stroke-width="1.5"/>`)}else if(v.type==="badge"){const P=t.metadata[v.field];if(P!=null){const R=String(P),at=h*.85,et=at+8,K=($=(I=v.options)==null?void 0:I.badge)==null?void 0:$.variants,ht=(S=(L=v.options)==null?void 0:L.badge)==null?void 0:S.colors;let pt=r.colors.primary,it=r.colors.primary;if(ht&&R in ht)pt=ht[R],it=ht[R];else if(K&&R in K){const jt=K[R];pt={default:r.colors.primary,...wn,muted:r.colors.muted}[jt]??r.colors.primary,it=pt}const gt=kt(R,at,r.typography.fontFamily,r.typography.fontWeightBold)+12,At=v.align==="right"?j+nt-Y.TEXT_PADDING-gt:v.align==="center"?j+(nt-gt)/2:j+Y.TEXT_PADDING,St=e+(i-et)/2;d.push(`<rect x="${At}" y="${St}" width="${gt}" height="${et}"
          rx="${et/2}" fill="${pt}" opacity="0.15"/>`),d.push(`<text class="cell-text" x="${At+gt/2}" y="${St+et/2}"
          text-anchor="middle"
          font-family="${r.typography.fontFamily}"
          font-size="${at}px"
          font-weight="${r.typography.fontWeightBold}"
          fill="${it}">${Z(R)}</text>`)}}else if(v.type==="stars"){const P=t.metadata[v.field];if(typeof P=="number"){const R=((B=(G=v.options)==null?void 0:G.stars)==null?void 0:B.maxStars)??5,at=((U=(O=v.options)==null?void 0:O.stars)==null?void 0:U.color)??"#f59e0b",et=((rt=(tt=v.options)==null?void 0:tt.stars)==null?void 0:rt.emptyColor)??"#d1d5db",K=Math.max(0,Math.min(R,P)),ht=Math.floor(K),pt=((Q=(Nt=v.options)==null?void 0:Nt.stars)==null?void 0:Q.halfStars)&&K-ht>=.5,it=12,ft=2,gt=R*it+(R-1)*ft;let At=v.align==="right"?j+nt-Y.TEXT_PADDING-gt:v.align==="center"?j+(nt-gt)/2:j+Y.TEXT_PADDING;const St=e+(i-it)/2,jt=(xt,vt,Kt)=>{const Gt=Kt/2,Pt=Gt*.4;let fn="";for(let Ct=0;Ct<5;Ct++){const dn=(Ct*72-90)*Math.PI/180,hn=(Ct*72+36-90)*Math.PI/180,pn=xt+Gt*Math.cos(dn),gn=vt+Gt*Math.sin(dn),uo=xt+Pt*Math.cos(hn),fo=vt+Pt*Math.sin(hn);fn+=(Ct===0?`M${pn},${gn}`:`L${pn},${gn}`)+`L${uo},${fo}`}return fn+"Z"};for(let xt=0;xt<R;xt++){const vt=At+it/2,Kt=St+it/2,Pt=xt<ht||xt===ht&&pt?at:et;d.push(`<path d="${jt(vt,Kt,it)}" fill="${Pt}"/>`),At+=it+ft}}}else{const P=($t=t.cellStyles)==null?void 0:$t[v.field],R=t.style;let at=r.typography.fontWeightNormal;(P!=null&&P.bold||P!=null&&P.emphasis||R!=null&&R.bold||R!=null&&R.emphasis)&&(at=r.typography.fontWeightBold);let et="normal";(P!=null&&P.italic||R!=null&&R.italic)&&(et="italic");let K=r.colors.foreground;P!=null&&P.color?K=P.color:P!=null&&P.muted?K=r.colors.muted:P!=null&&P.accent?K=r.colors.accent:R!=null&&R.color?K=R.color:R!=null&&R.muted?K=r.colors.muted:R!=null&&R.accent&&(K=r.colors.accent),d.push(`<text class="cell-text" x="${X}" y="${g}"
        font-family="${r.typography.fontFamily}"
        font-size="${h}px"
        font-weight="${at}"
        font-style="${et}"
        text-anchor="${J}"
        fill="${K}">${Z(q)}</text>`)}}return d.join(`
`)}function ao(t,n,o,e,i,r){if(Array.isArray(o.axis.tickValues)&&o.axis.tickValues.length>0){const[y,m]=t.domain();let T=o.axis.tickValues.filter(F=>F>=y&&F<=m);const E=o.axis.nullTick!==!1,W=e>=y&&e<=m;return E&&W&&!T.includes(e)&&(T=[...T,e].sort((F,H)=>F-H)),T}const[l,c]=t.domain(),u=o.axis.nullTick!==!1,s=e>=l&&e<=c,a=Rt.MIN_TICK_SPACING,f=Math.max(2,Math.floor(i/a)),d=Math.min(n,Math.min(7,f)),h=r&&r.length>0?r.filter(y=>y>=l&&y<=c):t.ticks(d);if(h.length===0)return u&&s?[e]:[];const g=t(e),N=h.filter(y=>y<e).reverse(),A=h.filter(y=>y>e),w=h.some(y=>y===e),x=[];let C=g;for(const y of N){const m=t(y);C-m>=a&&(x.unshift(y),C=m)}const b=[];let _=g;for(const y of A){const m=t(y);m-_>=a&&(b.push(y),_=m)}const p=[...x];if((w||u&&s)&&p.push(e),p.push(...b),p.length<2){const y=new Set(p);y.has(l)||p.unshift(l),p.length<2&&!y.has(c)&&p.push(c)}return p}function Yt(t,n,o,e,i,r,l,c=1,u=.6){let a=`<line x1="${t}" x2="${t}" y1="${n}" y2="${o}"
    stroke="${i}" stroke-width="${c}" stroke-opacity="${u}" stroke-dasharray="${e==="dashed"?"6,4":e==="dotted"?"2,2":"none"}"/>`;if(l){const f=r.colors.secondary;a+=`<text x="${t}" y="${n-4}" text-anchor="middle"
      font-family="${r.typography.fontFamily}"
      font-size="${r.typography.fontSizeSm}"
      font-weight="${r.typography.fontWeightMedium}"
      fill="${f}">${Z(l)}</text>`}return a}class Mt extends Error{constructor(n){super(`SVG Generator: ${n}`),this.name="SVGGeneratorError"}}function so(t){if(!t||typeof t!="object")throw new Mt("Invalid spec: expected an object");const n=t;if(!n.data||typeof n.data!="object")throw new Mt("Invalid spec: missing or invalid 'data' property");const o=n.data;if(!Array.isArray(o.rows))throw new Mt("Invalid spec: 'data.rows' must be an array");if(!n.theme||typeof n.theme!="object")throw new Mt("Invalid spec: missing or invalid 'theme' property");const e=n.theme;if(!e.colors||typeof e.colors!="object")throw new Mt("Invalid spec: missing or invalid 'theme.colors'");if(!e.typography||typeof e.typography!="object")throw new Mt("Invalid spec: missing or invalid 'theme.typography'");if(!e.spacing||typeof e.spacing!="object")throw new Mt("Invalid spec: missing or invalid 'theme.spacing'")}function io(t){var r;const o=qt(t.columns,void 0).find(l=>l.type==="forest");if(!o||!((r=o.options)!=null&&r.forest))return{scale:"linear",nullValue:0,effects:[],axisLabel:"Effect",pointCol:null,lowerCol:null,upperCol:null};const e=o.options.forest,i=e.scale??"linear";return{scale:i,nullValue:e.nullValue??(i==="log"?1:0),effects:e.effects??[],axisLabel:e.axisLabel??"Effect",pointCol:e.point??null,lowerCol:e.lower??null,upperCol:e.upper??null}}function lo(t,n={}){var E,W,F,H,V,z;so(t);const o=t.theme,e=o.spacing.padding,i=Array.isArray(t.columns)?t.columns:[],r=Ut(i),l=[];for(let M=0;M<r.length;M++)r[M].type==="forest"&&l.push(M);l.length>0;const c=[];for(let M=0;M<r.length;M++){const k=r[M];(k.type==="viz_bar"||k.type==="viz_boxplot"||k.type==="viz_violin")&&c.push({index:M,type:k.type,column:k})}const u=io(t),s=Ln(t,n,u.nullValue),a=s.autoWidths,f=M=>{var D,I,$,L,S,G,B,O;if(M.type==="forest"){const U=a.get(M.id);return U!==void 0?U:typeof M.width=="number"?M.width:((I=(D=M.options)==null?void 0:D.forest)==null?void 0:I.width)??s.forestWidth}if(M.type==="viz_bar"){const U=a.get(M.id);return U!==void 0?U:typeof M.width=="number"?M.width:((L=($=M.options)==null?void 0:$.vizBar)==null?void 0:L.width)??s.forestWidth}if(M.type==="viz_boxplot"){const U=a.get(M.id);return U!==void 0?U:typeof M.width=="number"?M.width:((G=(S=M.options)==null?void 0:S.vizBoxplot)==null?void 0:G.width)??s.forestWidth}if(M.type==="viz_violin"){const U=a.get(M.id);return U!==void 0?U:typeof M.width=="number"?M.width:((O=(B=M.options)==null?void 0:B.vizViolin)==null?void 0:O.width)??s.forestWidth}const k=a.get(M.id);return k!==void 0?k:typeof M.width=="number"?M.width:yt.DEFAULT_COLUMN_WIDTH},d=[];let h=e+s.labelWidth;for(const M of r)d.push(h),h+=f(M);const g=[];g.push(`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg"
  width="${s.totalWidth}" height="${s.totalHeight}"
  viewBox="0 0 ${s.totalWidth} ${s.totalHeight}">
<style>
  text {
    font-variant-numeric: tabular-nums;
  }
  /* Use dominant-baseline for cell text to match CSS flex centering */
  .cell-text { dominant-baseline: central; }
</style>`);const N=n.backgroundColor??o.colors.background;if(g.push(`<rect width="100%" height="100%" fill="${N}"/>`),o.layout.containerBorder!==!1){const M=o.layout.containerBorderRadius??8;g.push(`<rect x="0.5" y="0.5"
      width="${s.totalWidth-1}" height="${s.totalHeight-1}"
      fill="none" stroke="${o.colors.border}" stroke-width="1"
      rx="${M}" ry="${M}"/>`)}g.push(Vn(t,s,o)),!!((E=t.labels)!=null&&E.subtitle)&&g.push(`<line x1="${e}" x2="${s.totalWidth-e}"
      y1="${s.mainY}" y2="${s.mainY}"
      stroke="${o.colors.border}" stroke-width="2"/>`);const w=s.mainY;g.push(eo(i,r,e,w,s.headerHeight,o,t.data.labelHeader??"Study",s.labelWidth,a,f)),g.push(`<line x1="${e}" x2="${s.totalWidth-e}"
    y1="${w+s.headerHeight}" y2="${w+s.headerHeight}"
    stroke="${o.colors.border}" stroke-width="2"/>`);const x=ln(t),C=[],b=[];let _=0;for(const M of x){const D=M.type==="data"&&((W=M.row.style)==null?void 0:W.type)==="spacer"?s.rowHeight/2:s.rowHeight;C.push(_),b.push(D),_+=D}const p=s.mainY+s.headerHeight;x.forEach((M,k)=>{var D,I,$,L;if(M.type==="data"){const S=M.row,G=p+C[k],B=b[k];if((D=S.style)!=null&&D.bg)g.push(`<rect x="${e}" y="${G}"
          width="${s.totalWidth-e*2}" height="${B}"
          fill="${S.style.bg}"/>`);else if(((I=S.style)==null?void 0:I.type)==="header")g.push(`<rect x="${e}" y="${G}"
          width="${s.totalWidth-e*2}" height="${B}"
          fill="${o.colors.muted}" fill-opacity="0.1"/>`);else if(o.layout.banding&&!((($=S.style)==null?void 0:$.type)==="summary"||((L=S.style)==null?void 0:L.type)==="spacer")){const tt=k%2===1?o.colors.altBg:o.colors.rowBg;tt!==o.colors.background&&g.push(`<rect x="${e}" y="${G}"
              width="${s.totalWidth-e*2}" height="${B}"
              fill="${tt}"/>`)}}});for(const M of l){const k=r[M],D=d[M],I=f(k),$=(F=k.options)==null?void 0:F.forest,L=($==null?void 0:$.scale)??"linear",S=($==null?void 0:$.nullValue)??(L==="log"?1:0),G=($==null?void 0:$.axisLabel)??"Effect",B=L==="log";let O=($==null?void 0:$.effects)??[];const U=($==null?void 0:$.point)??null,tt=($==null?void 0:$.lower)??null,rt=($==null?void 0:$.upper)??null;O.length===0&&(U||tt||rt)&&(O=[{pointCol:U,lowerCol:tt,upperCol:rt}]);const Nt={scale:L,nullValue:S,effects:O,pointCol:($==null?void 0:$.point)??null,lowerCol:($==null?void 0:$.lower)??null,upperCol:($==null?void 0:$.upper)??null},{scale:Q,clipBounds:$t,ticks:st}=Bn(t,I,Nt,n),v=D+Q(S);g.push(Yt(v,p,p+s.plotHeight,"dashed",o.colors.muted,o));const j=($==null?void 0:$.annotations)??[];for(const q of j)if(q.type==="reference_line"){const X=D+Q(q.x);g.push(Yt(X,p,p+s.plotHeight,q.style,q.color??o.colors.accent,o,q.label,q.width??1,q.opacity??.6))}const nt=Array.isArray(t.annotations)?t.annotations:[];for(const q of nt)if(q.type==="reference_line"){const X=D+Q(q.x);g.push(Yt(X,p,p+s.plotHeight,q.style,q.color??o.colors.accent,o,q.label,q.width??1,q.opacity??.6))}if(x.forEach((q,X)=>{if(q.type==="data"){const J=p+C[X]+b[X]/2;g.push(Yn(q.row,J,P=>D+Q(P),o,S,O,t.data.weightCol,D,I,$t,B))}}),t.data.overall&&s.showOverallSummary&&typeof t.data.overall.point=="number"&&!Number.isNaN(t.data.overall.point)&&typeof t.data.overall.lower=="number"&&!Number.isNaN(t.data.overall.lower)&&typeof t.data.overall.upper=="number"&&!Number.isNaN(t.data.overall.upper)){const q=p+s.summaryYPosition;g.push(jn(t.data.overall.point,t.data.overall.lower,t.data.overall.upper,q,Q,D,I,o))}g.push(oo(Q,s,o,G,D,I,S,st))}const y=t.data.rows;for(const M of c){const k=M.column,D=d[M.index],I=f(k);if(M.type==="viz_bar"){const $=(H=k.options)==null?void 0:H.vizBar;if(!$)continue;const L=Jn(y,$,I);x.forEach((S,G)=>{if(S.type==="data"){const B=p+C[G]+b[G]/2,O=b[G];g.push(Kn(S.row,B,O,D,I,$,L,o))}}),$.showAxis!==!1&&(g.push(`<g transform="translate(0, ${p+s.plotHeight})">`),g.push(Ot(L,s,o,$.axisLabel,D,I,$.nullValue)),g.push("</g>"))}else if(M.type==="viz_boxplot"){const $=(V=k.options)==null?void 0:V.vizBoxplot;if(!$)continue;const L=to(y,$,I);x.forEach((S,G)=>{if(S.type==="data"){const B=p+C[G]+b[G]/2,O=b[G];g.push(Zn(S.row,B,O,D,I,$,L,o))}}),$.showAxis!==!1&&(g.push(`<g transform="translate(0, ${p+s.plotHeight})">`),g.push(Ot(L,s,o,$.axisLabel,D,I,$.nullValue)),g.push("</g>"))}else if(M.type==="viz_violin"){const $=(z=k.options)==null?void 0:z.vizViolin;if(!$)continue;const L=no(y,$,I);x.forEach((S,G)=>{if(S.type==="data"){const B=p+C[G]+b[G]/2,O=b[G];g.push(Qn(S.row,B,O,D,I,$,L,o))}}),$.showAxis!==!1&&(g.push(`<g transform="translate(0, ${p+s.plotHeight})">`),g.push(Ot(L,s,o,$.axisLabel,D,I,$.nullValue)),g.push("</g>"))}}const m=s.mainY+s.headerHeight,T=Un(y,r);return x.forEach((M,k)=>{var $,L,S;const D=m+C[k],I=b[k];if(M.type==="group_header")g.push(Xn(M.label,M.depth,M.rowCount,e,D,I,s.totalWidth-e*2,o));else{const G=M.row,B=M.depth;(($=G.style)==null?void 0:$.type)==="spacer"||g.push(ro(G,r,e,D,I,o,s.labelWidth,B,T,a,f,d))}if(M.type==="data"){const G=M.row,B=((L=G.style)==null?void 0:L.type)==="summary",O=((S=G.style)==null?void 0:S.type)==="spacer";B&&g.push(`<line x1="${e}" x2="${s.totalWidth-e}"
          y1="${D}" y2="${D}"
          stroke="${o.colors.border}" stroke-width="2"/>`),O||g.push(`<line x1="${e}" x2="${s.totalWidth-e}"
          y1="${D+I}" y2="${D+I}"
          stroke="${o.colors.border}" stroke-width="1"/>`)}else g.push(`<line x1="${e}" x2="${s.totalWidth-e}"
        y1="${D+I}" y2="${D+I}"
        stroke="${o.colors.border}" stroke-width="1"/>`)}),g.push(zn(t,s,o)),g.push("</svg>"),g.join(`
`)}function co(t,n){const o=JSON.parse(t);return lo(o,n)}globalThis.generateSVG=co})();
