---
title: "Customizing Plots"
---

```{r}
#| include: false
library(webforest)
```

Plots can be fully customized at creation time using constructor arguments. For most users, this is the easiest approach:

```{r}
#| eval: false
forest_plot(data,
  point = "hr", lower = "lower", upper = "upper",
  label = "study",
  # Row styling
  row_bold = "is_summary",
  row_color = "text_color",
  # Marker styling
  marker_color = "sig_color",
  marker_shape = "study_shape",
  # Theme
  theme = web_theme_modern(),
  scale = "log", null_value = 1
)
```

See [forest_plot() reference](../reference/forest_plot.qmd) for all available parameters.

## Modifying Plots After Creation

For cases where you need to modify a plot after creation—such as applying conditional styling, creating variants, or working in a pipeline—webforest provides `set_*()` modifier functions:

```{r}
fluent_data <- data.frame(
  study = c("Trial A", "Trial B", "Trial C", "Overall"),
  hr = c(0.72, 0.85, 0.91, 0.82),
  lower = c(0.55, 0.70, 0.75, 0.68),
  upper = c(0.95, 1.03, 1.10, 0.99),
  is_summary = c(FALSE, FALSE, FALSE, TRUE),
  sig_color = c("#16a34a", "#94a3b8", "#94a3b8", "#2563eb")
)

forest_plot(fluent_data,
  point = "hr", lower = "lower", upper = "upper",
  label = "study", scale = "log", null_value = 1,
  theme = web_theme_modern()
) |>
  set_marker_style(color = "sig_color") |>
  set_row_style(bold = "is_summary")
```

## Available Modifiers

### set_row_style

Apply styling to all rows based on column values.

```r
plot |> set_row_style(
  bold = NULL,    # Column name for bold text (logical)
  italic = NULL,  # Column name for italic text (logical)
  color = NULL,   # Column name for text color (hex string)
  bg = NULL,      # Column name for background color (hex string)
  badge = NULL,   # Column name for badge text
  icon = NULL,    # Column name for icon (emoji/unicode)
  indent = NULL,  # Column name for indentation level (integer)
  type = NULL     # Column name for row type: "data", "header", "summary", "spacer"
)
```

### set_marker_style

Apply styling to forest plot markers.

```r
plot |> set_marker_style(
  color = NULL,   # Column name for marker fill color (hex string)
  shape = NULL,   # Column name for shape: "square", "circle", "diamond", "triangle"
  opacity = NULL, # Column name for opacity (0-1)
  size = NULL     # Column name for size multiplier (1 = default)
)
```

### set_column_style

Apply styling to a specific column.

```r
plot |> set_column_style(
  column,         # Field name of the column to style
  bold = NULL,    # Column name for bold text (logical)
  italic = NULL,  # Column name for italic text (logical)
  color = NULL,   # Column name for text color (hex string)
  bg = NULL,      # Column name for background color (hex string)
  badge = NULL,   # Column name for badge text
  icon = NULL     # Column name for icon (emoji/unicode)
)
```

## Theme Modifiers

### set_theme

Switch themes on an existing spec or widget using theme names or objects:

```{r}
#| eval: false
# Using a theme name
forest_plot(data, ...) |> set_theme("jama")

# Using a theme object
forest_plot(data, ...) |> set_theme(web_theme_lancet())
```

Available theme names: `"default"`, `"minimal"`, `"dark"`, `"jama"`, `"lancet"`, `"modern"`, `"presentation"`, `"cochrane"`, `"nature"`.

### Customizing Themes

Themes are customized with the fluent pattern:

```{r}
#| eval: false
custom_theme <- web_theme_jama() |>
  set_colors(primary = "#0066cc", interval = "#0066cc") |>
  set_spacing(row_height = 24) |>
  set_axis(gridlines = TRUE, gridline_style = "dotted")

forest_plot(data, ..., theme = custom_theme)
```

### Multi-Effect Marker Defaults

Set default colors and shapes for multi-effect plots:

```{r}
#| eval: false
custom_theme <- web_theme_default() |>
  set_marker_colors(c("#2563eb", "#dc2626", "#16a34a")) |>
  set_marker_shapes(c("square", "circle", "diamond"))
```

| Function | Purpose | Key Parameters |
|----------|---------|----------------|
| `set_theme()` | Switch themes | Theme name string or WebTheme object |
| `set_colors()` | Color palette | `background`, `foreground`, `primary`, `interval`, `interval_line` |
| `set_typography()` | Fonts | `font_family`, `font_size_base`, `font_weight_bold` |
| `set_spacing()` | Dimensions | `row_height`, `header_height`, `padding`, `cell_padding_x/y` |
| `set_shapes()` | Marker shapes | `point_size`, `summary_height`, `line_width` |
| `set_marker_colors()` | Multi-effect colors | Vector of CSS color strings |
| `set_marker_shapes()` | Multi-effect shapes | Vector: `"square"`, `"circle"`, `"diamond"`, `"triangle"` |
| `set_axis()` | Axis config | `range_min`, `range_max`, `tick_count`, `gridlines` |
| `set_layout()` | Layout | `plot_position`, `row_border`, `container_border` |

## Constructor Arguments vs Fluent API

Both approaches produce identical results:

**Constructor arguments** (set everything upfront):

```{r}
#| eval: false
forest_plot(data,
  point = "hr", lower = "lower", upper = "upper",
  label = "study",
  row_bold = "is_summary",
  marker_color = "sig_color",
  scale = "log", null_value = 1
)
```

**Fluent API** (modify after creation):

```{r}
#| eval: false
forest_plot(data,
  point = "hr", lower = "lower", upper = "upper",
  label = "study",
  scale = "log", null_value = 1
) |>
  set_row_style(bold = "is_summary") |>
  set_marker_style(color = "sig_color")
```

Choose constructor arguments when all styling is known upfront. Use the fluent API when styling depends on computation or when you want to create variants.

## Comparison Table

| Customization | Constructor Argument | Fluent API |
|--------------|---------------------|------------|
| **Row styling** | `row_bold`, `row_italic`, `row_color`, `row_bg`, `row_badge`, `row_icon`, `row_indent`, `row_type` | `set_row_style(bold, italic, color, bg, badge, icon, indent, type)` |
| **Column styling** | Via `col_*()` parameters | `set_column_style(column, bold, italic, color, bg, badge, icon)` |
| **Marker styling** | `marker_color`, `marker_shape`, `marker_opacity`, `marker_size` | `set_marker_style(color, shape, opacity, size)` |
| **Theme** | `theme = web_theme_*() |> set_*()` | Same (always fluent) |

## Advanced: Using web_spec()

For performance-critical applications or when creating many plot variants from one data source, you can work directly with `web_spec()` objects:

```{r}
#| eval: false
# Create spec once
spec <- web_spec(data,
  point = "hr", lower = "lower", upper = "upper",
  label = "study", scale = "log", null_value = 1
)

# Create variants without re-processing data
v1 <- spec |> set_marker_style(color = "sig_color") |> forest_plot()
v2 <- spec |> set_marker_style(shape = "study_shape") |> forest_plot()
v3 <- spec |> set_row_style(bold = "is_summary") |> webtable()
```

This avoids repeated data processing when rendering multiple views of the same data. See [web_spec reference](../reference/web_spec.qmd) for details.
