---
title: "Quick Start"
---

```{r}
#| include: false
library(webforest)
library(dplyr)
```

## Installation

```r
# install.packages("pak")
pak::pak("kaskarn/webforest")
```

## Your First Forest Plot

Create a forest plot with a single function call using `forest_plot()`:

```{r}
# Sample meta-analysis data
meta_data <- data.frame(
  study = c("Smith 2020", "Jones 2021", "Lee 2022", "Chen 2023", "Park 2024"),
  hr = c(0.72, 0.85, 0.91, 0.68, 0.79),
  lower = c(0.55, 0.70, 0.75, 0.52, 0.61),
  upper = c(0.95, 1.03, 1.10, 0.89, 1.02),
  n = c(245, 180, 320, 156, 210),
  events = c(42, 38, 55, 28, 45)
)

forest_plot(meta_data,
  point = "hr",
  lower = "lower",
  upper = "upper",
  label = "study",
  null_value = 1,
  scale = "log",
  axis_label = "Hazard Ratio (95% CI)"
)
```

::: {.callout-important}
## The Three Required Mappings

Every forest plot needs these three column mappings:

| Argument | What it is | Example |
|----------|------------|---------|
| `point` | Point estimate | Hazard ratio, odds ratio, mean difference |
| `lower` | Lower CI bound | 95% CI lower |
| `upper` | Upper CI bound | 95% CI upper |

The `label` argument is optional but almost always used to identify each row.
:::

### Common Options

| Argument | Description | Default |
|----------|-------------|---------|
| `null_value` | Reference line value (e.g., 1 for ratios, 0 for differences) | `NULL` |
| `scale` | `"linear"` or `"log"` | `"linear"` |
| `axis_label` | X-axis label text | `NULL` |
| `theme` | Theme object from `web_theme_*()` | `web_theme_default()` |

::: {.callout-tip}
## Scale Selection Rule of Thumb

- **Log scale** (`scale = "log"`, `null_value = 1`): For ratios (OR, HR, RR) where effects are multiplicative
- **Linear scale** (`scale = "linear"`, `null_value = 0`): For differences (MD, RD, SMD) where effects are additive
:::

---

## Adding Data Columns

Display additional data alongside your forest plot using `col_*()` functions:

```{r}
forest_plot(meta_data,
  point = "hr", lower = "lower", upper = "upper", label = "study",
  columns = list(
    col_n("n"),
    col_numeric("events", header = "Events"),
    col_interval("HR (95% CI)")
  ),
  null_value = 1, scale = "log",
  axis_label = "Hazard Ratio"
)
```

See [Columns](columns.qmd) for all available column types.

---

## Styling Your Plot

webforest offers two equivalent ways to style your plotsâ€”both produce identical results.

### Option 1: Direct Arguments

Pass styling options directly to `forest_plot()`:

```{r}
#| eval: false
forest_plot(meta_data,
  point = "hr", lower = "lower", upper = "upper", label = "study",
  row_bold = "is_summary",        # Column with TRUE/FALSE
  marker_color = "effect_color",  # Column with hex colors
  theme = web_theme_jama(),
  scale = "log", null_value = 1
)
```

### Option 2: Fluent API (Pipe-Based)

Use `set_*()` functions for step-by-step styling:

```{r}
#| eval: false
forest_plot(meta_data,
  point = "hr", lower = "lower", upper = "upper", label = "study",
  scale = "log", null_value = 1
) |>
  set_row_style(bold = "is_summary") |>
  set_marker_style(color = "effect_color") |>
  set_theme("jama")
```

Use constructor arguments when everything is known upfront. Use the fluent API when styling depends on computation or you want to create variants.

---

## Applying Themes

webforest includes 9 publication-ready themes:

```{r}
#| layout-ncol: 2
#| fig-height: 3

forest_plot(meta_data[1:3, ],
  point = "hr", lower = "lower", upper = "upper", label = "study",
  null_value = 1, scale = "log",
  theme = web_theme_jama(), title = "JAMA")

forest_plot(meta_data[1:3, ],
  point = "hr", lower = "lower", upper = "upper", label = "study",
  null_value = 1, scale = "log",
  theme = web_theme_lancet(), title = "Lancet")
```

**Available themes**: `web_theme_default()`, `web_theme_jama()`, `web_theme_lancet()`, `web_theme_nature()`, `web_theme_cochrane()`, `web_theme_modern()`, `web_theme_presentation()`, `web_theme_dark()`, `web_theme_minimal()`

See [Themes](themes.qmd) for customization options.

---

## Creating Visual Hierarchy

Use row styling to distinguish headers, data rows, and summaries:

```{r}
styled_data <- data.frame(
  label = c("Primary Endpoint", "  CV Death", "  MI", "Summary"),
  hr = c(NA, 0.82, 0.79, 0.78),
  lower = c(NA, 0.72, 0.68, 0.65),
  upper = c(NA, 0.94, 0.92, 0.93),
  rtype = c("header", "data", "data", "summary"),
  rbold = c(TRUE, FALSE, FALSE, TRUE)
)

forest_plot(styled_data,
  point = "hr", lower = "lower", upper = "upper", label = "label",
  row_type = "rtype",
  row_bold = "rbold",
  columns = list(col_interval("HR (95% CI)")),
  null_value = 1, scale = "log"
)
```

::: {.callout-note}
## Row Types

| Type | Behavior |
|------|----------|
| `"data"` | Standard row with interval marker |
| `"header"` | Section header, no interval displayed |
| `"summary"` | Summary row with diamond marker |
| `"spacer"` | Empty row for visual separation |

Header and spacer rows should have `NA` for point, lower, and upper.
:::

---

## Conditional Marker Styling

Color markers based on effect direction using computed columns:

```{r}
direction_data <- meta_data |>
  mutate(
    marker_color = case_when(
      upper < 1 ~ "#16a34a",  # Green: significant benefit
      lower > 1 ~ "#dc2626",  # Red: significant harm
      TRUE ~ "#64748b"        # Gray: not significant
    )
  )

forest_plot(direction_data,
  point = "hr", lower = "lower", upper = "upper", label = "study",
  marker_color = "marker_color",
  null_value = 1, scale = "log"
)
```

---

## Next Steps

| Topic | What You'll Learn |
|-------|-------------------|
| [Customizing Plots](fluent-api.qmd) | Build plots step-by-step with the fluent API |
| [Themes](themes.qmd) | Preset themes and customization |
| [Columns](columns.qmd) | Data columns with special formatting |
| [Grouping Studies](grouping.qmd) | Organize studies into collapsible groups |
| [Row Styling](row-styling.qmd) | Headers, summaries, indentation, and badges |
| [Cell Styling](cell-styling.qmd) | Conditional formatting for individual cells |
| [Exporting](exporting.qmd) | Save plots as SVG, PNG, or PDF |
